{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1928.0, "episode_reward_min": -8524.0, "episode_reward_mean": -4281.714285714285, "episode_len_mean": 25.571428571428573, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, -3524.0, -3524.0, -4524.0, -5524.0, -2024.0, -4524.0, -6524.0, -3524.0, -4524.0, -3024.0, -1928.0, -2528.0, -3028.0, -3524.0, -2524.0, -7024.0, -8524.0, -5524.0, -6524.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 29, 29, 29, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.662978456964614, "mean_inference_ms": 5.547626785561875, "mean_action_processing_ms": 1.4903894284876382, "mean_env_wait_ms": 0.7859024021268306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007897331601097471, "StateBufferConnector_ms": 0.008730661301385789, "ViewRequirementAgentConnector_ms": 0.5309411457606724}}, "episode_reward_max": -1928.0, "episode_reward_min": -8524.0, "episode_reward_mean": -4281.714285714285, "episode_len_mean": 25.571428571428573, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, -3524.0, -3524.0, -4524.0, -5524.0, -2024.0, -4524.0, -6524.0, -3524.0, -4524.0, -3024.0, -1928.0, -2528.0, -3028.0, -3524.0, -2524.0, -7024.0, -8524.0, -5524.0, -6524.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 29, 29, 29, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.662978456964614, "mean_inference_ms": 5.547626785561875, "mean_action_processing_ms": 1.4903894284876382, "mean_env_wait_ms": 0.7859024021268306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007897331601097471, "StateBufferConnector_ms": 0.008730661301385789, "ViewRequirementAgentConnector_ms": 0.5309411457606724}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2024.328307387949, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 1975.902, "sample_time_ms": 710.731, "synch_weights_time_ms": 47.497}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 1, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-15", "timestamp": 1715558475, "time_this_iter_s": 1.9892981052398682, "time_total_s": 1.9892981052398682, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11b6425c0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1.9892981052398682, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 51.866666666666674, "ram_util_percent": 37.56666666666667, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.0977450284090909, "gpu_util_percent1": 0.03, "vram_util_percent1": 0.04376775568181818, "gpu_util_percent2": 0.049999999999999996, "vram_util_percent2": 0.04376775568181818, "gpu_util_percent3": 0.16333333333333333, "vram_util_percent3": 0.1161221590909091}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 4446.0, "episode_reward_min": -9024.0, "episode_reward_mean": -3784.909090909091, "episode_len_mean": 28.333333333333332, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, -3524.0, -3524.0, -4524.0, -5524.0, -2024.0, -4524.0, -6524.0, -3524.0, -4524.0, -3024.0, -1928.0, -2528.0, -3028.0, -3524.0, -2524.0, -7024.0, -8524.0, -5524.0, -6524.0, -4024.0, -3524.0, -7024.0, -5024.0, -5524.0, -4524.0, -5024.0, -6524.0, -7024.0, -2524.0, -5024.0, -3524.0, -4024.0, 2047.0, 2447.0, 2947.0, -3528.0, -4024.0, -5524.0, -2024.0, -7524.0, -2024.0, -7024.0, -1427.0, -5524.0, -3524.0, 2557.0, -3524.0, -5024.0, -9024.0, -5024.0, -8024.0, -7024.0, -4524.0, -4024.0, -4024.0, -5524.0, -4524.0, -2524.0, -6024.0, 2546.0, 4446.0, 3446.0, -529.0, -5524.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 29, 29, 29, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 54, 54, 54, 29, 25, 25, 25, 25, 25, 25, 28, 25, 25, 44, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 55, 55, 55, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.58026416190799, "mean_inference_ms": 5.403615850499584, "mean_action_processing_ms": 1.4553503078077006, "mean_env_wait_ms": 0.7372749112508712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008066134019331499, "StateBufferConnector_ms": 0.010529070189504913, "ViewRequirementAgentConnector_ms": 0.4924279270750104}}, "episode_reward_max": 4446.0, "episode_reward_min": -9024.0, "episode_reward_mean": -3784.909090909091, "episode_len_mean": 28.333333333333332, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, -3524.0, -3524.0, -4524.0, -5524.0, -2024.0, -4524.0, -6524.0, -3524.0, -4524.0, -3024.0, -1928.0, -2528.0, -3028.0, -3524.0, -2524.0, -7024.0, -8524.0, -5524.0, -6524.0, -4024.0, -3524.0, -7024.0, -5024.0, -5524.0, -4524.0, -5024.0, -6524.0, -7024.0, -2524.0, -5024.0, -3524.0, -4024.0, 2047.0, 2447.0, 2947.0, -3528.0, -4024.0, -5524.0, -2024.0, -7524.0, -2024.0, -7024.0, -1427.0, -5524.0, -3524.0, 2557.0, -3524.0, -5024.0, -9024.0, -5024.0, -8024.0, -7024.0, -4524.0, -4024.0, -4024.0, -5524.0, -4524.0, -2524.0, -6024.0, 2546.0, 4446.0, 3446.0, -529.0, -5524.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 29, 29, 29, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 54, 54, 54, 29, 25, 25, 25, 25, 25, 25, 28, 25, 25, 44, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 55, 55, 55, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.58026416190799, "mean_inference_ms": 5.403615850499584, "mean_action_processing_ms": 1.4553503078077006, "mean_env_wait_ms": 0.7372749112508712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008066134019331499, "StateBufferConnector_ms": 0.010529070189504913, "ViewRequirementAgentConnector_ms": 0.4924279270750104}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2433.41320352976, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 1809.82, "sample_time_ms": 629.578, "synch_weights_time_ms": 47.958}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 66, "training_iteration": 2, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-19", "timestamp": 1715558479, "time_this_iter_s": 1.6576530933380127, "time_total_s": 3.646951198577881, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72c7c0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3.646951198577881, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.3, "ram_util_percent": 38.019999999999996, "gpu_util_percent0": 0.132, "vram_util_percent0": 0.10165127840909091, "gpu_util_percent1": 0.088, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.068, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.12600000000000003, "vram_util_percent3": 0.11629971590909091}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26901.0, "episode_reward_min": -9024.0, "episode_reward_mean": -749.29, "episode_len_mean": 43.29, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -4524.0, -3024.0, -1928.0, -2528.0, -3028.0, -3524.0, -2524.0, -7024.0, -8524.0, -5524.0, -6524.0, -4024.0, -3524.0, -7024.0, -5024.0, -5524.0, -4524.0, -5024.0, -6524.0, -7024.0, -2524.0, -5024.0, -3524.0, -4024.0, 2047.0, 2447.0, 2947.0, -3528.0, -4024.0, -5524.0, -2024.0, -7524.0, -2024.0, -7024.0, -1427.0, -5524.0, -3524.0, 2557.0, -3524.0, -5024.0, -9024.0, -5024.0, -8024.0, -7024.0, -4524.0, -4024.0, -4024.0, -5524.0, -4524.0, -2524.0, -6024.0, 2546.0, 4446.0, 3446.0, -529.0, -5524.0, 14008.0, -542.0, 12901.0, -4524.0, 11401.0, -7524.0, 10901.0, -6024.0, 901.0, -5524.0, 16901.0, -3524.0, 17401.0, -4524.0, 11401.0, -3524.0, -5524.0, 1990.0, -1599.0, -5024.0, -5599.0, -3024.0, 12901.0, -6024.0, 21401.0, -6024.0, -3524.0, 26901.0, -6024.0, -3524.0, 16489.0, 6901.0, -5524.0, 16901.0, -5024.0, 22401.0, -3024.0, 13401.0, -6024.0, 17401.0, -4024.0, -3599.0, -6524.0], "episode_lengths": [25, 25, 25, 29, 29, 29, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 54, 54, 54, 29, 25, 25, 25, 25, 25, 25, 28, 25, 25, 44, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 55, 55, 55, 30, 25, 93, 43, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 111, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 112, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.516263297588105, "mean_inference_ms": 5.33314649870327, "mean_action_processing_ms": 1.446856261631677, "mean_env_wait_ms": 0.7210835495665232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00992441177368164, "StateBufferConnector_ms": 0.011894941329956055, "ViewRequirementAgentConnector_ms": 0.48564743995666504}}, "episode_reward_max": 26901.0, "episode_reward_min": -9024.0, "episode_reward_mean": -749.29, "episode_len_mean": 43.29, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -4524.0, -3024.0, -1928.0, -2528.0, -3028.0, -3524.0, -2524.0, -7024.0, -8524.0, -5524.0, -6524.0, -4024.0, -3524.0, -7024.0, -5024.0, -5524.0, -4524.0, -5024.0, -6524.0, -7024.0, -2524.0, -5024.0, -3524.0, -4024.0, 2047.0, 2447.0, 2947.0, -3528.0, -4024.0, -5524.0, -2024.0, -7524.0, -2024.0, -7024.0, -1427.0, -5524.0, -3524.0, 2557.0, -3524.0, -5024.0, -9024.0, -5024.0, -8024.0, -7024.0, -4524.0, -4024.0, -4024.0, -5524.0, -4524.0, -2524.0, -6024.0, 2546.0, 4446.0, 3446.0, -529.0, -5524.0, 14008.0, -542.0, 12901.0, -4524.0, 11401.0, -7524.0, 10901.0, -6024.0, 901.0, -5524.0, 16901.0, -3524.0, 17401.0, -4524.0, 11401.0, -3524.0, -5524.0, 1990.0, -1599.0, -5024.0, -5599.0, -3024.0, 12901.0, -6024.0, 21401.0, -6024.0, -3524.0, 26901.0, -6024.0, -3524.0, 16489.0, 6901.0, -5524.0, 16901.0, -5024.0, 22401.0, -3024.0, 13401.0, -6024.0, 17401.0, -4024.0, -3599.0, -6524.0], "episode_lengths": [25, 25, 25, 29, 29, 29, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 54, 54, 54, 29, 25, 25, 25, 25, 25, 25, 28, 25, 25, 44, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 55, 55, 55, 30, 25, 93, 43, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 111, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 112, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.516263297588105, "mean_inference_ms": 5.33314649870327, "mean_action_processing_ms": 1.446856261631677, "mean_env_wait_ms": 0.7210835495665232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00992441177368164, "StateBufferConnector_ms": 0.011894941329956055, "ViewRequirementAgentConnector_ms": 0.48564743995666504}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2436.8996795192093, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 1753.668, "sample_time_ms": 604.885, "synch_weights_time_ms": 47.506}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 109, "training_iteration": 3, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-20", "timestamp": 1715558480, "time_this_iter_s": 1.6578831672668457, "time_total_s": 5.304834365844727, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72fe50>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5.304834365844727, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.199999999999996, "ram_util_percent": 38.1, "gpu_util_percent0": 0.20666666666666667, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.11333333333333336, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.09666666666666668, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.23666666666666666, "vram_util_percent3": 0.1162997159090909}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.30729166666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26901.0, "episode_reward_min": -8524.0, "episode_reward_mean": 864.85, "episode_len_mean": 50.15, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7024.0, -4524.0, -4024.0, -4024.0, -5524.0, -4524.0, -2524.0, -6024.0, 2546.0, 4446.0, 3446.0, -529.0, -5524.0, 14008.0, -542.0, 12901.0, -4524.0, 11401.0, -7524.0, 10901.0, -6024.0, 901.0, -5524.0, 16901.0, -3524.0, 17401.0, -4524.0, 11401.0, -3524.0, -5524.0, 1990.0, -1599.0, -5024.0, -5599.0, -3024.0, 12901.0, -6024.0, 21401.0, -6024.0, -3524.0, 26901.0, -6024.0, -3524.0, 16489.0, 6901.0, -5524.0, 16901.0, -5024.0, 22401.0, -3024.0, 13401.0, -6024.0, 17401.0, -4024.0, -3599.0, -6524.0, -3524.0, -4024.0, -5024.0, -4024.0, -5524.0, -3524.0, -1524.0, -3524.0, -4024.0, -4024.0, -8524.0, -4024.0, -3024.0, -3024.0, -5524.0, -7524.0, -3024.0, 20473.0, 21873.0, 21873.0, -2527.0, -6024.0, -3024.0, -3524.0, -3524.0, -3524.0, -8524.0, -5524.0, -6524.0, -4024.0, -4024.0, 25948.0, 24348.0, -4027.0, 20962.0, -1538.0, 11973.0, -6027.0, -3427.0, -4027.0, -5024.0, -4024.0, -4524.0, -7524.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 55, 55, 55, 30, 25, 93, 43, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 111, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 112, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 128, 128, 128, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 153, 153, 28, 139, 39, 128, 28, 28, 28, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.420177581566813, "mean_inference_ms": 5.265697850034967, "mean_action_processing_ms": 1.4336788418161759, "mean_env_wait_ms": 0.7060899336705936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010076761245727539, "StateBufferConnector_ms": 0.012464284896850586, "ViewRequirementAgentConnector_ms": 0.48024749755859375}}, "episode_reward_max": 26901.0, "episode_reward_min": -8524.0, "episode_reward_mean": 864.85, "episode_len_mean": 50.15, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7024.0, -4524.0, -4024.0, -4024.0, -5524.0, -4524.0, -2524.0, -6024.0, 2546.0, 4446.0, 3446.0, -529.0, -5524.0, 14008.0, -542.0, 12901.0, -4524.0, 11401.0, -7524.0, 10901.0, -6024.0, 901.0, -5524.0, 16901.0, -3524.0, 17401.0, -4524.0, 11401.0, -3524.0, -5524.0, 1990.0, -1599.0, -5024.0, -5599.0, -3024.0, 12901.0, -6024.0, 21401.0, -6024.0, -3524.0, 26901.0, -6024.0, -3524.0, 16489.0, 6901.0, -5524.0, 16901.0, -5024.0, 22401.0, -3024.0, 13401.0, -6024.0, 17401.0, -4024.0, -3599.0, -6524.0, -3524.0, -4024.0, -5024.0, -4024.0, -5524.0, -3524.0, -1524.0, -3524.0, -4024.0, -4024.0, -8524.0, -4024.0, -3024.0, -3024.0, -5524.0, -7524.0, -3024.0, 20473.0, 21873.0, 21873.0, -2527.0, -6024.0, -3024.0, -3524.0, -3524.0, -3524.0, -8524.0, -5524.0, -6524.0, -4024.0, -4024.0, 25948.0, 24348.0, -4027.0, 20962.0, -1538.0, 11973.0, -6027.0, -3427.0, -4027.0, -5024.0, -4024.0, -4524.0, -7524.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 55, 55, 55, 30, 25, 93, 43, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 111, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 112, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 128, 128, 128, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 153, 153, 28, 139, 39, 128, 28, 28, 28, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.420177581566813, "mean_inference_ms": 5.265697850034967, "mean_action_processing_ms": 1.4336788418161759, "mean_env_wait_ms": 0.7060899336705936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010076761245727539, "StateBufferConnector_ms": 0.012464284896850586, "ViewRequirementAgentConnector_ms": 0.48024749755859375}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2573.9897063216354, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 1703.743, "sample_time_ms": 586.528, "synch_weights_time_ms": 46.172}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 153, "training_iteration": 4, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-22", "timestamp": 1715558482, "time_this_iter_s": 1.5625255107879639, "time_total_s": 6.86735987663269, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72fb80>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6.86735987663269, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.75, "ram_util_percent": 38.1, "gpu_util_percent0": 0.17, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.08, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.195, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.1, "vram_util_percent3": 0.11629971590909091}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 40917.0, "episode_reward_min": -8524.0, "episode_reward_mean": 1810.5, "episode_len_mean": 52.5, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6024.0, 17401.0, -4024.0, -3599.0, -6524.0, -3524.0, -4024.0, -5024.0, -4024.0, -5524.0, -3524.0, -1524.0, -3524.0, -4024.0, -4024.0, -8524.0, -4024.0, -3024.0, -3024.0, -5524.0, -7524.0, -3024.0, 20473.0, 21873.0, 21873.0, -2527.0, -6024.0, -3024.0, -3524.0, -3524.0, -3524.0, -8524.0, -5524.0, -6524.0, -4024.0, -4024.0, 25948.0, 24348.0, -4027.0, 20962.0, -1538.0, 11973.0, -6027.0, -3427.0, -4027.0, -5024.0, -4024.0, -4524.0, -7524.0, -3524.0, -4024.0, 9901.0, -4024.0, 8901.0, -4024.0, -5524.0, 11401.0, -6024.0, 40917.0, 38317.0, 967.0, 19401.0, -3024.0, 11901.0, -4024.0, -4024.0, 17901.0, -2524.0, -1024.0, 3901.0, -3524.0, -5524.0, -5524.0, 12401.0, -3024.0, -5524.0, 6401.0, -4524.0, 17401.0, -4524.0, 13901.0, -5524.0, 35923.0, 6442.0, 6401.0, -6024.0, -3024.0, 16401.0, -4024.0, -3524.0, 9401.0, -4024.0, -4024.0, 17401.0, -6024.0, -6024.0, 10901.0, -5524.0, -3524.0, 9401.0], "episode_lengths": [25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 128, 128, 128, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 153, 153, 28, 139, 39, 128, 28, 28, 28, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 184, 184, 34, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 178, 59, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.306789311108203, "mean_inference_ms": 5.179654697342146, "mean_action_processing_ms": 1.400866053849715, "mean_env_wait_ms": 0.6875947577406754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00931549072265625, "StateBufferConnector_ms": 0.010881423950195312, "ViewRequirementAgentConnector_ms": 0.4663658142089844}}, "episode_reward_max": 40917.0, "episode_reward_min": -8524.0, "episode_reward_mean": 1810.5, "episode_len_mean": 52.5, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6024.0, 17401.0, -4024.0, -3599.0, -6524.0, -3524.0, -4024.0, -5024.0, -4024.0, -5524.0, -3524.0, -1524.0, -3524.0, -4024.0, -4024.0, -8524.0, -4024.0, -3024.0, -3024.0, -5524.0, -7524.0, -3024.0, 20473.0, 21873.0, 21873.0, -2527.0, -6024.0, -3024.0, -3524.0, -3524.0, -3524.0, -8524.0, -5524.0, -6524.0, -4024.0, -4024.0, 25948.0, 24348.0, -4027.0, 20962.0, -1538.0, 11973.0, -6027.0, -3427.0, -4027.0, -5024.0, -4024.0, -4524.0, -7524.0, -3524.0, -4024.0, 9901.0, -4024.0, 8901.0, -4024.0, -5524.0, 11401.0, -6024.0, 40917.0, 38317.0, 967.0, 19401.0, -3024.0, 11901.0, -4024.0, -4024.0, 17901.0, -2524.0, -1024.0, 3901.0, -3524.0, -5524.0, -5524.0, 12401.0, -3024.0, -5524.0, 6401.0, -4524.0, 17401.0, -4524.0, 13901.0, -5524.0, 35923.0, 6442.0, 6401.0, -6024.0, -3024.0, 16401.0, -4024.0, -3524.0, 9401.0, -4024.0, -4024.0, 17401.0, -6024.0, -6024.0, 10901.0, -5524.0, -3524.0, 9401.0], "episode_lengths": [25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 128, 128, 128, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 153, 153, 28, 139, 39, 128, 28, 28, 28, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 184, 184, 34, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 178, 59, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.306789311108203, "mean_inference_ms": 5.179654697342146, "mean_action_processing_ms": 1.400866053849715, "mean_env_wait_ms": 0.6875947577406754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00931549072265625, "StateBufferConnector_ms": 0.010881423950195312, "ViewRequirementAgentConnector_ms": 0.4663658142089844}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2509.5940589038732, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 1681.761, "sample_time_ms": 574.388, "synch_weights_time_ms": 45.177}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 204, "training_iteration": 5, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-24", "timestamp": 1715558484, "time_this_iter_s": 1.6068410873413086, "time_total_s": 8.474200963973999, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72f550>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8.474200963973999, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 46.9, "ram_util_percent": 38.1, "gpu_util_percent0": 0.185, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.11, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.13, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.22, "vram_util_percent3": 0.11629971590909091}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 40917.0, "episode_reward_min": -8524.0, "episode_reward_mean": 3425.05, "episode_len_mean": 59.95, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24348.0, -4027.0, 20962.0, -1538.0, 11973.0, -6027.0, -3427.0, -4027.0, -5024.0, -4024.0, -4524.0, -7524.0, -3524.0, -4024.0, 9901.0, -4024.0, 8901.0, -4024.0, -5524.0, 11401.0, -6024.0, 40917.0, 38317.0, 967.0, 19401.0, -3024.0, 11901.0, -4024.0, -4024.0, 17901.0, -2524.0, -1024.0, 3901.0, -3524.0, -5524.0, -5524.0, 12401.0, -3024.0, -5524.0, 6401.0, -4524.0, 17401.0, -4524.0, 13901.0, -5524.0, 35923.0, 6442.0, 6401.0, -6024.0, -3024.0, 16401.0, -4024.0, -3524.0, 9401.0, -4024.0, -4024.0, 17401.0, -6024.0, -6024.0, 10901.0, -5524.0, -3524.0, 9401.0, 3057.0, -5024.0, -4524.0, -5524.0, -4024.0, -1524.0, -4524.0, 8901.0, -3524.0, -4024.0, -5024.0, -6524.0, -3024.0, -3024.0, -3024.0, -4024.0, -4524.0, -7024.0, 11401.0, -4524.0, 35372.0, 40772.0, 40772.0, -3528.0, -4524.0, -2524.0, -8524.0, -4524.0, -4524.0, 23488.0, -5024.0, -4024.0, -4524.0, 24423.0, 28823.0, 26823.0, -4027.0], "episode_lengths": [153, 28, 139, 39, 128, 28, 28, 28, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 184, 184, 34, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 178, 59, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 44, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 229, 229, 229, 29, 25, 25, 25, 25, 25, 113, 25, 25, 25, 178, 178, 178, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2670584762182155, "mean_inference_ms": 5.152146700230741, "mean_action_processing_ms": 1.3963088517650093, "mean_env_wait_ms": 0.6841884829776841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008984804153442383, "StateBufferConnector_ms": 0.011535167694091797, "ViewRequirementAgentConnector_ms": 0.46924662590026855}}, "episode_reward_max": 40917.0, "episode_reward_min": -8524.0, "episode_reward_mean": 3425.05, "episode_len_mean": 59.95, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24348.0, -4027.0, 20962.0, -1538.0, 11973.0, -6027.0, -3427.0, -4027.0, -5024.0, -4024.0, -4524.0, -7524.0, -3524.0, -4024.0, 9901.0, -4024.0, 8901.0, -4024.0, -5524.0, 11401.0, -6024.0, 40917.0, 38317.0, 967.0, 19401.0, -3024.0, 11901.0, -4024.0, -4024.0, 17901.0, -2524.0, -1024.0, 3901.0, -3524.0, -5524.0, -5524.0, 12401.0, -3024.0, -5524.0, 6401.0, -4524.0, 17401.0, -4524.0, 13901.0, -5524.0, 35923.0, 6442.0, 6401.0, -6024.0, -3024.0, 16401.0, -4024.0, -3524.0, 9401.0, -4024.0, -4024.0, 17401.0, -6024.0, -6024.0, 10901.0, -5524.0, -3524.0, 9401.0, 3057.0, -5024.0, -4524.0, -5524.0, -4024.0, -1524.0, -4524.0, 8901.0, -3524.0, -4024.0, -5024.0, -6524.0, -3024.0, -3024.0, -3024.0, -4024.0, -4524.0, -7024.0, 11401.0, -4524.0, 35372.0, 40772.0, 40772.0, -3528.0, -4524.0, -2524.0, -8524.0, -4524.0, -4524.0, 23488.0, -5024.0, -4024.0, -4524.0, 24423.0, 28823.0, 26823.0, -4027.0], "episode_lengths": [153, 28, 139, 39, 128, 28, 28, 28, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 184, 184, 34, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 178, 59, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 44, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 229, 229, 229, 29, 25, 25, 25, 25, 25, 113, 25, 25, 25, 178, 178, 178, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2670584762182155, "mean_inference_ms": 5.152146700230741, "mean_action_processing_ms": 1.3963088517650093, "mean_env_wait_ms": 0.6841884829776841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008984804153442383, "StateBufferConnector_ms": 0.011535167694091797, "ViewRequirementAgentConnector_ms": 0.46924662590026855}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2477.3188776444376, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 1670.567, "sample_time_ms": 569.526, "synch_weights_time_ms": 44.04}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 241, "training_iteration": 6, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-25", "timestamp": 1715558485, "time_this_iter_s": 1.6266934871673584, "time_total_s": 10.100894451141357, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72ef20>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10.100894451141357, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.95, "ram_util_percent": 38.1, "gpu_util_percent0": 0.27, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.11, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.2, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.16, "vram_util_percent3": 0.11629971590909091}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.44791666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 60751.0, "episode_reward_min": -8524.0, "episode_reward_mean": 5432.78, "episode_len_mean": 67.22, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5524.0, 35923.0, 6442.0, 6401.0, -6024.0, -3024.0, 16401.0, -4024.0, -3524.0, 9401.0, -4024.0, -4024.0, 17401.0, -6024.0, -6024.0, 10901.0, -5524.0, -3524.0, 9401.0, 3057.0, -5024.0, -4524.0, -5524.0, -4024.0, -1524.0, -4524.0, 8901.0, -3524.0, -4024.0, -5024.0, -6524.0, -3024.0, -3024.0, -3024.0, -4024.0, -4524.0, -7024.0, 11401.0, -4524.0, 35372.0, 40772.0, 40772.0, -3528.0, -4524.0, -2524.0, -8524.0, -4524.0, -4524.0, 23488.0, -5024.0, -4024.0, -4524.0, 24423.0, 28823.0, 26823.0, -4027.0, -5024.0, -6024.0, -4024.0, -4524.0, -4524.0, 49353.0, 4437.0, 4937.0, -1038.0, -5024.0, 50328.0, 52728.0, 51228.0, -47.0, 52345.0, 50745.0, -4030.0, 54351.0, 59251.0, 60751.0, 2951.0, -5024.0, -4024.0, -3524.0, -2524.0, -3024.0, -4524.0, -4024.0, -6024.0, -5024.0, -5024.0, -3524.0, -5524.0, -3524.0, -3524.0, -5524.0, -5024.0, -5524.0, -4524.0, -6024.0, -4024.0, -4024.0, -5524.0, -2524.0], "episode_lengths": [25, 178, 59, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 44, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 229, 229, 229, 29, 25, 25, 25, 25, 25, 113, 25, 25, 25, 178, 178, 178, 28, 25, 25, 25, 25, 25, 248, 64, 64, 39, 25, 273, 273, 273, 48, 256, 256, 31, 250, 250, 250, 50, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.257095961307675, "mean_inference_ms": 5.141310423950838, "mean_action_processing_ms": 1.3853216779694462, "mean_env_wait_ms": 0.6731901219303745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008387327194213867, "StateBufferConnector_ms": 0.012624263763427734, "ViewRequirementAgentConnector_ms": 0.477095365524292}}, "episode_reward_max": 60751.0, "episode_reward_min": -8524.0, "episode_reward_mean": 5432.78, "episode_len_mean": 67.22, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5524.0, 35923.0, 6442.0, 6401.0, -6024.0, -3024.0, 16401.0, -4024.0, -3524.0, 9401.0, -4024.0, -4024.0, 17401.0, -6024.0, -6024.0, 10901.0, -5524.0, -3524.0, 9401.0, 3057.0, -5024.0, -4524.0, -5524.0, -4024.0, -1524.0, -4524.0, 8901.0, -3524.0, -4024.0, -5024.0, -6524.0, -3024.0, -3024.0, -3024.0, -4024.0, -4524.0, -7024.0, 11401.0, -4524.0, 35372.0, 40772.0, 40772.0, -3528.0, -4524.0, -2524.0, -8524.0, -4524.0, -4524.0, 23488.0, -5024.0, -4024.0, -4524.0, 24423.0, 28823.0, 26823.0, -4027.0, -5024.0, -6024.0, -4024.0, -4524.0, -4524.0, 49353.0, 4437.0, 4937.0, -1038.0, -5024.0, 50328.0, 52728.0, 51228.0, -47.0, 52345.0, 50745.0, -4030.0, 54351.0, 59251.0, 60751.0, 2951.0, -5024.0, -4024.0, -3524.0, -2524.0, -3024.0, -4524.0, -4024.0, -6024.0, -5024.0, -5024.0, -3524.0, -5524.0, -3524.0, -3524.0, -5524.0, -5024.0, -5524.0, -4524.0, -6024.0, -4024.0, -4024.0, -5524.0, -2524.0], "episode_lengths": [25, 178, 59, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 44, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 229, 229, 229, 29, 25, 25, 25, 25, 25, 113, 25, 25, 25, 178, 178, 178, 28, 25, 25, 25, 25, 25, 248, 64, 64, 39, 25, 273, 273, 273, 48, 256, 256, 31, 250, 250, 250, 50, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.257095961307675, "mean_inference_ms": 5.141310423950838, "mean_action_processing_ms": 1.3853216779694462, "mean_env_wait_ms": 0.6731901219303745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008387327194213867, "StateBufferConnector_ms": 0.012624263763427734, "ViewRequirementAgentConnector_ms": 0.477095365524292}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2456.5131608520273, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 1664.525, "sample_time_ms": 569.075, "synch_weights_time_ms": 42.547}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 285, "training_iteration": 7, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-27", "timestamp": 1715558487, "time_this_iter_s": 1.6411921977996826, "time_total_s": 11.74208664894104, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72e8f0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11.74208664894104, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 56.0, "ram_util_percent": 38.1, "gpu_util_percent0": 0.155, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.2, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.225, "vram_util_percent3": 0.11629971590909091}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 60751.0, "episode_reward_min": -9024.0, "episode_reward_mean": 7302.55, "episode_len_mean": 76.45, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -4524.0, 24423.0, 28823.0, 26823.0, -4027.0, -5024.0, -6024.0, -4024.0, -4524.0, -4524.0, 49353.0, 4437.0, 4937.0, -1038.0, -5024.0, 50328.0, 52728.0, 51228.0, -47.0, 52345.0, 50745.0, -4030.0, 54351.0, 59251.0, 60751.0, 2951.0, -5024.0, -4024.0, -3524.0, -2524.0, -3024.0, -4524.0, -4024.0, -6024.0, -5024.0, -5024.0, -3524.0, -5524.0, -3524.0, -3524.0, -5524.0, -5024.0, -5524.0, -4524.0, -6024.0, -4024.0, -4024.0, -5524.0, -2524.0, -5524.0, 19901.0, -8524.0, 12901.0, -4524.0, 11401.0, -4524.0, -5024.0, 17401.0, -5524.0, 10901.0, -4024.0, 15901.0, -5024.0, 10901.0, 5032.0, 6932.0, 5932.0, 457.0, -4524.0, 3901.0, -4024.0, 6901.0, -6024.0, 8401.0, -5524.0, 9401.0, -2524.0, 14401.0, -4524.0, -3024.0, 8901.0, 3056.0, 17401.0, 7901.0, -7524.0, -9024.0, 10401.0, -4524.0, -4524.0, -5524.0, 16401.0, 13401.0, 51298.0, 56198.0, 56698.0, -3527.0, -2024.0, 18401.0, -6024.0], "episode_lengths": [25, 25, 178, 178, 178, 28, 25, 25, 25, 25, 25, 248, 64, 64, 39, 25, 273, 273, 273, 48, 256, 256, 31, 250, 250, 250, 50, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 100, 69, 69, 69, 44, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 45, 100, 100, 25, 25, 100, 25, 25, 25, 100, 100, 303, 303, 303, 28, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.249426578862458, "mean_inference_ms": 5.120559379877608, "mean_action_processing_ms": 1.3689596855344235, "mean_env_wait_ms": 0.6627663326383558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00801849365234375, "StateBufferConnector_ms": 0.013961553573608398, "ViewRequirementAgentConnector_ms": 0.48089051246643066}}, "episode_reward_max": 60751.0, "episode_reward_min": -9024.0, "episode_reward_mean": 7302.55, "episode_len_mean": 76.45, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -4524.0, 24423.0, 28823.0, 26823.0, -4027.0, -5024.0, -6024.0, -4024.0, -4524.0, -4524.0, 49353.0, 4437.0, 4937.0, -1038.0, -5024.0, 50328.0, 52728.0, 51228.0, -47.0, 52345.0, 50745.0, -4030.0, 54351.0, 59251.0, 60751.0, 2951.0, -5024.0, -4024.0, -3524.0, -2524.0, -3024.0, -4524.0, -4024.0, -6024.0, -5024.0, -5024.0, -3524.0, -5524.0, -3524.0, -3524.0, -5524.0, -5024.0, -5524.0, -4524.0, -6024.0, -4024.0, -4024.0, -5524.0, -2524.0, -5524.0, 19901.0, -8524.0, 12901.0, -4524.0, 11401.0, -4524.0, -5024.0, 17401.0, -5524.0, 10901.0, -4024.0, 15901.0, -5024.0, 10901.0, 5032.0, 6932.0, 5932.0, 457.0, -4524.0, 3901.0, -4024.0, 6901.0, -6024.0, 8401.0, -5524.0, 9401.0, -2524.0, 14401.0, -4524.0, -3024.0, 8901.0, 3056.0, 17401.0, 7901.0, -7524.0, -9024.0, 10401.0, -4524.0, -4524.0, -5524.0, 16401.0, 13401.0, 51298.0, 56198.0, 56698.0, -3527.0, -2024.0, 18401.0, -6024.0], "episode_lengths": [25, 25, 178, 178, 178, 28, 25, 25, 25, 25, 25, 248, 64, 64, 39, 25, 273, 273, 273, 48, 256, 256, 31, 250, 250, 250, 50, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 100, 69, 69, 69, 44, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 45, 100, 100, 25, 25, 100, 25, 25, 25, 100, 100, 303, 303, 303, 28, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.249426578862458, "mean_inference_ms": 5.120559379877608, "mean_action_processing_ms": 1.3689596855344235, "mean_env_wait_ms": 0.6627663326383558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00801849365234375, "StateBufferConnector_ms": 0.013961553573608398, "ViewRequirementAgentConnector_ms": 0.48089051246643066}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2486.7915081098718, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 1657.517, "sample_time_ms": 563.421, "synch_weights_time_ms": 41.812}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 335, "training_iteration": 8, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-29", "timestamp": 1715558489, "time_this_iter_s": 1.6173248291015625, "time_total_s": 13.359411478042603, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bcc70>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13.359411478042603, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.166666666666664, "ram_util_percent": 38.1, "gpu_util_percent0": 0.18333333333333335, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14333333333333334, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.18666666666666668, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.21000000000000005, "vram_util_percent3": 0.11665482954545454}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 70648.0, "episode_reward_min": -9024.0, "episode_reward_mean": 4027.38, "episode_len_mean": 63.62, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5024.0, -5524.0, -4524.0, -6024.0, -4024.0, -4024.0, -5524.0, -2524.0, -5524.0, 19901.0, -8524.0, 12901.0, -4524.0, 11401.0, -4524.0, -5024.0, 17401.0, -5524.0, 10901.0, -4024.0, 15901.0, -5024.0, 10901.0, 5032.0, 6932.0, 5932.0, 457.0, -4524.0, 3901.0, -4024.0, 6901.0, -6024.0, 8401.0, -5524.0, 9401.0, -2524.0, 14401.0, -4524.0, -3024.0, 8901.0, 3056.0, 17401.0, 7901.0, -7524.0, -9024.0, 10401.0, -4524.0, -4524.0, -5524.0, 16401.0, 13401.0, 51298.0, 56198.0, 56698.0, -3527.0, -2024.0, 18401.0, -6024.0, -3524.0, -4524.0, -4524.0, -3024.0, 62248.0, 70648.0, 70648.0, -3027.0, -3024.0, -5024.0, -3524.0, -4524.0, 66761.0, 10417.0, 11417.0, -533.0, -4024.0, -5524.0, -4024.0, -5524.0, -6024.0, -4524.0, -2524.0, -5524.0, -4524.0, -3024.0, -4524.0, -4524.0, -6024.0, -5524.0, -4024.0, -8524.0, -3524.0, -4024.0, -4524.0, -5524.0, -6024.0, -5024.0, -3524.0, -5024.0, -3524.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 100, 69, 69, 69, 44, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 45, 100, 100, 25, 25, 100, 25, 25, 25, 100, 100, 303, 303, 303, 28, 25, 100, 25, 25, 25, 25, 25, 353, 353, 353, 28, 25, 25, 25, 25, 340, 84, 84, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.233885124378137, "mean_inference_ms": 5.1039291616961115, "mean_action_processing_ms": 1.3692211559748437, "mean_env_wait_ms": 0.6589140281245959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007846593856811523, "StateBufferConnector_ms": 0.011012792587280273, "ViewRequirementAgentConnector_ms": 0.4783787727355957}}, "episode_reward_max": 70648.0, "episode_reward_min": -9024.0, "episode_reward_mean": 4027.38, "episode_len_mean": 63.62, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5024.0, -5524.0, -4524.0, -6024.0, -4024.0, -4024.0, -5524.0, -2524.0, -5524.0, 19901.0, -8524.0, 12901.0, -4524.0, 11401.0, -4524.0, -5024.0, 17401.0, -5524.0, 10901.0, -4024.0, 15901.0, -5024.0, 10901.0, 5032.0, 6932.0, 5932.0, 457.0, -4524.0, 3901.0, -4024.0, 6901.0, -6024.0, 8401.0, -5524.0, 9401.0, -2524.0, 14401.0, -4524.0, -3024.0, 8901.0, 3056.0, 17401.0, 7901.0, -7524.0, -9024.0, 10401.0, -4524.0, -4524.0, -5524.0, 16401.0, 13401.0, 51298.0, 56198.0, 56698.0, -3527.0, -2024.0, 18401.0, -6024.0, -3524.0, -4524.0, -4524.0, -3024.0, 62248.0, 70648.0, 70648.0, -3027.0, -3024.0, -5024.0, -3524.0, -4524.0, 66761.0, 10417.0, 11417.0, -533.0, -4024.0, -5524.0, -4024.0, -5524.0, -6024.0, -4524.0, -2524.0, -5524.0, -4524.0, -3024.0, -4524.0, -4524.0, -6024.0, -5524.0, -4024.0, -8524.0, -3524.0, -4024.0, -4524.0, -5524.0, -6024.0, -5024.0, -3524.0, -5024.0, -3524.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 100, 69, 69, 69, 44, 25, 100, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 45, 100, 100, 25, 25, 100, 25, 25, 25, 100, 100, 303, 303, 303, 28, 25, 100, 25, 25, 25, 25, 25, 353, 353, 353, 28, 25, 25, 25, 25, 340, 84, 84, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.233885124378137, "mean_inference_ms": 5.1039291616961115, "mean_action_processing_ms": 1.3692211559748437, "mean_env_wait_ms": 0.6589140281245959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007846593856811523, "StateBufferConnector_ms": 0.011012792587280273, "ViewRequirementAgentConnector_ms": 0.4783787727355957}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2478.9265146715334, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 1652.631, "sample_time_ms": 563.572, "synch_weights_time_ms": 40.94}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 377, "training_iteration": 9, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-31", "timestamp": 1715558491, "time_this_iter_s": 1.6255693435668945, "time_total_s": 14.984980821609497, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bceb0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14.984980821609497, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 46.9, "ram_util_percent": 38.1, "gpu_util_percent0": 0.3, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.06, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.135, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.27, "vram_util_percent3": 0.11665482954545454}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.44791666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 82708.0, "episode_reward_min": -8524.0, "episode_reward_mean": 5418.53, "episode_len_mean": 69.47, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -5524.0, 16401.0, 13401.0, 51298.0, 56198.0, 56698.0, -3527.0, -2024.0, 18401.0, -6024.0, -3524.0, -4524.0, -4524.0, -3024.0, 62248.0, 70648.0, 70648.0, -3027.0, -3024.0, -5024.0, -3524.0, -4524.0, 66761.0, 10417.0, 11417.0, -533.0, -4024.0, -5524.0, -4024.0, -5524.0, -6024.0, -4524.0, -2524.0, -5524.0, -4524.0, -3024.0, -4524.0, -4524.0, -6024.0, -5524.0, -4024.0, -8524.0, -3524.0, -4024.0, -4524.0, -5524.0, -6024.0, -5024.0, -3524.0, -5024.0, -3524.0, -3024.0, -5024.0, 12901.0, -8024.0, 12401.0, -4524.0, -3024.0, 18401.0, -5024.0, -3524.0, 3401.0, 23080.0, 20380.0, 3455.0, -3524.0, -3524.0, 12401.0, -5024.0, -3024.0, 16401.0, -5524.0, 31419.0, 82708.0, -42.0, 6901.0, -5024.0, 20401.0, -4524.0, -99.0, -4524.0, 401.0, -5024.0, -4024.0, -3599.0, -4524.0, -4024.0, -6524.0, 17401.0, -7024.0, 16401.0, -5024.0, -3524.0, 7401.0, -4524.0, -5024.0, 17901.0, -5024.0, 14401.0], "episode_lengths": [25, 25, 100, 100, 303, 303, 303, 28, 25, 100, 25, 25, 25, 25, 25, 353, 353, 353, 28, 25, 25, 25, 25, 340, 84, 84, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 121, 121, 46, 25, 25, 100, 25, 25, 100, 25, 182, 393, 43, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.216190014137851, "mean_inference_ms": 5.09731323645816, "mean_action_processing_ms": 1.3638408392470358, "mean_env_wait_ms": 0.6564614556863656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007270336151123047, "StateBufferConnector_ms": 0.009919166564941406, "ViewRequirementAgentConnector_ms": 0.4725492000579834}}, "episode_reward_max": 82708.0, "episode_reward_min": -8524.0, "episode_reward_mean": 5418.53, "episode_len_mean": 69.47, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -5524.0, 16401.0, 13401.0, 51298.0, 56198.0, 56698.0, -3527.0, -2024.0, 18401.0, -6024.0, -3524.0, -4524.0, -4524.0, -3024.0, 62248.0, 70648.0, 70648.0, -3027.0, -3024.0, -5024.0, -3524.0, -4524.0, 66761.0, 10417.0, 11417.0, -533.0, -4024.0, -5524.0, -4024.0, -5524.0, -6024.0, -4524.0, -2524.0, -5524.0, -4524.0, -3024.0, -4524.0, -4524.0, -6024.0, -5524.0, -4024.0, -8524.0, -3524.0, -4024.0, -4524.0, -5524.0, -6024.0, -5024.0, -3524.0, -5024.0, -3524.0, -3024.0, -5024.0, 12901.0, -8024.0, 12401.0, -4524.0, -3024.0, 18401.0, -5024.0, -3524.0, 3401.0, 23080.0, 20380.0, 3455.0, -3524.0, -3524.0, 12401.0, -5024.0, -3024.0, 16401.0, -5524.0, 31419.0, 82708.0, -42.0, 6901.0, -5024.0, 20401.0, -4524.0, -99.0, -4524.0, 401.0, -5024.0, -4024.0, -3599.0, -4524.0, -4024.0, -6524.0, 17401.0, -7024.0, 16401.0, -5024.0, -3524.0, 7401.0, -4524.0, -5024.0, 17901.0, -5024.0, 14401.0], "episode_lengths": [25, 25, 100, 100, 303, 303, 303, 28, 25, 100, 25, 25, 25, 25, 25, 353, 353, 353, 28, 25, 25, 25, 25, 340, 84, 84, 34, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 121, 121, 46, 25, 25, 100, 25, 25, 100, 25, 182, 393, 43, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.216190014137851, "mean_inference_ms": 5.09731323645816, "mean_action_processing_ms": 1.3638408392470358, "mean_env_wait_ms": 0.6564614556863656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007270336151123047, "StateBufferConnector_ms": 0.009919166564941406, "ViewRequirementAgentConnector_ms": 0.4725492000579834}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2382.6446518077446, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 1655.244, "sample_time_ms": 566.559, "synch_weights_time_ms": 41.143}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 424, "training_iteration": 10, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-32", "timestamp": 1715558492, "time_this_iter_s": 1.6891484260559082, "time_total_s": 16.674129247665405, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bd420>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16.674129247665405, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 48.349999999999994, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.22, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.12, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.13, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.175, "vram_util_percent3": 0.11665482954545454}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 91670.0, "episode_reward_min": -8524.0, "episode_reward_mean": 2118.44, "episode_len_mean": 54.56, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, -4524.0, -6024.0, -5524.0, -4024.0, -8524.0, -3524.0, -4024.0, -4524.0, -5524.0, -6024.0, -5024.0, -3524.0, -5024.0, -3524.0, -3024.0, -5024.0, 12901.0, -8024.0, 12401.0, -4524.0, -3024.0, 18401.0, -5024.0, -3524.0, 3401.0, 23080.0, 20380.0, 3455.0, -3524.0, -3524.0, 12401.0, -5024.0, -3024.0, 16401.0, -5524.0, 31419.0, 82708.0, -42.0, 6901.0, -5024.0, 20401.0, -4524.0, -99.0, -4524.0, 401.0, -5024.0, -4024.0, -3599.0, -4524.0, -4024.0, -6524.0, 17401.0, -7024.0, 16401.0, -5024.0, -3524.0, 7401.0, -4524.0, -5024.0, 17901.0, -5024.0, 14401.0, 2556.0, -4024.0, -5024.0, -5524.0, -4524.0, -4524.0, -6524.0, -3524.0, -4024.0, -3024.0, -5024.0, -6024.0, -4024.0, -4524.0, -4024.0, -5024.0, 91670.0, 88070.0, -5027.0, -5524.0, -5524.0, -5024.0, 20401.0, -3524.0, -3524.0, -5024.0, -6524.0, -3024.0, -5024.0, -6024.0, 19986.0, -3524.0, -3524.0, -5524.0, -6524.0, -5024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 121, 121, 46, 25, 25, 100, 25, 25, 100, 25, 182, 393, 43, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 45, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 431, 431, 28, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 115, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.217768231113037, "mean_inference_ms": 5.112307972377096, "mean_action_processing_ms": 1.3688712416827074, "mean_env_wait_ms": 0.6576837304138711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007143974304199219, "StateBufferConnector_ms": 0.007436990737915039, "ViewRequirementAgentConnector_ms": 0.46872544288635254}}, "episode_reward_max": 91670.0, "episode_reward_min": -8524.0, "episode_reward_mean": 2118.44, "episode_len_mean": 54.56, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, -4524.0, -6024.0, -5524.0, -4024.0, -8524.0, -3524.0, -4024.0, -4524.0, -5524.0, -6024.0, -5024.0, -3524.0, -5024.0, -3524.0, -3024.0, -5024.0, 12901.0, -8024.0, 12401.0, -4524.0, -3024.0, 18401.0, -5024.0, -3524.0, 3401.0, 23080.0, 20380.0, 3455.0, -3524.0, -3524.0, 12401.0, -5024.0, -3024.0, 16401.0, -5524.0, 31419.0, 82708.0, -42.0, 6901.0, -5024.0, 20401.0, -4524.0, -99.0, -4524.0, 401.0, -5024.0, -4024.0, -3599.0, -4524.0, -4024.0, -6524.0, 17401.0, -7024.0, 16401.0, -5024.0, -3524.0, 7401.0, -4524.0, -5024.0, 17901.0, -5024.0, 14401.0, 2556.0, -4024.0, -5024.0, -5524.0, -4524.0, -4524.0, -6524.0, -3524.0, -4024.0, -3024.0, -5024.0, -6024.0, -4024.0, -4524.0, -4024.0, -5024.0, 91670.0, 88070.0, -5027.0, -5524.0, -5524.0, -5024.0, 20401.0, -3524.0, -3524.0, -5024.0, -6524.0, -3024.0, -5024.0, -6024.0, 19986.0, -3524.0, -3524.0, -5524.0, -6524.0, -5024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 121, 121, 46, 25, 25, 100, 25, 25, 100, 25, 182, 393, 43, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 45, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 431, 431, 28, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 115, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.217768231113037, "mean_inference_ms": 5.112307972377096, "mean_action_processing_ms": 1.3688712416827074, "mean_env_wait_ms": 0.6576837304138711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007143974304199219, "StateBufferConnector_ms": 0.007436990737915039, "ViewRequirementAgentConnector_ms": 0.46872544288635254}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2478.0203151625506, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 1619.067, "sample_time_ms": 549.855, "synch_weights_time_ms": 40.634}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 460, "training_iteration": 11, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-34", "timestamp": 1715558494, "time_this_iter_s": 1.6255741119384766, "time_total_s": 18.299703359603882, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bdc60>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18.299703359603882, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.833333333333336, "ram_util_percent": 38.1, "gpu_util_percent0": 0.22333333333333336, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.15333333333333335, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.19000000000000003, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.25, "vram_util_percent3": 0.11665482954545454}, "checkpoint_dir_name": "checkpoint_000002"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 97651.0, "episode_reward_min": -7024.0, "episode_reward_mean": 5058.14, "episode_len_mean": 67.86, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31419.0, 82708.0, -42.0, 6901.0, -5024.0, 20401.0, -4524.0, -99.0, -4524.0, 401.0, -5024.0, -4024.0, -3599.0, -4524.0, -4024.0, -6524.0, 17401.0, -7024.0, 16401.0, -5024.0, -3524.0, 7401.0, -4524.0, -5024.0, 17901.0, -5024.0, 14401.0, 2556.0, -4024.0, -5024.0, -5524.0, -4524.0, -4524.0, -6524.0, -3524.0, -4024.0, -3024.0, -5024.0, -6024.0, -4024.0, -4524.0, -4024.0, -5024.0, 91670.0, 88070.0, -5027.0, -5524.0, -5524.0, -5024.0, 20401.0, -3524.0, -3524.0, -5024.0, -6524.0, -3024.0, -5024.0, -6024.0, 19986.0, -3524.0, -3524.0, -5524.0, -6524.0, -5024.0, -3024.0, 85626.0, 94526.0, 94026.0, 3451.0, -5524.0, -4024.0, -5524.0, -2024.0, -4524.0, 28449.0, -3524.0, -4524.0, -5024.0, -5024.0, -3024.0, 97651.0, 3944.0, -2531.0, -4024.0, -434.0, -4524.0, 4059.0, -5024.0, -4524.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, -7024.0, -4024.0, -5024.0, -6524.0, -6524.0, -5024.0, -3524.0], "episode_lengths": [182, 393, 43, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 45, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 431, 431, 28, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 115, 25, 25, 25, 25, 25, 25, 475, 475, 475, 50, 25, 25, 25, 25, 25, 152, 25, 25, 25, 25, 25, 450, 57, 32, 25, 35, 25, 42, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.202776021581104, "mean_inference_ms": 5.102760230936488, "mean_action_processing_ms": 1.3637307755955133, "mean_env_wait_ms": 0.655030655435664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007739067077636719, "StateBufferConnector_ms": 0.008807182312011719, "ViewRequirementAgentConnector_ms": 0.4694948196411133}}, "episode_reward_max": 97651.0, "episode_reward_min": -7024.0, "episode_reward_mean": 5058.14, "episode_len_mean": 67.86, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31419.0, 82708.0, -42.0, 6901.0, -5024.0, 20401.0, -4524.0, -99.0, -4524.0, 401.0, -5024.0, -4024.0, -3599.0, -4524.0, -4024.0, -6524.0, 17401.0, -7024.0, 16401.0, -5024.0, -3524.0, 7401.0, -4524.0, -5024.0, 17901.0, -5024.0, 14401.0, 2556.0, -4024.0, -5024.0, -5524.0, -4524.0, -4524.0, -6524.0, -3524.0, -4024.0, -3024.0, -5024.0, -6024.0, -4024.0, -4524.0, -4024.0, -5024.0, 91670.0, 88070.0, -5027.0, -5524.0, -5524.0, -5024.0, 20401.0, -3524.0, -3524.0, -5024.0, -6524.0, -3024.0, -5024.0, -6024.0, 19986.0, -3524.0, -3524.0, -5524.0, -6524.0, -5024.0, -3024.0, 85626.0, 94526.0, 94026.0, 3451.0, -5524.0, -4024.0, -5524.0, -2024.0, -4524.0, 28449.0, -3524.0, -4524.0, -5024.0, -5024.0, -3024.0, 97651.0, 3944.0, -2531.0, -4024.0, -434.0, -4524.0, 4059.0, -5024.0, -4524.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, -7024.0, -4024.0, -5024.0, -6524.0, -6524.0, -5024.0, -3524.0], "episode_lengths": [182, 393, 43, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 45, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 431, 431, 28, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 115, 25, 25, 25, 25, 25, 25, 475, 475, 475, 50, 25, 25, 25, 25, 25, 152, 25, 25, 25, 25, 25, 450, 57, 32, 25, 35, 25, 42, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.202776021581104, "mean_inference_ms": 5.102760230936488, "mean_action_processing_ms": 1.3637307755955133, "mean_env_wait_ms": 0.655030655435664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007739067077636719, "StateBufferConnector_ms": 0.008807182312011719, "ViewRequirementAgentConnector_ms": 0.4694948196411133}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2511.6724570972433, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 1613.945, "sample_time_ms": 547.849, "synch_weights_time_ms": 38.819}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 497, "training_iteration": 12, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-36", "timestamp": 1715558496, "time_this_iter_s": 1.6013262271881104, "time_total_s": 19.901029586791992, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72fc10>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19.901029586791992, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 46.75, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.22999999999999998, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.060000000000000005, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.195, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.255, "vram_util_percent3": 0.11665482954545454}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 97651.0, "episode_reward_min": -7024.0, "episode_reward_mean": 5487.9, "episode_len_mean": 67.1, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -5024.0, -6524.0, -3024.0, -5024.0, -6024.0, 19986.0, -3524.0, -3524.0, -5524.0, -6524.0, -5024.0, -3024.0, 85626.0, 94526.0, 94026.0, 3451.0, -5524.0, -4024.0, -5524.0, -2024.0, -4524.0, 28449.0, -3524.0, -4524.0, -5024.0, -5024.0, -3024.0, 97651.0, 3944.0, -2531.0, -4024.0, -434.0, -4524.0, 4059.0, -5024.0, -4524.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, -7024.0, -4024.0, -5024.0, -6524.0, -6524.0, -5024.0, -3524.0, -4024.0, 14901.0, -3024.0, 12901.0, -6524.0, 11901.0, -6024.0, -4524.0, 18901.0, -5024.0, -4024.0, -4024.0, 14401.0, -4524.0, 12401.0, -4024.0, 64.0, 14401.0, -4024.0, 16901.0, -6524.0, -4024.0, 10901.0, -3524.0, -3524.0, 13401.0, -4024.0, -6024.0, 20401.0, -3024.0, 11901.0, -5524.0, -5024.0, 10401.0, -4024.0, 11401.0, 13401.0, -4024.0, -3024.0, 11401.0, -1427.0, -5524.0, -4524.0, 23901.0, -4524.0, -4524.0, 10901.0, 53823.0, 55723.0, 58223.0, -5027.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 115, 25, 25, 25, 25, 25, 25, 475, 475, 475, 50, 25, 25, 25, 25, 25, 152, 25, 25, 25, 25, 25, 450, 57, 32, 25, 35, 25, 42, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 37, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 100, 25, 25, 100, 28, 25, 25, 100, 25, 25, 100, 278, 278, 278, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.192324531809139, "mean_inference_ms": 5.087291074107294, "mean_action_processing_ms": 1.3583571936512109, "mean_env_wait_ms": 0.652509896997812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008071184158325195, "StateBufferConnector_ms": 0.010524988174438477, "ViewRequirementAgentConnector_ms": 0.480527400970459}}, "episode_reward_max": 97651.0, "episode_reward_min": -7024.0, "episode_reward_mean": 5487.9, "episode_len_mean": 67.1, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -5024.0, -6524.0, -3024.0, -5024.0, -6024.0, 19986.0, -3524.0, -3524.0, -5524.0, -6524.0, -5024.0, -3024.0, 85626.0, 94526.0, 94026.0, 3451.0, -5524.0, -4024.0, -5524.0, -2024.0, -4524.0, 28449.0, -3524.0, -4524.0, -5024.0, -5024.0, -3024.0, 97651.0, 3944.0, -2531.0, -4024.0, -434.0, -4524.0, 4059.0, -5024.0, -4524.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, -7024.0, -4024.0, -5024.0, -6524.0, -6524.0, -5024.0, -3524.0, -4024.0, 14901.0, -3024.0, 12901.0, -6524.0, 11901.0, -6024.0, -4524.0, 18901.0, -5024.0, -4024.0, -4024.0, 14401.0, -4524.0, 12401.0, -4024.0, 64.0, 14401.0, -4024.0, 16901.0, -6524.0, -4024.0, 10901.0, -3524.0, -3524.0, 13401.0, -4024.0, -6024.0, 20401.0, -3024.0, 11901.0, -5524.0, -5024.0, 10401.0, -4024.0, 11401.0, 13401.0, -4024.0, -3024.0, 11401.0, -1427.0, -5524.0, -4524.0, 23901.0, -4524.0, -4524.0, 10901.0, 53823.0, 55723.0, 58223.0, -5027.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 115, 25, 25, 25, 25, 25, 25, 475, 475, 475, 50, 25, 25, 25, 25, 25, 152, 25, 25, 25, 25, 25, 450, 57, 32, 25, 35, 25, 42, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 37, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 100, 25, 25, 100, 28, 25, 25, 100, 25, 25, 100, 278, 278, 278, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.192324531809139, "mean_inference_ms": 5.087291074107294, "mean_action_processing_ms": 1.3583571936512109, "mean_env_wait_ms": 0.652509896997812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008071184158325195, "StateBufferConnector_ms": 0.010524988174438477, "ViewRequirementAgentConnector_ms": 0.480527400970459}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2563.4009966531216, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 1605.847, "sample_time_ms": 546.883, "synch_weights_time_ms": 38.277}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 548, "training_iteration": 13, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-37", "timestamp": 1715558497, "time_this_iter_s": 1.5721044540405273, "time_total_s": 21.47313404083252, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72ffa0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21.47313404083252, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 47.15, "ram_util_percent": 38.2, "gpu_util_percent0": 0.3, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.08, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.18, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.2, "vram_util_percent3": 0.11665482954545454}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.35937500000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 58223.0, "episode_reward_min": -7024.0, "episode_reward_mean": 2019.66, "episode_len_mean": 51.34, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, -7024.0, -4024.0, -5024.0, -6524.0, -6524.0, -5024.0, -3524.0, -4024.0, 14901.0, -3024.0, 12901.0, -6524.0, 11901.0, -6024.0, -4524.0, 18901.0, -5024.0, -4024.0, -4024.0, 14401.0, -4524.0, 12401.0, -4024.0, 64.0, 14401.0, -4024.0, 16901.0, -6524.0, -4024.0, 10901.0, -3524.0, -3524.0, 13401.0, -4024.0, -6024.0, 20401.0, -3024.0, 11901.0, -5524.0, -5024.0, 10401.0, -4024.0, 11401.0, 13401.0, -4024.0, -3024.0, 11401.0, -1427.0, -5524.0, -4524.0, 23901.0, -4524.0, -4524.0, 10901.0, 53823.0, 55723.0, 58223.0, -5027.0, -3024.0, -5024.0, -4024.0, -6524.0, -6524.0, -3524.0, -4024.0, -6024.0, -4024.0, 11901.0, 36408.0, 36808.0, 458.0, -4024.0, -4024.0, -4024.0, -5024.0, -4024.0, -2024.0, -3524.0, -3024.0, -1524.0, -1427.0, -3024.0, -4524.0, -5524.0, -4524.0, -4024.0, -4524.0, -5024.0, 10401.0, -3524.0, -5524.0, -4024.0, -3024.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 37, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 100, 25, 25, 100, 28, 25, 25, 100, 25, 25, 100, 278, 278, 278, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 193, 193, 43, 25, 25, 25, 25, 25, 25, 25, 25, 25, 28, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.186658858819218, "mean_inference_ms": 5.081629310852796, "mean_action_processing_ms": 1.3547884304726958, "mean_env_wait_ms": 0.6495740689744407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007533550262451172, "StateBufferConnector_ms": 0.008759021759033203, "ViewRequirementAgentConnector_ms": 0.47044849395751953}}, "episode_reward_max": 58223.0, "episode_reward_min": -7024.0, "episode_reward_mean": 2019.66, "episode_len_mean": 51.34, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, -7024.0, -4024.0, -5024.0, -6524.0, -6524.0, -5024.0, -3524.0, -4024.0, 14901.0, -3024.0, 12901.0, -6524.0, 11901.0, -6024.0, -4524.0, 18901.0, -5024.0, -4024.0, -4024.0, 14401.0, -4524.0, 12401.0, -4024.0, 64.0, 14401.0, -4024.0, 16901.0, -6524.0, -4024.0, 10901.0, -3524.0, -3524.0, 13401.0, -4024.0, -6024.0, 20401.0, -3024.0, 11901.0, -5524.0, -5024.0, 10401.0, -4024.0, 11401.0, 13401.0, -4024.0, -3024.0, 11401.0, -1427.0, -5524.0, -4524.0, 23901.0, -4524.0, -4524.0, 10901.0, 53823.0, 55723.0, 58223.0, -5027.0, -3024.0, -5024.0, -4024.0, -6524.0, -6524.0, -3524.0, -4024.0, -6024.0, -4024.0, 11901.0, 36408.0, 36808.0, 458.0, -4024.0, -4024.0, -4024.0, -5024.0, -4024.0, -2024.0, -3524.0, -3024.0, -1524.0, -1427.0, -3024.0, -4524.0, -5524.0, -4524.0, -4024.0, -4524.0, -5024.0, 10401.0, -3524.0, -5524.0, -4024.0, -3024.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 37, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 100, 25, 25, 100, 28, 25, 25, 100, 25, 25, 100, 278, 278, 278, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 193, 193, 43, 25, 25, 25, 25, 25, 25, 25, 25, 25, 28, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.186658858819218, "mean_inference_ms": 5.081629310852796, "mean_action_processing_ms": 1.3547884304726958, "mean_env_wait_ms": 0.6495740689744407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007533550262451172, "StateBufferConnector_ms": 0.008759021759033203, "ViewRequirementAgentConnector_ms": 0.47044849395751953}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2499.424724067927, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 1610.482, "sample_time_ms": 546.664, "synch_weights_time_ms": 36.984}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 584, "training_iteration": 14, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-39", "timestamp": 1715558499, "time_this_iter_s": 1.6145553588867188, "time_total_s": 23.08768939971924, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bdcc0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23.08768939971924, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 46.95, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.12, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14500000000000002, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.22999999999999998, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.165, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 118909.0, "episode_reward_min": -8524.0, "episode_reward_mean": 6118.51, "episode_len_mean": 69.49, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5524.0, -4524.0, 23901.0, -4524.0, -4524.0, 10901.0, 53823.0, 55723.0, 58223.0, -5027.0, -3024.0, -5024.0, -4024.0, -6524.0, -6524.0, -3524.0, -4024.0, -6024.0, -4024.0, 11901.0, 36408.0, 36808.0, 458.0, -4024.0, -4024.0, -4024.0, -5024.0, -4024.0, -2024.0, -3524.0, -3024.0, -1524.0, -1427.0, -3024.0, -4524.0, -5524.0, -4524.0, -4024.0, -4524.0, -5024.0, 10401.0, -3524.0, -5524.0, -4024.0, -3024.0, -4024.0, -2524.0, 15401.0, -5024.0, 11401.0, -3024.0, -3024.0, 11901.0, -4024.0, -4024.0, 15401.0, -4024.0, -2524.0, -4524.0, 13901.0, -4524.0, -3524.0, 12901.0, -5024.0, -3524.0, 16901.0, -3024.0, 4901.0, -2524.0, -3024.0, -5024.0, 14901.0, 25958.0, -42.0, -3524.0, -2524.0, -8524.0, 8901.0, -3024.0, 10401.0, -7524.0, -2524.0, -4524.0, 24401.0, -3524.0, 13901.0, 111509.0, 118909.0, 88048.0, 1951.0, 9401.0, -4524.0, -5024.0, 8901.0, 6543.0, 7943.0, 6043.0, 468.0, -3524.0, 14901.0], "episode_lengths": [25, 25, 100, 25, 25, 100, 278, 278, 278, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 193, 193, 43, 25, 25, 25, 25, 25, 25, 25, 25, 25, 28, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 143, 43, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 592, 592, 453, 50, 100, 25, 25, 100, 58, 58, 58, 33, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.174395025309598, "mean_inference_ms": 5.070843264975166, "mean_action_processing_ms": 1.3509077694857357, "mean_env_wait_ms": 0.6472600605308513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007879257202148438, "StateBufferConnector_ms": 0.010004758834838867, "ViewRequirementAgentConnector_ms": 0.46025681495666504}}, "episode_reward_max": 118909.0, "episode_reward_min": -8524.0, "episode_reward_mean": 6118.51, "episode_len_mean": 69.49, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5524.0, -4524.0, 23901.0, -4524.0, -4524.0, 10901.0, 53823.0, 55723.0, 58223.0, -5027.0, -3024.0, -5024.0, -4024.0, -6524.0, -6524.0, -3524.0, -4024.0, -6024.0, -4024.0, 11901.0, 36408.0, 36808.0, 458.0, -4024.0, -4024.0, -4024.0, -5024.0, -4024.0, -2024.0, -3524.0, -3024.0, -1524.0, -1427.0, -3024.0, -4524.0, -5524.0, -4524.0, -4024.0, -4524.0, -5024.0, 10401.0, -3524.0, -5524.0, -4024.0, -3024.0, -4024.0, -2524.0, 15401.0, -5024.0, 11401.0, -3024.0, -3024.0, 11901.0, -4024.0, -4024.0, 15401.0, -4024.0, -2524.0, -4524.0, 13901.0, -4524.0, -3524.0, 12901.0, -5024.0, -3524.0, 16901.0, -3024.0, 4901.0, -2524.0, -3024.0, -5024.0, 14901.0, 25958.0, -42.0, -3524.0, -2524.0, -8524.0, 8901.0, -3024.0, 10401.0, -7524.0, -2524.0, -4524.0, 24401.0, -3524.0, 13901.0, 111509.0, 118909.0, 88048.0, 1951.0, 9401.0, -4524.0, -5024.0, 8901.0, 6543.0, 7943.0, 6043.0, 468.0, -3524.0, 14901.0], "episode_lengths": [25, 25, 100, 25, 25, 100, 278, 278, 278, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 193, 193, 43, 25, 25, 25, 25, 25, 25, 25, 25, 25, 28, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 143, 43, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 592, 592, 453, 50, 100, 25, 25, 100, 58, 58, 58, 33, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.174395025309598, "mean_inference_ms": 5.070843264975166, "mean_action_processing_ms": 1.3509077694857357, "mean_env_wait_ms": 0.6472600605308513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007879257202148438, "StateBufferConnector_ms": 0.010004758834838867, "ViewRequirementAgentConnector_ms": 0.46025681495666504}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2545.353806754651, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 1608.244, "sample_time_ms": 546.556, "synch_weights_time_ms": 37.12}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 638, "training_iteration": 15, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-41", "timestamp": 1715558501, "time_this_iter_s": 1.5867784023284912, "time_total_s": 24.67446780204773, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bd4b0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24.67446780204773, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 46.8, "ram_util_percent": 38.2, "gpu_util_percent0": 0.24, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.15, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.11, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.19, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 130416.0, "episode_reward_min": -9024.0, "episode_reward_mean": 5798.0, "episode_len_mean": 69.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, -5524.0, -4524.0, -4024.0, -4524.0, -5024.0, 10401.0, -3524.0, -5524.0, -4024.0, -3024.0, -4024.0, -2524.0, 15401.0, -5024.0, 11401.0, -3024.0, -3024.0, 11901.0, -4024.0, -4024.0, 15401.0, -4024.0, -2524.0, -4524.0, 13901.0, -4524.0, -3524.0, 12901.0, -5024.0, -3524.0, 16901.0, -3024.0, 4901.0, -2524.0, -3024.0, -5024.0, 14901.0, 25958.0, -42.0, -3524.0, -2524.0, -8524.0, 8901.0, -3024.0, 10401.0, -7524.0, -2524.0, -4524.0, 24401.0, -3524.0, 13901.0, 111509.0, 118909.0, 88048.0, 1951.0, 9401.0, -4524.0, -5024.0, 8901.0, 6543.0, 7943.0, 6043.0, 468.0, -3524.0, 14901.0, -4524.0, -3524.0, -6024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, -5524.0, 128016.0, 130416.0, -47.0, -4024.0, -4024.0, -4524.0, -6524.0, -4524.0, -3524.0, -3024.0, -4426.0, 13401.0, -3524.0, -3524.0, -3524.0, -9024.0, -4024.0, -5524.0, 7401.0, -4024.0, -4524.0, -3024.0, -5024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 143, 43, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 592, 592, 453, 50, 100, 25, 25, 100, 58, 58, 58, 33, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 585, 585, 48, 25, 25, 25, 25, 25, 25, 25, 27, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.158786374358373, "mean_inference_ms": 5.060752670066813, "mean_action_processing_ms": 1.3490747429922032, "mean_env_wait_ms": 0.6446991820113694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007822751998901367, "StateBufferConnector_ms": 0.008874654769897461, "ViewRequirementAgentConnector_ms": 0.4624497890472412}}, "episode_reward_max": 130416.0, "episode_reward_min": -9024.0, "episode_reward_mean": 5798.0, "episode_len_mean": 69.0, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, -5524.0, -4524.0, -4024.0, -4524.0, -5024.0, 10401.0, -3524.0, -5524.0, -4024.0, -3024.0, -4024.0, -2524.0, 15401.0, -5024.0, 11401.0, -3024.0, -3024.0, 11901.0, -4024.0, -4024.0, 15401.0, -4024.0, -2524.0, -4524.0, 13901.0, -4524.0, -3524.0, 12901.0, -5024.0, -3524.0, 16901.0, -3024.0, 4901.0, -2524.0, -3024.0, -5024.0, 14901.0, 25958.0, -42.0, -3524.0, -2524.0, -8524.0, 8901.0, -3024.0, 10401.0, -7524.0, -2524.0, -4524.0, 24401.0, -3524.0, 13901.0, 111509.0, 118909.0, 88048.0, 1951.0, 9401.0, -4524.0, -5024.0, 8901.0, 6543.0, 7943.0, 6043.0, 468.0, -3524.0, 14901.0, -4524.0, -3524.0, -6024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, -5524.0, 128016.0, 130416.0, -47.0, -4024.0, -4024.0, -4524.0, -6524.0, -4524.0, -3524.0, -3024.0, -4426.0, 13401.0, -3524.0, -3524.0, -3524.0, -9024.0, -4024.0, -5524.0, 7401.0, -4024.0, -4524.0, -3024.0, -5024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 143, 43, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 592, 592, 453, 50, 100, 25, 25, 100, 58, 58, 58, 33, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 585, 585, 48, 25, 25, 25, 25, 25, 25, 25, 27, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.158786374358373, "mean_inference_ms": 5.060752670066813, "mean_action_processing_ms": 1.3490747429922032, "mean_env_wait_ms": 0.6446991820113694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007822751998901367, "StateBufferConnector_ms": 0.008874654769897461, "ViewRequirementAgentConnector_ms": 0.4624497890472412}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2530.348635232551, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 1604.862, "sample_time_ms": 545.918, "synch_weights_time_ms": 36.41}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 671, "training_iteration": 16, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-43", "timestamp": 1715558503, "time_this_iter_s": 1.5961480140686035, "time_total_s": 26.270615816116333, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bc9d0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26.270615816116333, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 41.03333333333333, "ram_util_percent": 38.13333333333333, "gpu_util_percent0": 0.2833333333333333, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.2133333333333333, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.11666666666666665, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.19999999999999998, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": "checkpoint_000003"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 130416.0, "episode_reward_min": -9024.0, "episode_reward_mean": 6886.95, "episode_len_mean": 73.05, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2524.0, -3024.0, -5024.0, 14901.0, 25958.0, -42.0, -3524.0, -2524.0, -8524.0, 8901.0, -3024.0, 10401.0, -7524.0, -2524.0, -4524.0, 24401.0, -3524.0, 13901.0, 111509.0, 118909.0, 88048.0, 1951.0, 9401.0, -4524.0, -5024.0, 8901.0, 6543.0, 7943.0, 6043.0, 468.0, -3524.0, 14901.0, -4524.0, -3524.0, -6024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, -5524.0, 128016.0, 130416.0, -47.0, -4024.0, -4024.0, -4524.0, -6524.0, -4524.0, -3524.0, -3024.0, -4426.0, 13401.0, -3524.0, -3524.0, -3524.0, -9024.0, -4024.0, -5524.0, 7401.0, -4024.0, -4524.0, -3024.0, -5024.0, -3524.0, 32907.0, 32807.0, 1957.0, -5524.0, -4524.0, -4024.0, -4524.0, 10401.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -3524.0, -4024.0, -3024.0, -3524.0, 37427.0, -5024.0, -4524.0, -6524.0, 113100.0, 3453.0, -6524.0, -4024.0, -3524.0, -2024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4024.0, -4524.0], "episode_lengths": [25, 25, 25, 100, 143, 43, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 592, 592, 453, 50, 100, 25, 25, 100, 58, 58, 58, 33, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 585, 585, 48, 25, 25, 25, 25, 25, 25, 25, 27, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 194, 194, 44, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 174, 25, 25, 25, 501, 48, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.159991319028668, "mean_inference_ms": 5.056374878727625, "mean_action_processing_ms": 1.3498504679528722, "mean_env_wait_ms": 0.6440688564658511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007889509201049805, "StateBufferConnector_ms": 0.009294509887695312, "ViewRequirementAgentConnector_ms": 0.4722256660461426}}, "episode_reward_max": 130416.0, "episode_reward_min": -9024.0, "episode_reward_mean": 6886.95, "episode_len_mean": 73.05, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2524.0, -3024.0, -5024.0, 14901.0, 25958.0, -42.0, -3524.0, -2524.0, -8524.0, 8901.0, -3024.0, 10401.0, -7524.0, -2524.0, -4524.0, 24401.0, -3524.0, 13901.0, 111509.0, 118909.0, 88048.0, 1951.0, 9401.0, -4524.0, -5024.0, 8901.0, 6543.0, 7943.0, 6043.0, 468.0, -3524.0, 14901.0, -4524.0, -3524.0, -6024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, -5524.0, 128016.0, 130416.0, -47.0, -4024.0, -4024.0, -4524.0, -6524.0, -4524.0, -3524.0, -3024.0, -4426.0, 13401.0, -3524.0, -3524.0, -3524.0, -9024.0, -4024.0, -5524.0, 7401.0, -4024.0, -4524.0, -3024.0, -5024.0, -3524.0, 32907.0, 32807.0, 1957.0, -5524.0, -4524.0, -4024.0, -4524.0, 10401.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -3524.0, -4024.0, -3024.0, -3524.0, 37427.0, -5024.0, -4524.0, -6524.0, 113100.0, 3453.0, -6524.0, -4024.0, -3524.0, -2024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4024.0, -4524.0], "episode_lengths": [25, 25, 25, 100, 143, 43, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 592, 592, 453, 50, 100, 25, 25, 100, 58, 58, 58, 33, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 585, 585, 48, 25, 25, 25, 25, 25, 25, 25, 27, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 194, 194, 44, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 174, 25, 25, 25, 501, 48, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.159991319028668, "mean_inference_ms": 5.056374878727625, "mean_action_processing_ms": 1.3498504679528722, "mean_env_wait_ms": 0.6440688564658511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007889509201049805, "StateBufferConnector_ms": 0.009294509887695312, "ViewRequirementAgentConnector_ms": 0.4722256660461426}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2462.159804544275, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 1604.487, "sample_time_ms": 541.903, "synch_weights_time_ms": 36.927}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 706, "training_iteration": 17, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-44", "timestamp": 1715558504, "time_this_iter_s": 1.6407866477966309, "time_total_s": 27.911402463912964, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bc970>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27.911402463912964, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 47.0, "ram_util_percent": 38.1, "gpu_util_percent0": 0.28500000000000003, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.24, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.095, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.26, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 113100.0, "episode_reward_min": -9024.0, "episode_reward_mean": 5476.24, "episode_len_mean": 65.76, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -3524.0, -3024.0, -4426.0, 13401.0, -3524.0, -3524.0, -3524.0, -9024.0, -4024.0, -5524.0, 7401.0, -4024.0, -4524.0, -3024.0, -5024.0, -3524.0, 32907.0, 32807.0, 1957.0, -5524.0, -4524.0, -4024.0, -4524.0, 10401.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -3524.0, -4024.0, -3024.0, -3524.0, 37427.0, -5024.0, -4524.0, -6524.0, 113100.0, 3453.0, -6524.0, -4024.0, -3524.0, -2024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4024.0, -4524.0, -7024.0, 4401.0, -4524.0, -3024.0, 12401.0, 21401.0, -3024.0, 95651.0, 94551.0, 1951.0, 11901.0, -4524.0, -6024.0, -3524.0, 11901.0, -5524.0, -3524.0, 17901.0, -5524.0, -3524.0, 12901.0, -2524.0, 15901.0, -4524.0, -5024.0, 12901.0, -2524.0, -4024.0, 15901.0, 14901.0, -5524.0, -3524.0, -4024.0, 17901.0, -5524.0, 15901.0, 11401.0, -5024.0, -4024.0, 6401.0, -4024.0, -3524.0, -5024.0, 11901.0, 88203.0, 86103.0, 3953.0, -3524.0, -4524.0], "episode_lengths": [25, 25, 25, 27, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 194, 194, 44, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 174, 25, 25, 25, 501, 48, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 450, 450, 50, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 25, 100, 398, 398, 48, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.143927888057553, "mean_inference_ms": 5.045466283200086, "mean_action_processing_ms": 1.344809181778023, "mean_env_wait_ms": 0.6409585769827983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007714509963989258, "StateBufferConnector_ms": 0.008914470672607422, "ViewRequirementAgentConnector_ms": 0.4858865737915039}}, "episode_reward_max": 113100.0, "episode_reward_min": -9024.0, "episode_reward_mean": 5476.24, "episode_len_mean": 65.76, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -3524.0, -3024.0, -4426.0, 13401.0, -3524.0, -3524.0, -3524.0, -9024.0, -4024.0, -5524.0, 7401.0, -4024.0, -4524.0, -3024.0, -5024.0, -3524.0, 32907.0, 32807.0, 1957.0, -5524.0, -4524.0, -4024.0, -4524.0, 10401.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -3524.0, -4024.0, -3024.0, -3524.0, 37427.0, -5024.0, -4524.0, -6524.0, 113100.0, 3453.0, -6524.0, -4024.0, -3524.0, -2024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4024.0, -4524.0, -7024.0, 4401.0, -4524.0, -3024.0, 12401.0, 21401.0, -3024.0, 95651.0, 94551.0, 1951.0, 11901.0, -4524.0, -6024.0, -3524.0, 11901.0, -5524.0, -3524.0, 17901.0, -5524.0, -3524.0, 12901.0, -2524.0, 15901.0, -4524.0, -5024.0, 12901.0, -2524.0, -4024.0, 15901.0, 14901.0, -5524.0, -3524.0, -4024.0, 17901.0, -5524.0, 15901.0, 11401.0, -5024.0, -4024.0, 6401.0, -4024.0, -3524.0, -5024.0, 11901.0, 88203.0, 86103.0, 3953.0, -3524.0, -4524.0], "episode_lengths": [25, 25, 25, 27, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 194, 194, 44, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 174, 25, 25, 25, 501, 48, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 450, 450, 50, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 25, 100, 398, 398, 48, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.143927888057553, "mean_inference_ms": 5.045466283200086, "mean_action_processing_ms": 1.344809181778023, "mean_env_wait_ms": 0.6409585769827983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007714509963989258, "StateBufferConnector_ms": 0.008914470672607422, "ViewRequirementAgentConnector_ms": 0.4858865737915039}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2465.380635350843, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 1605.884, "sample_time_ms": 544.696, "synch_weights_time_ms": 37.142}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 755, "training_iteration": 18, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-46", "timestamp": 1715558506, "time_this_iter_s": 1.6310839653015137, "time_total_s": 29.542486429214478, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bc9a0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29.542486429214478, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 46.95, "ram_util_percent": 38.1, "gpu_util_percent0": 0.22499999999999998, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.21500000000000002, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.14, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.255, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 172873.0, "episode_reward_min": -7024.0, "episode_reward_mean": 10480.23, "episode_len_mean": 86.77, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4024.0, -4524.0, -7024.0, 4401.0, -4524.0, -3024.0, 12401.0, 21401.0, -3024.0, 95651.0, 94551.0, 1951.0, 11901.0, -4524.0, -6024.0, -3524.0, 11901.0, -5524.0, -3524.0, 17901.0, -5524.0, -3524.0, 12901.0, -2524.0, 15901.0, -4524.0, -5024.0, 12901.0, -2524.0, -4024.0, 15901.0, 14901.0, -5524.0, -3524.0, -4024.0, 17901.0, -5524.0, 15901.0, 11401.0, -5024.0, -4024.0, 6401.0, -4024.0, -3524.0, -5024.0, 11901.0, 88203.0, 86103.0, 3953.0, -3524.0, -4524.0, -5524.0, -3524.0, 46343.0, 5437.0, 4937.0, -38.0, -4024.0, -4024.0, -3024.0, -5024.0, -4524.0, -3524.0, 18401.0, -3524.0, -4024.0, -4524.0, -3524.0, -3024.0, -3524.0, -5524.0, -4024.0, -3024.0, 172873.0, 168273.0, 7540.0, -4524.0, -5024.0, -4024.0, -3024.0, 151870.0, 148770.0, -4028.0, -6024.0, -2524.0, -4024.0, -4524.0, -4524.0, 12901.0, -4024.0, -4024.0, -4524.0, -4524.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 450, 450, 50, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 25, 100, 398, 398, 48, 25, 25, 25, 25, 258, 64, 64, 39, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 728, 728, 61, 25, 25, 25, 25, 731, 731, 29, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.135175464729518, "mean_inference_ms": 5.035587363033628, "mean_action_processing_ms": 1.3396245630784696, "mean_env_wait_ms": 0.6380108851559707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00779271125793457, "StateBufferConnector_ms": 0.010015249252319336, "ViewRequirementAgentConnector_ms": 0.4733419418334961}}, "episode_reward_max": 172873.0, "episode_reward_min": -7024.0, "episode_reward_mean": 10480.23, "episode_len_mean": 86.77, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4024.0, -4524.0, -7024.0, 4401.0, -4524.0, -3024.0, 12401.0, 21401.0, -3024.0, 95651.0, 94551.0, 1951.0, 11901.0, -4524.0, -6024.0, -3524.0, 11901.0, -5524.0, -3524.0, 17901.0, -5524.0, -3524.0, 12901.0, -2524.0, 15901.0, -4524.0, -5024.0, 12901.0, -2524.0, -4024.0, 15901.0, 14901.0, -5524.0, -3524.0, -4024.0, 17901.0, -5524.0, 15901.0, 11401.0, -5024.0, -4024.0, 6401.0, -4024.0, -3524.0, -5024.0, 11901.0, 88203.0, 86103.0, 3953.0, -3524.0, -4524.0, -5524.0, -3524.0, 46343.0, 5437.0, 4937.0, -38.0, -4024.0, -4024.0, -3024.0, -5024.0, -4524.0, -3524.0, 18401.0, -3524.0, -4024.0, -4524.0, -3524.0, -3024.0, -3524.0, -5524.0, -4024.0, -3024.0, 172873.0, 168273.0, 7540.0, -4524.0, -5024.0, -4024.0, -3024.0, 151870.0, 148770.0, -4028.0, -6024.0, -2524.0, -4024.0, -4524.0, -4524.0, 12901.0, -4024.0, -4024.0, -4524.0, -4524.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 450, 450, 50, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 25, 100, 398, 398, 48, 25, 25, 25, 25, 258, 64, 64, 39, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 728, 728, 61, 25, 25, 25, 25, 731, 731, 29, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.135175464729518, "mean_inference_ms": 5.035587363033628, "mean_action_processing_ms": 1.3396245630784696, "mean_env_wait_ms": 0.6380108851559707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00779271125793457, "StateBufferConnector_ms": 0.010015249252319336, "ViewRequirementAgentConnector_ms": 0.4733419418334961}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2582.8215711549174, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 1599.395, "sample_time_ms": 544.383, "synch_weights_time_ms": 37.37}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 798, "training_iteration": 19, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-48", "timestamp": 1715558508, "time_this_iter_s": 1.557126760482788, "time_total_s": 31.099613189697266, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bdf60>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 31.099613189697266, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 46.55, "ram_util_percent": 38.1, "gpu_util_percent0": 0.185, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.15000000000000002, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.135, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.2, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 172873.0, "episode_reward_min": -6024.0, "episode_reward_mean": 8616.48, "episode_len_mean": 79.52, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15901.0, 11401.0, -5024.0, -4024.0, 6401.0, -4024.0, -3524.0, -5024.0, 11901.0, 88203.0, 86103.0, 3953.0, -3524.0, -4524.0, -5524.0, -3524.0, 46343.0, 5437.0, 4937.0, -38.0, -4024.0, -4024.0, -3024.0, -5024.0, -4524.0, -3524.0, 18401.0, -3524.0, -4024.0, -4524.0, -3524.0, -3024.0, -3524.0, -5524.0, -4024.0, -3024.0, 172873.0, 168273.0, 7540.0, -4524.0, -5024.0, -4024.0, -3024.0, 151870.0, 148770.0, -4028.0, -6024.0, -2524.0, -4024.0, -4524.0, -4524.0, 12901.0, -4024.0, -4024.0, -4524.0, -4524.0, -4024.0, -5024.0, 23401.0, -4024.0, 18901.0, -4524.0, -4524.0, -4024.0, -4524.0, -6024.0, 13401.0, -4024.0, -4524.0, 7901.0, -4524.0, -4024.0, 11901.0, -4524.0, 13901.0, -3524.0, -4524.0, -4024.0, 13401.0, 14401.0, -3524.0, -4524.0, -4024.0, 11401.0, -4024.0, 16401.0, -4024.0, -4524.0, -5024.0, 13901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4099.0, -4024.0, -2024.0, 17901.0, -3024.0, -3524.0], "episode_lengths": [100, 100, 25, 25, 100, 25, 25, 25, 100, 398, 398, 48, 25, 25, 25, 25, 258, 64, 64, 39, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 728, 728, 61, 25, 25, 25, 25, 731, 731, 29, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.140709667736976, "mean_inference_ms": 5.040389392848802, "mean_action_processing_ms": 1.3427229602576483, "mean_env_wait_ms": 0.6385447769417594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00788116455078125, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.47025322914123535}}, "episode_reward_max": 172873.0, "episode_reward_min": -6024.0, "episode_reward_mean": 8616.48, "episode_len_mean": 79.52, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15901.0, 11401.0, -5024.0, -4024.0, 6401.0, -4024.0, -3524.0, -5024.0, 11901.0, 88203.0, 86103.0, 3953.0, -3524.0, -4524.0, -5524.0, -3524.0, 46343.0, 5437.0, 4937.0, -38.0, -4024.0, -4024.0, -3024.0, -5024.0, -4524.0, -3524.0, 18401.0, -3524.0, -4024.0, -4524.0, -3524.0, -3024.0, -3524.0, -5524.0, -4024.0, -3024.0, 172873.0, 168273.0, 7540.0, -4524.0, -5024.0, -4024.0, -3024.0, 151870.0, 148770.0, -4028.0, -6024.0, -2524.0, -4024.0, -4524.0, -4524.0, 12901.0, -4024.0, -4024.0, -4524.0, -4524.0, -4024.0, -5024.0, 23401.0, -4024.0, 18901.0, -4524.0, -4524.0, -4024.0, -4524.0, -6024.0, 13401.0, -4024.0, -4524.0, 7901.0, -4524.0, -4024.0, 11901.0, -4524.0, 13901.0, -3524.0, -4524.0, -4024.0, 13401.0, 14401.0, -3524.0, -4524.0, -4024.0, 11401.0, -4024.0, 16401.0, -4024.0, -4524.0, -5024.0, 13901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4099.0, -4024.0, -2024.0, 17901.0, -3024.0, -3524.0], "episode_lengths": [100, 100, 25, 25, 100, 25, 25, 25, 100, 398, 398, 48, 25, 25, 25, 25, 258, 64, 64, 39, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 728, 728, 61, 25, 25, 25, 25, 731, 731, 29, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.140709667736976, "mean_inference_ms": 5.040389392848802, "mean_action_processing_ms": 1.3427229602576483, "mean_env_wait_ms": 0.6385447769417594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00788116455078125, "StateBufferConnector_ms": 0.0094451904296875, "ViewRequirementAgentConnector_ms": 0.47025322914123535}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2452.4077928760203, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 1594.619, "sample_time_ms": 540.131, "synch_weights_time_ms": 37.712}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 841, "training_iteration": 20, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-49", "timestamp": 1715558509, "time_this_iter_s": 1.6458616256713867, "time_total_s": 32.74547481536865, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72feb0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 32.74547481536865, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 50.8, "ram_util_percent": 38.1, "gpu_util_percent0": 0.26, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.125, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.16, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.18, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 151870.0, "episode_reward_min": -6024.0, "episode_reward_mean": 4578.92, "episode_len_mean": 63.08, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7540.0, -4524.0, -5024.0, -4024.0, -3024.0, 151870.0, 148770.0, -4028.0, -6024.0, -2524.0, -4024.0, -4524.0, -4524.0, 12901.0, -4024.0, -4024.0, -4524.0, -4524.0, -4024.0, -5024.0, 23401.0, -4024.0, 18901.0, -4524.0, -4524.0, -4024.0, -4524.0, -6024.0, 13401.0, -4024.0, -4524.0, 7901.0, -4524.0, -4024.0, 11901.0, -4524.0, 13901.0, -3524.0, -4524.0, -4024.0, 13401.0, 14401.0, -3524.0, -4524.0, -4024.0, 11401.0, -4024.0, 16401.0, -4024.0, -4524.0, -5024.0, 13901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4099.0, -4024.0, -2024.0, 17901.0, -3024.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, 100149.0, 101049.0, -2526.0, -4024.0, -1024.0, -434.0, -4524.0, -4524.0, -5024.0, -3024.0, -5524.0, -5524.0, -5024.0, -6024.0, -4524.0, -4524.0, -5024.0, -4524.0, -3024.0, -4024.0, -4024.0, 16401.0, -3524.0, -4024.0, -4024.0, -5024.0, -4024.0, -5524.0, 11401.0, -4024.0, -4524.0, -6024.0, -5024.0, 48961.0], "episode_lengths": [61, 25, 25, 25, 25, 731, 731, 29, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 452, 452, 27, 25, 25, 35, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.145814578992416, "mean_inference_ms": 5.046334477106006, "mean_action_processing_ms": 1.3442982127628094, "mean_env_wait_ms": 0.6386470077737062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007998943328857422, "StateBufferConnector_ms": 0.008109807968139648, "ViewRequirementAgentConnector_ms": 0.47757577896118164}}, "episode_reward_max": 151870.0, "episode_reward_min": -6024.0, "episode_reward_mean": 4578.92, "episode_len_mean": 63.08, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7540.0, -4524.0, -5024.0, -4024.0, -3024.0, 151870.0, 148770.0, -4028.0, -6024.0, -2524.0, -4024.0, -4524.0, -4524.0, 12901.0, -4024.0, -4024.0, -4524.0, -4524.0, -4024.0, -5024.0, 23401.0, -4024.0, 18901.0, -4524.0, -4524.0, -4024.0, -4524.0, -6024.0, 13401.0, -4024.0, -4524.0, 7901.0, -4524.0, -4024.0, 11901.0, -4524.0, 13901.0, -3524.0, -4524.0, -4024.0, 13401.0, 14401.0, -3524.0, -4524.0, -4024.0, 11401.0, -4024.0, 16401.0, -4024.0, -4524.0, -5024.0, 13901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4099.0, -4024.0, -2024.0, 17901.0, -3024.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, 100149.0, 101049.0, -2526.0, -4024.0, -1024.0, -434.0, -4524.0, -4524.0, -5024.0, -3024.0, -5524.0, -5524.0, -5024.0, -6024.0, -4524.0, -4524.0, -5024.0, -4524.0, -3024.0, -4024.0, -4024.0, 16401.0, -3524.0, -4024.0, -4024.0, -5024.0, -4024.0, -5524.0, 11401.0, -4024.0, -4524.0, -6024.0, -5024.0, 48961.0], "episode_lengths": [61, 25, 25, 25, 25, 731, 731, 29, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 452, 452, 27, 25, 25, 35, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.145814578992416, "mean_inference_ms": 5.046334477106006, "mean_action_processing_ms": 1.3442982127628094, "mean_env_wait_ms": 0.6386470077737062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007998943328857422, "StateBufferConnector_ms": 0.008109807968139648, "ViewRequirementAgentConnector_ms": 0.47757577896118164}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2435.684429836946, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 84000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 1597.427, "sample_time_ms": 541.9, "synch_weights_time_ms": 37.859}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 879, "training_iteration": 21, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-51", "timestamp": 1715558511, "time_this_iter_s": 1.656663417816162, "time_total_s": 34.402138233184814, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72e8f0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 34.402138233184814, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 42.333333333333336, "ram_util_percent": 38.166666666666664, "gpu_util_percent0": 0.26666666666666666, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.09000000000000001, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.21333333333333335, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.16333333333333336, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": "checkpoint_000004"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 101049.0, "episode_reward_min": -6024.0, "episode_reward_mean": 4455.57, "episode_len_mean": 60.43, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, 13401.0, 14401.0, -3524.0, -4524.0, -4024.0, 11401.0, -4024.0, 16401.0, -4024.0, -4524.0, -5024.0, 13901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4099.0, -4024.0, -2024.0, 17901.0, -3024.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, 100149.0, 101049.0, -2526.0, -4024.0, -1024.0, -434.0, -4524.0, -4524.0, -5024.0, -3024.0, -5524.0, -5524.0, -5024.0, -6024.0, -4524.0, -4524.0, -5024.0, -4524.0, -3024.0, -4024.0, -4024.0, 16401.0, -3524.0, -4024.0, -4024.0, -5024.0, -4024.0, -5524.0, 11401.0, -4024.0, -4524.0, -6024.0, -5024.0, 48961.0, -4524.0, -5524.0, 31442.0, -3524.0, -3024.0, -3524.0, 31925.0, -4524.0, 16992.0, -4024.0, -5024.0, -5024.0, -5024.0, -3524.0, 99181.0, 3456.0, -4524.0, -2524.0, 15901.0, -4024.0, 25957.0, 1457.0, -4524.0, -4524.0, -4524.0, -4024.0, -5024.0, -5524.0, -4024.0, 50841.0, 56241.0, 53241.0, -1534.0, -5024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0], "episode_lengths": [25, 100, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 452, 452, 27, 25, 25, 35, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 240, 25, 25, 159, 25, 25, 25, 176, 25, 109, 25, 25, 25, 25, 25, 420, 45, 25, 25, 100, 25, 144, 44, 25, 25, 25, 25, 25, 25, 25, 260, 260, 260, 35, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1591986642233465, "mean_inference_ms": 5.050741285576232, "mean_action_processing_ms": 1.348960739853381, "mean_env_wait_ms": 0.6400985496871485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008247613906860352, "StateBufferConnector_ms": 0.010770559310913086, "ViewRequirementAgentConnector_ms": 0.47609686851501465}}, "episode_reward_max": 101049.0, "episode_reward_min": -6024.0, "episode_reward_mean": 4455.57, "episode_len_mean": 60.43, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, 13401.0, 14401.0, -3524.0, -4524.0, -4024.0, 11401.0, -4024.0, 16401.0, -4024.0, -4524.0, -5024.0, 13901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4099.0, -4024.0, -2024.0, 17901.0, -3024.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, 100149.0, 101049.0, -2526.0, -4024.0, -1024.0, -434.0, -4524.0, -4524.0, -5024.0, -3024.0, -5524.0, -5524.0, -5024.0, -6024.0, -4524.0, -4524.0, -5024.0, -4524.0, -3024.0, -4024.0, -4024.0, 16401.0, -3524.0, -4024.0, -4024.0, -5024.0, -4024.0, -5524.0, 11401.0, -4024.0, -4524.0, -6024.0, -5024.0, 48961.0, -4524.0, -5524.0, 31442.0, -3524.0, -3024.0, -3524.0, 31925.0, -4524.0, 16992.0, -4024.0, -5024.0, -5024.0, -5024.0, -3524.0, 99181.0, 3456.0, -4524.0, -2524.0, 15901.0, -4024.0, 25957.0, 1457.0, -4524.0, -4524.0, -4524.0, -4024.0, -5024.0, -5524.0, -4024.0, 50841.0, 56241.0, 53241.0, -1534.0, -5024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0], "episode_lengths": [25, 100, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 452, 452, 27, 25, 25, 35, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 240, 25, 25, 159, 25, 25, 25, 176, 25, 109, 25, 25, 25, 25, 25, 420, 45, 25, 25, 100, 25, 144, 44, 25, 25, 25, 25, 25, 25, 25, 260, 260, 260, 35, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1591986642233465, "mean_inference_ms": 5.050741285576232, "mean_action_processing_ms": 1.348960739853381, "mean_env_wait_ms": 0.6400985496871485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008247613906860352, "StateBufferConnector_ms": 0.010770559310913086, "ViewRequirementAgentConnector_ms": 0.47609686851501465}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2496.0037229059435, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 88000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 1598.427, "sample_time_ms": 541.84, "synch_weights_time_ms": 38.287}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 918, "training_iteration": 22, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-53", "timestamp": 1715558513, "time_this_iter_s": 1.6128954887390137, "time_total_s": 36.01503372192383, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72cb50>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 36.01503372192383, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 47.05, "ram_util_percent": 38.2, "gpu_util_percent0": 0.26, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.085, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.15, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.27, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 99181.0, "episode_reward_min": -6024.0, "episode_reward_mean": 3743.76, "episode_len_mean": 57.24, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -5024.0, -4524.0, -3024.0, -4024.0, -4024.0, 16401.0, -3524.0, -4024.0, -4024.0, -5024.0, -4024.0, -5524.0, 11401.0, -4024.0, -4524.0, -6024.0, -5024.0, 48961.0, -4524.0, -5524.0, 31442.0, -3524.0, -3024.0, -3524.0, 31925.0, -4524.0, 16992.0, -4024.0, -5024.0, -5024.0, -5024.0, -3524.0, 99181.0, 3456.0, -4524.0, -2524.0, 15901.0, -4024.0, 25957.0, 1457.0, -4524.0, -4524.0, -4524.0, -4024.0, -5024.0, -5524.0, -4024.0, 50841.0, 56241.0, 53241.0, -1534.0, -5024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4524.0, 12401.0, -4024.0, 26452.0, 1952.0, 9901.0, -4524.0, -4524.0, -4024.0, -4024.0, -5024.0, 16401.0, -4024.0, -3024.0, 13401.0, -4024.0, 10401.0, 3052.0, -4024.0, 16401.0, -2524.0, -3524.0, 18401.0, -5024.0, -4024.0, 8401.0, 13401.0, -4524.0, -5024.0, -5024.0, 7901.0, -5024.0, 13401.0, 11401.0, -4524.0, -3524.0, -3524.0, -5524.0, 21401.0, -4024.0, -3024.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 240, 25, 25, 159, 25, 25, 25, 176, 25, 109, 25, 25, 25, 25, 25, 420, 45, 25, 25, 100, 25, 144, 44, 25, 25, 25, 25, 25, 25, 25, 260, 260, 260, 35, 25, 25, 25, 25, 25, 25, 25, 100, 25, 149, 49, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 49, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.150477791312746, "mean_inference_ms": 5.044918107195404, "mean_action_processing_ms": 1.3453694519362143, "mean_env_wait_ms": 0.6387100777663448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008092641830444336, "StateBufferConnector_ms": 0.010692596435546875, "ViewRequirementAgentConnector_ms": 0.4908289909362793}}, "episode_reward_max": 99181.0, "episode_reward_min": -6024.0, "episode_reward_mean": 3743.76, "episode_len_mean": 57.24, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -5024.0, -4524.0, -3024.0, -4024.0, -4024.0, 16401.0, -3524.0, -4024.0, -4024.0, -5024.0, -4024.0, -5524.0, 11401.0, -4024.0, -4524.0, -6024.0, -5024.0, 48961.0, -4524.0, -5524.0, 31442.0, -3524.0, -3024.0, -3524.0, 31925.0, -4524.0, 16992.0, -4024.0, -5024.0, -5024.0, -5024.0, -3524.0, 99181.0, 3456.0, -4524.0, -2524.0, 15901.0, -4024.0, 25957.0, 1457.0, -4524.0, -4524.0, -4524.0, -4024.0, -5024.0, -5524.0, -4024.0, 50841.0, 56241.0, 53241.0, -1534.0, -5024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4524.0, 12401.0, -4024.0, 26452.0, 1952.0, 9901.0, -4524.0, -4524.0, -4024.0, -4024.0, -5024.0, 16401.0, -4024.0, -3024.0, 13401.0, -4024.0, 10401.0, 3052.0, -4024.0, 16401.0, -2524.0, -3524.0, 18401.0, -5024.0, -4024.0, 8401.0, 13401.0, -4524.0, -5024.0, -5024.0, 7901.0, -5024.0, 13401.0, 11401.0, -4524.0, -3524.0, -3524.0, -5524.0, 21401.0, -4024.0, -3024.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 240, 25, 25, 159, 25, 25, 25, 176, 25, 109, 25, 25, 25, 25, 25, 420, 45, 25, 25, 100, 25, 144, 44, 25, 25, 25, 25, 25, 25, 25, 260, 260, 260, 35, 25, 25, 25, 25, 25, 25, 25, 100, 25, 149, 49, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 49, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.150477791312746, "mean_inference_ms": 5.044918107195404, "mean_action_processing_ms": 1.3453694519362143, "mean_env_wait_ms": 0.6387100777663448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008092641830444336, "StateBufferConnector_ms": 0.010692596435546875, "ViewRequirementAgentConnector_ms": 0.4908289909362793}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2510.0134438161886, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 92000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 1601.746, "sample_time_ms": 541.511, "synch_weights_time_ms": 38.017}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 960, "training_iteration": 23, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-55", "timestamp": 1715558515, "time_this_iter_s": 1.6048150062561035, "time_total_s": 37.61984872817993, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be740>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 37.61984872817993, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 47.35, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.27, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.15, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.21500000000000002, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 117555.0, "episode_reward_min": -5524.0, "episode_reward_mean": 2619.3, "episode_len_mean": 52.7, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, 25957.0, 1457.0, -4524.0, -4524.0, -4524.0, -4024.0, -5024.0, -5524.0, -4024.0, 50841.0, 56241.0, 53241.0, -1534.0, -5024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4524.0, 12401.0, -4024.0, 26452.0, 1952.0, 9901.0, -4524.0, -4524.0, -4024.0, -4024.0, -5024.0, 16401.0, -4024.0, -3024.0, 13401.0, -4024.0, 10401.0, 3052.0, -4024.0, 16401.0, -2524.0, -3524.0, 18401.0, -5024.0, -4024.0, 8401.0, 13401.0, -4524.0, -5024.0, -5024.0, 7901.0, -5024.0, 13401.0, 11401.0, -4524.0, -3524.0, -3524.0, -5524.0, 21401.0, -4024.0, -3024.0, -4024.0, -4524.0, -4024.0, -4024.0, -5524.0, -3024.0, 15901.0, -4024.0, -4024.0, 117555.0, -35.0, -3524.0, -4524.0, -4524.0, -4524.0, -4524.0, 563.0, -3024.0, -4024.0, -4524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 21401.0, -5024.0, -4524.0, -4524.0, -3524.0, 14401.0, -4524.0], "episode_lengths": [25, 144, 44, 25, 25, 25, 25, 25, 25, 25, 260, 260, 260, 35, 25, 25, 25, 25, 25, 25, 25, 100, 25, 149, 49, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 49, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 546, 36, 25, 25, 25, 25, 25, 38, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.149108143610283, "mean_inference_ms": 5.041494530893994, "mean_action_processing_ms": 1.3452901504269819, "mean_env_wait_ms": 0.6377731473180188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008234977722167969, "StateBufferConnector_ms": 0.008369207382202148, "ViewRequirementAgentConnector_ms": 0.49301695823669434}}, "episode_reward_max": 117555.0, "episode_reward_min": -5524.0, "episode_reward_mean": 2619.3, "episode_len_mean": 52.7, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, 25957.0, 1457.0, -4524.0, -4524.0, -4524.0, -4024.0, -5024.0, -5524.0, -4024.0, 50841.0, 56241.0, 53241.0, -1534.0, -5024.0, -3024.0, -3524.0, -4024.0, -3024.0, -3524.0, -4524.0, 12401.0, -4024.0, 26452.0, 1952.0, 9901.0, -4524.0, -4524.0, -4024.0, -4024.0, -5024.0, 16401.0, -4024.0, -3024.0, 13401.0, -4024.0, 10401.0, 3052.0, -4024.0, 16401.0, -2524.0, -3524.0, 18401.0, -5024.0, -4024.0, 8401.0, 13401.0, -4524.0, -5024.0, -5024.0, 7901.0, -5024.0, 13401.0, 11401.0, -4524.0, -3524.0, -3524.0, -5524.0, 21401.0, -4024.0, -3024.0, -4024.0, -4524.0, -4024.0, -4024.0, -5524.0, -3024.0, 15901.0, -4024.0, -4024.0, 117555.0, -35.0, -3524.0, -4524.0, -4524.0, -4524.0, -4524.0, 563.0, -3024.0, -4024.0, -4524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 21401.0, -5024.0, -4524.0, -4524.0, -3524.0, 14401.0, -4524.0], "episode_lengths": [25, 144, 44, 25, 25, 25, 25, 25, 25, 25, 260, 260, 260, 35, 25, 25, 25, 25, 25, 25, 25, 100, 25, 149, 49, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 49, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 546, 36, 25, 25, 25, 25, 25, 38, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.149108143610283, "mean_inference_ms": 5.041494530893994, "mean_action_processing_ms": 1.3452901504269819, "mean_env_wait_ms": 0.6377731473180188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008234977722167969, "StateBufferConnector_ms": 0.008369207382202148, "ViewRequirementAgentConnector_ms": 0.49301695823669434}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2493.8836940873407, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 96000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 1602.102, "sample_time_ms": 543.878, "synch_weights_time_ms": 38.803}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 998, "training_iteration": 24, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-56", "timestamp": 1715558516, "time_this_iter_s": 1.612851619720459, "time_total_s": 39.23270034790039, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bdff0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 39.23270034790039, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 47.45, "ram_util_percent": 38.2, "gpu_util_percent0": 0.195, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.195, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.115, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.18, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.33333333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 229033.0, "episode_reward_min": -6024.0, "episode_reward_mean": 8319.81, "episode_len_mean": 76.19, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8401.0, 13401.0, -4524.0, -5024.0, -5024.0, 7901.0, -5024.0, 13401.0, 11401.0, -4524.0, -3524.0, -3524.0, -5524.0, 21401.0, -4024.0, -3024.0, -4024.0, -4524.0, -4024.0, -4024.0, -5524.0, -3024.0, 15901.0, -4024.0, -4024.0, 117555.0, -35.0, -3524.0, -4524.0, -4524.0, -4524.0, -4524.0, 563.0, -3024.0, -4024.0, -4524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 21401.0, -5024.0, -4524.0, -4524.0, -3524.0, 14401.0, -4524.0, 212133.0, 229033.0, 203126.0, 465.0, -2524.0, 18901.0, -2024.0, 17401.0, -4524.0, 11901.0, 1557.0, 19401.0, -4024.0, -4524.0, -3524.0, 21901.0, -4024.0, -4524.0, 12901.0, -4024.0, -3524.0, 9401.0, -2524.0, -4024.0, 9401.0, -4524.0, 11401.0, 16401.0, -3524.0, -2524.0, -5024.0, -4524.0, -4024.0, 16401.0, -5024.0, -5024.0, -4524.0, 8401.0, -3024.0, 35918.0, -4524.0, -4524.0, 14401.0, -4024.0, -6024.0], "episode_lengths": [100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 546, 36, 25, 25, 25, 25, 25, 38, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 968, 968, 875, 36, 25, 100, 25, 100, 25, 100, 44, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 183, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1401755749239495, "mean_inference_ms": 5.037015702849175, "mean_action_processing_ms": 1.3423570103367277, "mean_env_wait_ms": 0.636911827146877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007882833480834961, "StateBufferConnector_ms": 0.007843971252441406, "ViewRequirementAgentConnector_ms": 0.47934603691101074}}, "episode_reward_max": 229033.0, "episode_reward_min": -6024.0, "episode_reward_mean": 8319.81, "episode_len_mean": 76.19, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8401.0, 13401.0, -4524.0, -5024.0, -5024.0, 7901.0, -5024.0, 13401.0, 11401.0, -4524.0, -3524.0, -3524.0, -5524.0, 21401.0, -4024.0, -3024.0, -4024.0, -4524.0, -4024.0, -4024.0, -5524.0, -3024.0, 15901.0, -4024.0, -4024.0, 117555.0, -35.0, -3524.0, -4524.0, -4524.0, -4524.0, -4524.0, 563.0, -3024.0, -4024.0, -4524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 21401.0, -5024.0, -4524.0, -4524.0, -3524.0, 14401.0, -4524.0, 212133.0, 229033.0, 203126.0, 465.0, -2524.0, 18901.0, -2024.0, 17401.0, -4524.0, 11901.0, 1557.0, 19401.0, -4024.0, -4524.0, -3524.0, 21901.0, -4024.0, -4524.0, 12901.0, -4024.0, -3524.0, 9401.0, -2524.0, -4024.0, 9401.0, -4524.0, 11401.0, 16401.0, -3524.0, -2524.0, -5024.0, -4524.0, -4024.0, 16401.0, -5024.0, -5024.0, -4524.0, 8401.0, -3024.0, 35918.0, -4524.0, -4524.0, 14401.0, -4024.0, -6024.0], "episode_lengths": [100, 100, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 546, 36, 25, 25, 25, 25, 25, 38, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 968, 968, 875, 36, 25, 100, 25, 100, 25, 100, 44, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 183, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1401755749239495, "mean_inference_ms": 5.037015702849175, "mean_action_processing_ms": 1.3423570103367277, "mean_env_wait_ms": 0.636911827146877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007882833480834961, "StateBufferConnector_ms": 0.007843971252441406, "ViewRequirementAgentConnector_ms": 0.47934603691101074}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2576.0867846161523, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 100000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 1600.227, "sample_time_ms": 544.687, "synch_weights_time_ms": 38.208}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1043, "training_iteration": 25, "trial_id": "df94b_00000", "date": "2024-05-12_17-01-58", "timestamp": 1715558518, "time_this_iter_s": 1.5617382526397705, "time_total_s": 40.79443860054016, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be710>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 40.79443860054016, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 46.6, "ram_util_percent": 38.1, "gpu_util_percent0": 0.215, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.13, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.09, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.215, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.296875, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 229033.0, "episode_reward_min": -6524.0, "episode_reward_mean": 12791.11, "episode_len_mean": 95.89, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -4524.0, -3524.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 21401.0, -5024.0, -4524.0, -4524.0, -3524.0, 14401.0, -4524.0, 212133.0, 229033.0, 203126.0, 465.0, -2524.0, 18901.0, -2024.0, 17401.0, -4524.0, 11901.0, 1557.0, 19401.0, -4024.0, -4524.0, -3524.0, 21901.0, -4024.0, -4524.0, 12901.0, -4024.0, -3524.0, 9401.0, -2524.0, -4024.0, 9401.0, -4524.0, 11401.0, 16401.0, -3524.0, -2524.0, -5024.0, -4524.0, -4024.0, 16401.0, -5024.0, -5024.0, -4524.0, 8401.0, -3024.0, 35918.0, -4524.0, -4524.0, 14401.0, -4024.0, -6024.0, -3024.0, -4524.0, -3524.0, -4024.0, -3524.0, -4024.0, -3024.0, -6524.0, -4024.0, -3024.0, -4524.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -5524.0, 14401.0, -3024.0, 26493.0, 3559.0, -3524.0, 210570.0, 192123.0, 186623.0, -2527.0, -4524.0, -4524.0, -3024.0, 15901.0, -5024.0, -3024.0, -4524.0, -4024.0, 12401.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 968, 968, 875, 36, 25, 100, 25, 100, 25, 100, 44, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 183, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 108, 42, 25, 1031, 878, 878, 28, 25, 25, 25, 100, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.137257524636941, "mean_inference_ms": 5.037362879395598, "mean_action_processing_ms": 1.3428933558099954, "mean_env_wait_ms": 0.6368133021032925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007748842239379883, "StateBufferConnector_ms": 0.008525609970092773, "ViewRequirementAgentConnector_ms": 0.48069024085998535}}, "episode_reward_max": 229033.0, "episode_reward_min": -6524.0, "episode_reward_mean": 12791.11, "episode_len_mean": 95.89, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -4524.0, -3524.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 21401.0, -5024.0, -4524.0, -4524.0, -3524.0, 14401.0, -4524.0, 212133.0, 229033.0, 203126.0, 465.0, -2524.0, 18901.0, -2024.0, 17401.0, -4524.0, 11901.0, 1557.0, 19401.0, -4024.0, -4524.0, -3524.0, 21901.0, -4024.0, -4524.0, 12901.0, -4024.0, -3524.0, 9401.0, -2524.0, -4024.0, 9401.0, -4524.0, 11401.0, 16401.0, -3524.0, -2524.0, -5024.0, -4524.0, -4024.0, 16401.0, -5024.0, -5024.0, -4524.0, 8401.0, -3024.0, 35918.0, -4524.0, -4524.0, 14401.0, -4024.0, -6024.0, -3024.0, -4524.0, -3524.0, -4024.0, -3524.0, -4024.0, -3024.0, -6524.0, -4024.0, -3024.0, -4524.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -5524.0, 14401.0, -3024.0, 26493.0, 3559.0, -3524.0, 210570.0, 192123.0, 186623.0, -2527.0, -4524.0, -4524.0, -3024.0, 15901.0, -5024.0, -3024.0, -4524.0, -4024.0, 12401.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 968, 968, 875, 36, 25, 100, 25, 100, 25, 100, 44, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 183, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 108, 42, 25, 1031, 878, 878, 28, 25, 25, 25, 100, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.137257524636941, "mean_inference_ms": 5.037362879395598, "mean_action_processing_ms": 1.3428933558099954, "mean_env_wait_ms": 0.6368133021032925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007748842239379883, "StateBufferConnector_ms": 0.008525609970092773, "ViewRequirementAgentConnector_ms": 0.48069024085998535}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2401.9450106702425, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 104000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 1608.677, "sample_time_ms": 546.007, "synch_weights_time_ms": 38.238}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1082, "training_iteration": 26, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-00", "timestamp": 1715558520, "time_this_iter_s": 1.6753289699554443, "time_total_s": 42.469767570495605, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bd0c0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 42.469767570495605, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 40.36666666666667, "ram_util_percent": 38.1, "gpu_util_percent0": 0.22333333333333336, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.12, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.13999999999999999, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.12333333333333334, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": "checkpoint_000005"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 241535.0, "episode_reward_min": -6524.0, "episode_reward_mean": 9260.56, "episode_len_mean": 81.44, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9401.0, -4524.0, 11401.0, 16401.0, -3524.0, -2524.0, -5024.0, -4524.0, -4024.0, 16401.0, -5024.0, -5024.0, -4524.0, 8401.0, -3024.0, 35918.0, -4524.0, -4524.0, 14401.0, -4024.0, -6024.0, -3024.0, -4524.0, -3524.0, -4024.0, -3524.0, -4024.0, -3024.0, -6524.0, -4024.0, -3024.0, -4524.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -5524.0, 14401.0, -3024.0, 26493.0, 3559.0, -3524.0, 210570.0, 192123.0, 186623.0, -2527.0, -4524.0, -4524.0, -3024.0, 15901.0, -5024.0, -3024.0, -4524.0, -4024.0, 12401.0, -3524.0, -4524.0, -4024.0, -5024.0, 15401.0, -4524.0, -4524.0, -3524.0, 19401.0, 15901.0, -3524.0, -3524.0, -4524.0, -3024.0, -4024.0, -4524.0, -3524.0, -4524.0, -4524.0, -4024.0, 13901.0, -3524.0, 241535.0, 74163.0, 41307.0, 1957.0, 40922.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -5024.0, -4524.0, -4024.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0], "episode_lengths": [100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 183, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 108, 42, 25, 1031, 878, 878, 28, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 1066, 338, 194, 44, 179, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.144767518807787, "mean_inference_ms": 5.042629831734018, "mean_action_processing_ms": 1.3448777700956525, "mean_env_wait_ms": 0.637039299682134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007726430892944336, "StateBufferConnector_ms": 0.008745670318603516, "ViewRequirementAgentConnector_ms": 0.49513864517211914}}, "episode_reward_max": 241535.0, "episode_reward_min": -6524.0, "episode_reward_mean": 9260.56, "episode_len_mean": 81.44, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9401.0, -4524.0, 11401.0, 16401.0, -3524.0, -2524.0, -5024.0, -4524.0, -4024.0, 16401.0, -5024.0, -5024.0, -4524.0, 8401.0, -3024.0, 35918.0, -4524.0, -4524.0, 14401.0, -4024.0, -6024.0, -3024.0, -4524.0, -3524.0, -4024.0, -3524.0, -4024.0, -3024.0, -6524.0, -4024.0, -3024.0, -4524.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -5524.0, 14401.0, -3024.0, 26493.0, 3559.0, -3524.0, 210570.0, 192123.0, 186623.0, -2527.0, -4524.0, -4524.0, -3024.0, 15901.0, -5024.0, -3024.0, -4524.0, -4024.0, 12401.0, -3524.0, -4524.0, -4024.0, -5024.0, 15401.0, -4524.0, -4524.0, -3524.0, 19401.0, 15901.0, -3524.0, -3524.0, -4524.0, -3024.0, -4024.0, -4524.0, -3524.0, -4524.0, -4524.0, -4024.0, 13901.0, -3524.0, 241535.0, 74163.0, 41307.0, 1957.0, 40922.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -5024.0, -4524.0, -4024.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0], "episode_lengths": [100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 183, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 108, 42, 25, 1031, 878, 878, 28, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 1066, 338, 194, 44, 179, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.144767518807787, "mean_inference_ms": 5.042629831734018, "mean_action_processing_ms": 1.3448777700956525, "mean_env_wait_ms": 0.637039299682134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007726430892944336, "StateBufferConnector_ms": 0.008745670318603516, "ViewRequirementAgentConnector_ms": 0.49513864517211914}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2509.035222052067, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 108000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 1605.643, "sample_time_ms": 547.835, "synch_weights_time_ms": 37.875}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1122, "training_iteration": 27, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-01", "timestamp": 1715558521, "time_this_iter_s": 1.606332540512085, "time_total_s": 44.07610011100769, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72c970>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 44.07610011100769, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 47.3, "ram_util_percent": 38.1, "gpu_util_percent0": 0.295, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.185, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.24, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.11, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 241535.0, "episode_reward_min": -6024.0, "episode_reward_mean": 9635.64, "episode_len_mean": 83.36, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, 210570.0, 192123.0, 186623.0, -2527.0, -4524.0, -4524.0, -3024.0, 15901.0, -5024.0, -3024.0, -4524.0, -4024.0, 12401.0, -3524.0, -4524.0, -4024.0, -5024.0, 15401.0, -4524.0, -4524.0, -3524.0, 19401.0, 15901.0, -3524.0, -3524.0, -4524.0, -3024.0, -4024.0, -4524.0, -3524.0, -4524.0, -4524.0, -4024.0, 13901.0, -3524.0, 241535.0, 74163.0, 41307.0, 1957.0, 40922.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -5024.0, -4524.0, -4024.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -3524.0, 12401.0, -3524.0, -3024.0, 7901.0, -3024.0, -4024.0, -4024.0, -4024.0, -3524.0, -3524.0, -2524.0, 16401.0, -5024.0, -3524.0, 11401.0, -4524.0, -2024.0, 12901.0, -5524.0, -3024.0, 17901.0, -4524.0, 16401.0, -4524.0, -4524.0, -3524.0, -5024.0, 14901.0, -4524.0, -4524.0, -4024.0, 14901.0, -3524.0, 15401.0, -4524.0, 12401.0, -4024.0, 11401.0, -5024.0, -3524.0, -5524.0, 12901.0, -6024.0, -5024.0, -3524.0], "episode_lengths": [25, 1031, 878, 878, 28, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 1066, 338, 194, 44, 179, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.127864604177807, "mean_inference_ms": 5.03137047950803, "mean_action_processing_ms": 1.3395086908519618, "mean_env_wait_ms": 0.6352248375893932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007538318634033203, "StateBufferConnector_ms": 0.008554458618164062, "ViewRequirementAgentConnector_ms": 0.4886765480041504}}, "episode_reward_max": 241535.0, "episode_reward_min": -6024.0, "episode_reward_mean": 9635.64, "episode_len_mean": 83.36, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, 210570.0, 192123.0, 186623.0, -2527.0, -4524.0, -4524.0, -3024.0, 15901.0, -5024.0, -3024.0, -4524.0, -4024.0, 12401.0, -3524.0, -4524.0, -4024.0, -5024.0, 15401.0, -4524.0, -4524.0, -3524.0, 19401.0, 15901.0, -3524.0, -3524.0, -4524.0, -3024.0, -4024.0, -4524.0, -3524.0, -4524.0, -4524.0, -4024.0, 13901.0, -3524.0, 241535.0, 74163.0, 41307.0, 1957.0, 40922.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -5024.0, -4524.0, -4024.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -3524.0, 12401.0, -3524.0, -3024.0, 7901.0, -3024.0, -4024.0, -4024.0, -4024.0, -3524.0, -3524.0, -2524.0, 16401.0, -5024.0, -3524.0, 11401.0, -4524.0, -2024.0, 12901.0, -5524.0, -3024.0, 17901.0, -4524.0, 16401.0, -4524.0, -4524.0, -3524.0, -5024.0, 14901.0, -4524.0, -4524.0, -4024.0, 14901.0, -3524.0, 15401.0, -4524.0, 12401.0, -4024.0, 11401.0, -5024.0, -3524.0, -5524.0, 12901.0, -6024.0, -5024.0, -3524.0], "episode_lengths": [25, 1031, 878, 878, 28, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 1066, 338, 194, 44, 179, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.127864604177807, "mean_inference_ms": 5.03137047950803, "mean_action_processing_ms": 1.3395086908519618, "mean_env_wait_ms": 0.6352248375893932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007538318634033203, "StateBufferConnector_ms": 0.008554458618164062, "ViewRequirementAgentConnector_ms": 0.4886765480041504}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2482.7184921745134, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 1604.508, "sample_time_ms": 546.548, "synch_weights_time_ms": 37.92}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1168, "training_iteration": 28, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-03", "timestamp": 1715558523, "time_this_iter_s": 1.6252648830413818, "time_total_s": 45.70136499404907, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72f880>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 45.70136499404907, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 46.900000000000006, "ram_util_percent": 38.1, "gpu_util_percent0": 0.225, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.16, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.14, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.155, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 241535.0, "episode_reward_min": -6024.0, "episode_reward_mean": 3094.11, "episode_len_mean": 54.89, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13901.0, -3524.0, 241535.0, 74163.0, 41307.0, 1957.0, 40922.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -5024.0, -4524.0, -4024.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -3524.0, 12401.0, -3524.0, -3024.0, 7901.0, -3024.0, -4024.0, -4024.0, -4024.0, -3524.0, -3524.0, -2524.0, 16401.0, -5024.0, -3524.0, 11401.0, -4524.0, -2024.0, 12901.0, -5524.0, -3024.0, 17901.0, -4524.0, 16401.0, -4524.0, -4524.0, -3524.0, -5024.0, 14901.0, -4524.0, -4524.0, -4024.0, 14901.0, -3524.0, 15401.0, -4524.0, 12401.0, -4024.0, 11401.0, -5024.0, -3524.0, -5524.0, 12901.0, -6024.0, -5024.0, -3524.0, -4524.0, -4524.0, -5024.0, -3524.0, -6024.0, 12401.0, -3024.0, -3524.0, -4024.0, -5024.0, -3524.0, -3524.0, -4024.0, -5524.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, -5524.0, -442.0, -3024.0, -2524.0, -5024.0, -2524.0, -3524.0, 14401.0, -5024.0, -6024.0, -4024.0, -5524.0, 13401.0, -4524.0], "episode_lengths": [100, 25, 1066, 338, 194, 44, 179, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 43, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.127118857422001, "mean_inference_ms": 5.0258043769023475, "mean_action_processing_ms": 1.3388688230574421, "mean_env_wait_ms": 0.6338991932957296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073201656341552734, "StateBufferConnector_ms": 0.007383823394775391, "ViewRequirementAgentConnector_ms": 0.4724421501159668}}, "episode_reward_max": 241535.0, "episode_reward_min": -6024.0, "episode_reward_mean": 3094.11, "episode_len_mean": 54.89, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13901.0, -3524.0, 241535.0, 74163.0, 41307.0, 1957.0, 40922.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -5024.0, -4524.0, -4024.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -3524.0, 12401.0, -3524.0, -3024.0, 7901.0, -3024.0, -4024.0, -4024.0, -4024.0, -3524.0, -3524.0, -2524.0, 16401.0, -5024.0, -3524.0, 11401.0, -4524.0, -2024.0, 12901.0, -5524.0, -3024.0, 17901.0, -4524.0, 16401.0, -4524.0, -4524.0, -3524.0, -5024.0, 14901.0, -4524.0, -4524.0, -4024.0, 14901.0, -3524.0, 15401.0, -4524.0, 12401.0, -4024.0, 11401.0, -5024.0, -3524.0, -5524.0, 12901.0, -6024.0, -5024.0, -3524.0, -4524.0, -4524.0, -5024.0, -3524.0, -6024.0, 12401.0, -3024.0, -3524.0, -4024.0, -5024.0, -3524.0, -3524.0, -4024.0, -5524.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, -5524.0, -442.0, -3024.0, -2524.0, -5024.0, -2524.0, -3524.0, 14401.0, -5024.0, -6024.0, -4024.0, -5524.0, 13401.0, -4524.0], "episode_lengths": [100, 25, 1066, 338, 194, 44, 179, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 43, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.127118857422001, "mean_inference_ms": 5.0258043769023475, "mean_action_processing_ms": 1.3388688230574421, "mean_env_wait_ms": 0.6338991932957296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073201656341552734, "StateBufferConnector_ms": 0.007383823394775391, "ViewRequirementAgentConnector_ms": 0.4724421501159668}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2524.9954322808167, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 116000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 1608.054, "sample_time_ms": 543.896, "synch_weights_time_ms": 37.767}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1202, "training_iteration": 29, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-05", "timestamp": 1715558525, "time_this_iter_s": 1.5923082828521729, "time_total_s": 47.293673276901245, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec717310>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 47.293673276901245, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 46.6, "ram_util_percent": 38.2, "gpu_util_percent0": 0.20500000000000002, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.09, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.095, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.26, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 252457.0, "episode_reward_min": -6024.0, "episode_reward_mean": 12844.45, "episode_len_mean": 96.55, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14901.0, -3524.0, 15401.0, -4524.0, 12401.0, -4024.0, 11401.0, -5024.0, -3524.0, -5524.0, 12901.0, -6024.0, -5024.0, -3524.0, -4524.0, -4524.0, -5024.0, -3524.0, -6024.0, 12401.0, -3024.0, -3524.0, -4024.0, -5024.0, -3524.0, -3524.0, -4024.0, -5524.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, -5524.0, -442.0, -3024.0, -2524.0, -5024.0, -2524.0, -3524.0, 14401.0, -5024.0, -6024.0, -4024.0, -5524.0, 13401.0, -4524.0, -5524.0, -3024.0, 13401.0, -3524.0, 15901.0, 180271.0, 80123.0, 80123.0, -2527.0, -5524.0, 13401.0, -4524.0, 15901.0, -3524.0, -3024.0, -5024.0, 14901.0, 194756.0, 456.0, -4024.0, 13901.0, -3524.0, 13901.0, 252457.0, 131442.0, 128442.0, -1534.0, -4524.0, -4524.0, 5901.0, -3024.0, 16901.0, 13401.0, -5524.0, -4024.0, 17401.0, -4524.0, -4024.0, 12401.0, -5524.0, -4024.0, -4524.0, 9901.0, 71267.0, 76167.0, 78167.0, 467.0, -4524.0, -4024.0, 5401.0, -4524.0, -6024.0], "episode_lengths": [100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 43, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 830, 378, 378, 28, 25, 100, 25, 100, 25, 25, 25, 100, 845, 45, 25, 100, 25, 100, 1144, 559, 559, 35, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 334, 334, 334, 34, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.12114215203597, "mean_inference_ms": 5.019510842710025, "mean_action_processing_ms": 1.3372134750133549, "mean_env_wait_ms": 0.6328903611182443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007360219955444336, "StateBufferConnector_ms": 0.00955820083618164, "ViewRequirementAgentConnector_ms": 0.4835367202758789}}, "episode_reward_max": 252457.0, "episode_reward_min": -6024.0, "episode_reward_mean": 12844.45, "episode_len_mean": 96.55, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14901.0, -3524.0, 15401.0, -4524.0, 12401.0, -4024.0, 11401.0, -5024.0, -3524.0, -5524.0, 12901.0, -6024.0, -5024.0, -3524.0, -4524.0, -4524.0, -5024.0, -3524.0, -6024.0, 12401.0, -3024.0, -3524.0, -4024.0, -5024.0, -3524.0, -3524.0, -4024.0, -5524.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, -5524.0, -442.0, -3024.0, -2524.0, -5024.0, -2524.0, -3524.0, 14401.0, -5024.0, -6024.0, -4024.0, -5524.0, 13401.0, -4524.0, -5524.0, -3024.0, 13401.0, -3524.0, 15901.0, 180271.0, 80123.0, 80123.0, -2527.0, -5524.0, 13401.0, -4524.0, 15901.0, -3524.0, -3024.0, -5024.0, 14901.0, 194756.0, 456.0, -4024.0, 13901.0, -3524.0, 13901.0, 252457.0, 131442.0, 128442.0, -1534.0, -4524.0, -4524.0, 5901.0, -3024.0, 16901.0, 13401.0, -5524.0, -4024.0, 17401.0, -4524.0, -4024.0, 12401.0, -5524.0, -4024.0, -4524.0, 9901.0, 71267.0, 76167.0, 78167.0, 467.0, -4524.0, -4024.0, 5401.0, -4524.0, -6024.0], "episode_lengths": [100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 43, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 830, 378, 378, 28, 25, 100, 25, 100, 25, 25, 25, 100, 845, 45, 25, 100, 25, 100, 1144, 559, 559, 35, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 334, 334, 334, 34, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.12114215203597, "mean_inference_ms": 5.019510842710025, "mean_action_processing_ms": 1.3372134750133549, "mean_env_wait_ms": 0.6328903611182443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007360219955444336, "StateBufferConnector_ms": 0.00955820083618164, "ViewRequirementAgentConnector_ms": 0.4835367202758789}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2524.7579449394057, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 120000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 1603.381, "sample_time_ms": 542.168, "synch_weights_time_ms": 37.188}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1254, "training_iteration": 30, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-06", "timestamp": 1715558526, "time_this_iter_s": 1.5942027568817139, "time_total_s": 48.88787603378296, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bd3f0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 48.88787603378296, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 47.35, "ram_util_percent": 38.2, "gpu_util_percent0": 0.15, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.18, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.155, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 252457.0, "episode_reward_min": -6524.0, "episode_reward_mean": 16715.79, "episode_len_mean": 112.21, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5024.0, -2524.0, -3524.0, 14401.0, -5024.0, -6024.0, -4024.0, -5524.0, 13401.0, -4524.0, -5524.0, -3024.0, 13401.0, -3524.0, 15901.0, 180271.0, 80123.0, 80123.0, -2527.0, -5524.0, 13401.0, -4524.0, 15901.0, -3524.0, -3024.0, -5024.0, 14901.0, 194756.0, 456.0, -4024.0, 13901.0, -3524.0, 13901.0, 252457.0, 131442.0, 128442.0, -1534.0, -4524.0, -4524.0, 5901.0, -3024.0, 16901.0, 13401.0, -5524.0, -4024.0, 17401.0, -4524.0, -4024.0, 12401.0, -5524.0, -4024.0, -4524.0, 9901.0, 71267.0, 76167.0, 78167.0, 467.0, -4524.0, -4024.0, 5401.0, -4524.0, -6024.0, -3524.0, -4024.0, -4524.0, -4024.0, -5024.0, -4024.0, -4024.0, -3524.0, -4524.0, -3524.0, -4524.0, -4024.0, -5024.0, -3524.0, -4524.0, -4524.0, 151958.0, 1958.0, -5024.0, -5024.0, -3024.0, -3524.0, 13401.0, -5524.0, 10401.0, -3524.0, -3024.0, -4024.0, -6524.0, -4024.0, 29462.0, -4524.0, 239034.0, -41.0, 12401.0, -5024.0, -3024.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 830, 378, 378, 28, 25, 100, 25, 100, 25, 25, 25, 100, 845, 45, 25, 100, 25, 100, 1144, 559, 559, 35, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 334, 334, 334, 34, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 643, 43, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 139, 25, 1067, 42, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.116316773602952, "mean_inference_ms": 5.011658435151369, "mean_action_processing_ms": 1.3350238345552075, "mean_env_wait_ms": 0.6316704851433113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007637977600097656, "StateBufferConnector_ms": 0.010345697402954102, "ViewRequirementAgentConnector_ms": 0.4902007579803467}}, "episode_reward_max": 252457.0, "episode_reward_min": -6524.0, "episode_reward_mean": 16715.79, "episode_len_mean": 112.21, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5024.0, -2524.0, -3524.0, 14401.0, -5024.0, -6024.0, -4024.0, -5524.0, 13401.0, -4524.0, -5524.0, -3024.0, 13401.0, -3524.0, 15901.0, 180271.0, 80123.0, 80123.0, -2527.0, -5524.0, 13401.0, -4524.0, 15901.0, -3524.0, -3024.0, -5024.0, 14901.0, 194756.0, 456.0, -4024.0, 13901.0, -3524.0, 13901.0, 252457.0, 131442.0, 128442.0, -1534.0, -4524.0, -4524.0, 5901.0, -3024.0, 16901.0, 13401.0, -5524.0, -4024.0, 17401.0, -4524.0, -4024.0, 12401.0, -5524.0, -4024.0, -4524.0, 9901.0, 71267.0, 76167.0, 78167.0, 467.0, -4524.0, -4024.0, 5401.0, -4524.0, -6024.0, -3524.0, -4024.0, -4524.0, -4024.0, -5024.0, -4024.0, -4024.0, -3524.0, -4524.0, -3524.0, -4524.0, -4024.0, -5024.0, -3524.0, -4524.0, -4524.0, 151958.0, 1958.0, -5024.0, -5024.0, -3024.0, -3524.0, 13401.0, -5524.0, 10401.0, -3524.0, -3024.0, -4024.0, -6524.0, -4024.0, 29462.0, -4524.0, 239034.0, -41.0, 12401.0, -5024.0, -3024.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 830, 378, 378, 28, 25, 100, 25, 100, 25, 25, 25, 100, 845, 45, 25, 100, 25, 100, 1144, 559, 559, 35, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 334, 334, 334, 34, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 643, 43, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 139, 25, 1067, 42, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.116316773602952, "mean_inference_ms": 5.011658435151369, "mean_action_processing_ms": 1.3350238345552075, "mean_env_wait_ms": 0.6316704851433113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007637977600097656, "StateBufferConnector_ms": 0.010345697402954102, "ViewRequirementAgentConnector_ms": 0.4902007579803467}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2503.6801849031385, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 124000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 1598.92, "sample_time_ms": 539.224, "synch_weights_time_ms": 36.669}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1292, "training_iteration": 31, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-08", "timestamp": 1715558528, "time_this_iter_s": 1.6087183952331543, "time_total_s": 50.49659442901611, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bc4f0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 50.49659442901611, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 40.666666666666664, "ram_util_percent": 38.2, "gpu_util_percent0": 0.16333333333333333, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.10333333333333333, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.14333333333333334, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.17999999999999997, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": "checkpoint_000006"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 239034.0, "episode_reward_min": -6524.0, "episode_reward_mean": 6900.8, "episode_len_mean": 70.2, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128442.0, -1534.0, -4524.0, -4524.0, 5901.0, -3024.0, 16901.0, 13401.0, -5524.0, -4024.0, 17401.0, -4524.0, -4024.0, 12401.0, -5524.0, -4024.0, -4524.0, 9901.0, 71267.0, 76167.0, 78167.0, 467.0, -4524.0, -4024.0, 5401.0, -4524.0, -6024.0, -3524.0, -4024.0, -4524.0, -4024.0, -5024.0, -4024.0, -4024.0, -3524.0, -4524.0, -3524.0, -4524.0, -4024.0, -5024.0, -3524.0, -4524.0, -4524.0, 151958.0, 1958.0, -5024.0, -5024.0, -3024.0, -3524.0, 13401.0, -5524.0, 10401.0, -3524.0, -3024.0, -4024.0, -6524.0, -4024.0, 29462.0, -4524.0, 239034.0, -41.0, 12401.0, -5024.0, -3024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 11401.0, -3524.0, -3524.0, 15901.0, 15901.0, -4024.0, -3024.0, -3524.0, -4524.0, -4024.0, -5024.0, -3524.0, -4024.0, -5024.0, -4024.0, -3524.0, 15401.0, -2024.0, -5524.0, 16901.0, -4024.0, -4524.0, -2524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4024.0, -2524.0, -3524.0, 22470.0], "episode_lengths": [559, 35, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 334, 334, 334, 34, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 643, 43, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 139, 25, 1067, 42, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.119693016531706, "mean_inference_ms": 5.017048167714618, "mean_action_processing_ms": 1.3364983888582982, "mean_env_wait_ms": 0.6324639936839866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007847785949707031, "StateBufferConnector_ms": 0.00941777229309082, "ViewRequirementAgentConnector_ms": 0.49781322479248047}}, "episode_reward_max": 239034.0, "episode_reward_min": -6524.0, "episode_reward_mean": 6900.8, "episode_len_mean": 70.2, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [128442.0, -1534.0, -4524.0, -4524.0, 5901.0, -3024.0, 16901.0, 13401.0, -5524.0, -4024.0, 17401.0, -4524.0, -4024.0, 12401.0, -5524.0, -4024.0, -4524.0, 9901.0, 71267.0, 76167.0, 78167.0, 467.0, -4524.0, -4024.0, 5401.0, -4524.0, -6024.0, -3524.0, -4024.0, -4524.0, -4024.0, -5024.0, -4024.0, -4024.0, -3524.0, -4524.0, -3524.0, -4524.0, -4024.0, -5024.0, -3524.0, -4524.0, -4524.0, 151958.0, 1958.0, -5024.0, -5024.0, -3024.0, -3524.0, 13401.0, -5524.0, 10401.0, -3524.0, -3024.0, -4024.0, -6524.0, -4024.0, 29462.0, -4524.0, 239034.0, -41.0, 12401.0, -5024.0, -3024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 11401.0, -3524.0, -3524.0, 15901.0, 15901.0, -4024.0, -3024.0, -3524.0, -4524.0, -4024.0, -5024.0, -3524.0, -4024.0, -5024.0, -4024.0, -3524.0, 15401.0, -2024.0, -5524.0, 16901.0, -4024.0, -4524.0, -2524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4024.0, -2524.0, -3524.0, 22470.0], "episode_lengths": [559, 35, 25, 25, 100, 25, 100, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 334, 334, 334, 34, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 643, 43, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 139, 25, 1067, 42, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.119693016531706, "mean_inference_ms": 5.017048167714618, "mean_action_processing_ms": 1.3364983888582982, "mean_env_wait_ms": 0.6324639936839866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007847785949707031, "StateBufferConnector_ms": 0.00941777229309082, "ViewRequirementAgentConnector_ms": 0.49781322479248047}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2535.3333451205094, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 128000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 1596.434, "sample_time_ms": 540.177, "synch_weights_time_ms": 36.376}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1327, "training_iteration": 32, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-10", "timestamp": 1715558530, "time_this_iter_s": 1.586510419845581, "time_total_s": 52.083104848861694, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be590>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 52.083104848861694, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 46.7, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.17500000000000002, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.12, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.12, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.23500000000000001, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 293817.0, "episode_reward_min": -6524.0, "episode_reward_mean": 8614.03, "episode_len_mean": 77.97, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5524.0, 10401.0, -3524.0, -3024.0, -4024.0, -6524.0, -4024.0, 29462.0, -4524.0, 239034.0, -41.0, 12401.0, -5024.0, -3024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 11401.0, -3524.0, -3524.0, 15901.0, 15901.0, -4024.0, -3024.0, -3524.0, -4524.0, -4024.0, -5024.0, -3524.0, -4024.0, -5024.0, -4024.0, -3524.0, 15401.0, -2024.0, -5524.0, 16901.0, -4024.0, -4524.0, -2524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4024.0, -2524.0, -3524.0, 22470.0, -5024.0, 16401.0, -4024.0, -3524.0, 16401.0, -3524.0, -2524.0, -4524.0, -4524.0, -4024.0, -5024.0, -4524.0, 13401.0, -5024.0, -4024.0, 15901.0, -4427.0, 20901.0, -3524.0, -3524.0, 9901.0, -4524.0, 16901.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 19901.0, -5024.0, -3024.0, -3524.0, 15401.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -4524.0, -3524.0, -4524.0, 262317.0, 293817.0, 6940.0, 6440.0, -3524.0, 15901.0, -4024.0, -3024.0, -5024.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 139, 25, 1067, 42, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 131, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 28, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 1284, 1284, 61, 61, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.11407454299071, "mean_inference_ms": 5.0133643182414405, "mean_action_processing_ms": 1.3350834383698094, "mean_env_wait_ms": 0.6323476652349797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007843494415283203, "StateBufferConnector_ms": 0.008407831192016602, "ViewRequirementAgentConnector_ms": 0.4853818416595459}}, "episode_reward_max": 293817.0, "episode_reward_min": -6524.0, "episode_reward_mean": 8614.03, "episode_len_mean": 77.97, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5524.0, 10401.0, -3524.0, -3024.0, -4024.0, -6524.0, -4024.0, 29462.0, -4524.0, 239034.0, -41.0, 12401.0, -5024.0, -3024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 11401.0, -3524.0, -3524.0, 15901.0, 15901.0, -4024.0, -3024.0, -3524.0, -4524.0, -4024.0, -5024.0, -3524.0, -4024.0, -5024.0, -4024.0, -3524.0, 15401.0, -2024.0, -5524.0, 16901.0, -4024.0, -4524.0, -2524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4024.0, -2524.0, -3524.0, 22470.0, -5024.0, 16401.0, -4024.0, -3524.0, 16401.0, -3524.0, -2524.0, -4524.0, -4524.0, -4024.0, -5024.0, -4524.0, 13401.0, -5024.0, -4024.0, 15901.0, -4427.0, 20901.0, -3524.0, -3524.0, 9901.0, -4524.0, 16901.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 19901.0, -5024.0, -3024.0, -3524.0, 15401.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -4524.0, -3524.0, -4524.0, 262317.0, 293817.0, 6940.0, 6440.0, -3524.0, 15901.0, -4024.0, -3024.0, -5024.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 139, 25, 1067, 42, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 131, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 28, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 1284, 1284, 61, 61, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.11407454299071, "mean_inference_ms": 5.0133643182414405, "mean_action_processing_ms": 1.3350834383698094, "mean_env_wait_ms": 0.6323476652349797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007843494415283203, "StateBufferConnector_ms": 0.008407831192016602, "ViewRequirementAgentConnector_ms": 0.4853818416595459}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2401.96701915679, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 132000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 1603.602, "sample_time_ms": 540.599, "synch_weights_time_ms": 35.741}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1377, "training_iteration": 33, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-11", "timestamp": 1715558531, "time_this_iter_s": 1.676090955734253, "time_total_s": 53.75919580459595, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bfe20>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 53.75919580459595, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 46.5, "ram_util_percent": 38.2, "gpu_util_percent0": 0.23, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.16, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.2, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.1, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 293817.0, "episode_reward_min": -5524.0, "episode_reward_mean": 10943.81, "episode_len_mean": 87.19, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5524.0, 16901.0, -4024.0, -4524.0, -2524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4024.0, -2524.0, -3524.0, 22470.0, -5024.0, 16401.0, -4024.0, -3524.0, 16401.0, -3524.0, -2524.0, -4524.0, -4524.0, -4024.0, -5024.0, -4524.0, 13401.0, -5024.0, -4024.0, 15901.0, -4427.0, 20901.0, -3524.0, -3524.0, 9901.0, -4524.0, 16901.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 19901.0, -5024.0, -3024.0, -3524.0, 15401.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -4524.0, -3524.0, -4524.0, 262317.0, 293817.0, 6940.0, 6440.0, -3524.0, 15901.0, -4024.0, -3024.0, -5024.0, -3524.0, -5024.0, -4024.0, -3524.0, -4524.0, 10401.0, 242510.0, 157860.0, 152360.0, -546.0, -3524.0, -3524.0, -3524.0, -3524.0, -4524.0, -4524.0, -4024.0, -5024.0, -3524.0, -2024.0, -2524.0, -4524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -4524.0, -4524.0, 20901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4524.0, -5524.0, -5024.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 131, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 28, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 1284, 1284, 61, 61, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 1091, 641, 641, 47, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.110302358363713, "mean_inference_ms": 5.011763294839508, "mean_action_processing_ms": 1.3333496874603994, "mean_env_wait_ms": 0.6310964637611427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007550954818725586, "StateBufferConnector_ms": 0.008837461471557617, "ViewRequirementAgentConnector_ms": 0.4710683822631836}}, "episode_reward_max": 293817.0, "episode_reward_min": -5524.0, "episode_reward_mean": 10943.81, "episode_len_mean": 87.19, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5524.0, 16901.0, -4024.0, -4524.0, -2524.0, -4024.0, -3024.0, -3024.0, -4024.0, -4024.0, -2524.0, -3524.0, 22470.0, -5024.0, 16401.0, -4024.0, -3524.0, 16401.0, -3524.0, -2524.0, -4524.0, -4524.0, -4024.0, -5024.0, -4524.0, 13401.0, -5024.0, -4024.0, 15901.0, -4427.0, 20901.0, -3524.0, -3524.0, 9901.0, -4524.0, 16901.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 19901.0, -5024.0, -3024.0, -3524.0, 15401.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -4524.0, -3524.0, -4524.0, 262317.0, 293817.0, 6940.0, 6440.0, -3524.0, 15901.0, -4024.0, -3024.0, -5024.0, -3524.0, -5024.0, -4024.0, -3524.0, -4524.0, 10401.0, 242510.0, 157860.0, 152360.0, -546.0, -3524.0, -3524.0, -3524.0, -3524.0, -4524.0, -4524.0, -4024.0, -5024.0, -3524.0, -2024.0, -2524.0, -4524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -4524.0, -4524.0, 20901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4524.0, -5524.0, -5024.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 131, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 28, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 1284, 1284, 61, 61, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 1091, 641, 641, 47, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.110302358363713, "mean_inference_ms": 5.011763294839508, "mean_action_processing_ms": 1.3333496874603994, "mean_env_wait_ms": 0.6310964637611427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007550954818725586, "StateBufferConnector_ms": 0.008837461471557617, "ViewRequirementAgentConnector_ms": 0.4710683822631836}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2546.1885897556726, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 136000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 1600.307, "sample_time_ms": 538.302, "synch_weights_time_ms": 35.799}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1414, "training_iteration": 34, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-13", "timestamp": 1715558533, "time_this_iter_s": 1.582775592803955, "time_total_s": 55.3419713973999, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be680>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 55.3419713973999, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 47.35, "ram_util_percent": 38.2, "gpu_util_percent0": 0.22999999999999998, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.155, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.21, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.175, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 293817.0, "episode_reward_min": -8024.0, "episode_reward_mean": 11424.38, "episode_len_mean": 90.62, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, 15401.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -4524.0, -3524.0, -4524.0, 262317.0, 293817.0, 6940.0, 6440.0, -3524.0, 15901.0, -4024.0, -3024.0, -5024.0, -3524.0, -5024.0, -4024.0, -3524.0, -4524.0, 10401.0, 242510.0, 157860.0, 152360.0, -546.0, -3524.0, -3524.0, -3524.0, -3524.0, -4524.0, -4524.0, -4024.0, -5024.0, -3524.0, -2024.0, -2524.0, -4524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -4524.0, -4524.0, 20901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4524.0, -5524.0, -5024.0, -4524.0, -4524.0, 12901.0, -4024.0, 11401.0, -3024.0, -4024.0, 8401.0, -4524.0, 22401.0, -5024.0, -3524.0, 17401.0, -2524.0, -3524.0, 15401.0, -4524.0, 14901.0, -5024.0, -3024.0, -4524.0, 14401.0, -4024.0, 9901.0, -6024.0, 13901.0, -5426.0, -5524.0, 15901.0, -4524.0, -4024.0, 14901.0, -4024.0, -5524.0, -8024.0, 17401.0, -5024.0, -5524.0, -3524.0, -4024.0, 10401.0, -5524.0, 14901.0, -6024.0], "episode_lengths": [25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 1284, 1284, 61, 61, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 1091, 641, 641, 47, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 27, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.114013113153934, "mean_inference_ms": 5.010788659139736, "mean_action_processing_ms": 1.3329507102722706, "mean_env_wait_ms": 0.6311170649308404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007841348648071289, "StateBufferConnector_ms": 0.008689641952514648, "ViewRequirementAgentConnector_ms": 0.47043561935424805}}, "episode_reward_max": 293817.0, "episode_reward_min": -8024.0, "episode_reward_mean": 11424.38, "episode_len_mean": 90.62, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, 15401.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -4524.0, -3524.0, -4524.0, 262317.0, 293817.0, 6940.0, 6440.0, -3524.0, 15901.0, -4024.0, -3024.0, -5024.0, -3524.0, -5024.0, -4024.0, -3524.0, -4524.0, 10401.0, 242510.0, 157860.0, 152360.0, -546.0, -3524.0, -3524.0, -3524.0, -3524.0, -4524.0, -4524.0, -4024.0, -5024.0, -3524.0, -2024.0, -2524.0, -4524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -4524.0, -4524.0, 20901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4524.0, -5524.0, -5024.0, -4524.0, -4524.0, 12901.0, -4024.0, 11401.0, -3024.0, -4024.0, 8401.0, -4524.0, 22401.0, -5024.0, -3524.0, 17401.0, -2524.0, -3524.0, 15401.0, -4524.0, 14901.0, -5024.0, -3024.0, -4524.0, 14401.0, -4024.0, 9901.0, -6024.0, 13901.0, -5426.0, -5524.0, 15901.0, -4524.0, -4024.0, 14901.0, -4024.0, -5524.0, -8024.0, 17401.0, -5024.0, -5524.0, -3524.0, -4024.0, 10401.0, -5524.0, 14901.0, -6024.0], "episode_lengths": [25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 1284, 1284, 61, 61, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 1091, 641, 641, 47, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 27, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.114013113153934, "mean_inference_ms": 5.010788659139736, "mean_action_processing_ms": 1.3329507102722706, "mean_env_wait_ms": 0.6311170649308404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007841348648071289, "StateBufferConnector_ms": 0.008689641952514648, "ViewRequirementAgentConnector_ms": 0.47043561935424805}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2486.8567525510816, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 140000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 1605.879, "sample_time_ms": 538.119, "synch_weights_time_ms": 36.519}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1458, "training_iteration": 35, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-15", "timestamp": 1715558535, "time_this_iter_s": 1.6185681819915771, "time_total_s": 56.96053957939148, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72f340>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 56.96053957939148, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 47.55, "ram_util_percent": 38.2, "gpu_util_percent0": 0.225, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.16, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.125, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.16, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 200229.0, "episode_reward_min": -8024.0, "episode_reward_mean": 1773.54, "episode_len_mean": 49.46, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -2024.0, -2524.0, -4524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -4524.0, -4524.0, 20901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4524.0, -5524.0, -5024.0, -4524.0, -4524.0, 12901.0, -4024.0, 11401.0, -3024.0, -4024.0, 8401.0, -4524.0, 22401.0, -5024.0, -3524.0, 17401.0, -2524.0, -3524.0, 15401.0, -4524.0, 14901.0, -5024.0, -3024.0, -4524.0, 14401.0, -4024.0, 9901.0, -6024.0, 13901.0, -5426.0, -5524.0, 15901.0, -4524.0, -4024.0, 14901.0, -4024.0, -5524.0, -8024.0, 17401.0, -5024.0, -5524.0, -3524.0, -4024.0, 10401.0, -5524.0, 14901.0, -6024.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -5024.0, -5024.0, -4024.0, -4524.0, 200229.0, 2454.0, -3524.0, -3524.0, -4024.0, -2524.0, -3524.0, -4524.0, -3524.0, -3024.0, -3524.0, -3524.0, -5524.0, 15401.0, -4024.0, 14901.0, -4024.0, -3024.0, -4524.0, -4524.0, 15401.0, -4524.0, -3524.0, 9901.0, -3524.0, -3524.0, -3524.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 27, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 872, 47, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.110673671698913, "mean_inference_ms": 5.0069875156616765, "mean_action_processing_ms": 1.3319901685684656, "mean_env_wait_ms": 0.6300622050184175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008049488067626953, "StateBufferConnector_ms": 0.0068662166595458984, "ViewRequirementAgentConnector_ms": 0.4785444736480713}}, "episode_reward_max": 200229.0, "episode_reward_min": -8024.0, "episode_reward_mean": 1773.54, "episode_len_mean": 49.46, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -2024.0, -2524.0, -4524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4524.0, -4524.0, -4524.0, 20901.0, -4024.0, 10401.0, -4524.0, -4524.0, -4524.0, -5524.0, -5024.0, -4524.0, -4524.0, 12901.0, -4024.0, 11401.0, -3024.0, -4024.0, 8401.0, -4524.0, 22401.0, -5024.0, -3524.0, 17401.0, -2524.0, -3524.0, 15401.0, -4524.0, 14901.0, -5024.0, -3024.0, -4524.0, 14401.0, -4024.0, 9901.0, -6024.0, 13901.0, -5426.0, -5524.0, 15901.0, -4524.0, -4024.0, 14901.0, -4024.0, -5524.0, -8024.0, 17401.0, -5024.0, -5524.0, -3524.0, -4024.0, 10401.0, -5524.0, 14901.0, -6024.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -5024.0, -5024.0, -4024.0, -4524.0, 200229.0, 2454.0, -3524.0, -3524.0, -4024.0, -2524.0, -3524.0, -4524.0, -3524.0, -3024.0, -3524.0, -3524.0, -5524.0, 15401.0, -4024.0, 14901.0, -4024.0, -3024.0, -4524.0, -4524.0, 15401.0, -4524.0, -3524.0, 9901.0, -3524.0, -3524.0, -3524.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 27, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 872, 47, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.110673671698913, "mean_inference_ms": 5.0069875156616765, "mean_action_processing_ms": 1.3319901685684656, "mean_env_wait_ms": 0.6300622050184175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008049488067626953, "StateBufferConnector_ms": 0.0068662166595458984, "ViewRequirementAgentConnector_ms": 0.4785444736480713}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2530.667716912176, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 144000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 1597.408, "sample_time_ms": 536.708, "synch_weights_time_ms": 37.296}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1495, "training_iteration": 36, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-17", "timestamp": 1715558537, "time_this_iter_s": 1.5910778045654297, "time_total_s": 58.55161738395691, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72fc70>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 58.55161738395691, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 40.6, "ram_util_percent": 38.2, "gpu_util_percent0": 0.17, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14666666666666664, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.08666666666666667, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.22666666666666666, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": "checkpoint_000007"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 291380.0, "episode_reward_min": -8024.0, "episode_reward_mean": 3989.67, "episode_len_mean": 59.33, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, 14401.0, -4024.0, 9901.0, -6024.0, 13901.0, -5426.0, -5524.0, 15901.0, -4524.0, -4024.0, 14901.0, -4024.0, -5524.0, -8024.0, 17401.0, -5024.0, -5524.0, -3524.0, -4024.0, 10401.0, -5524.0, 14901.0, -6024.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -5024.0, -5024.0, -4024.0, -4524.0, 200229.0, 2454.0, -3524.0, -3524.0, -4024.0, -2524.0, -3524.0, -4524.0, -3524.0, -3024.0, -3524.0, -3524.0, -5524.0, 15401.0, -4024.0, 14901.0, -4024.0, -3024.0, -4524.0, -4524.0, 15401.0, -4524.0, -3524.0, 9901.0, -3524.0, -3524.0, -3524.0, -4024.0, -2524.0, -4524.0, -4524.0, -6524.0, 15901.0, -4524.0, 12401.0, 14401.0, -3524.0, -5024.0, -4024.0, -5024.0, -4024.0, -5024.0, -4024.0, -6524.0, -3524.0, -4524.0, -5024.0, -3524.0, -4024.0, 15401.0, -4024.0, -4524.0, 12901.0, -3024.0, -3524.0, -8024.0, 291380.0, 1460.0, -4024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4524.0, -4024.0, 7901.0], "episode_lengths": [25, 100, 25, 100, 25, 100, 27, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 872, 47, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 1221, 41, 25, 25, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.115657287170246, "mean_inference_ms": 5.011698398493062, "mean_action_processing_ms": 1.3329988615506643, "mean_env_wait_ms": 0.6304170514528624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008123159408569336, "StateBufferConnector_ms": 0.007458686828613281, "ViewRequirementAgentConnector_ms": 0.4788932800292969}}, "episode_reward_max": 291380.0, "episode_reward_min": -8024.0, "episode_reward_mean": 3989.67, "episode_len_mean": 59.33, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, 14401.0, -4024.0, 9901.0, -6024.0, 13901.0, -5426.0, -5524.0, 15901.0, -4524.0, -4024.0, 14901.0, -4024.0, -5524.0, -8024.0, 17401.0, -5024.0, -5524.0, -3524.0, -4024.0, 10401.0, -5524.0, 14901.0, -6024.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -5024.0, -5024.0, -4024.0, -4524.0, 200229.0, 2454.0, -3524.0, -3524.0, -4024.0, -2524.0, -3524.0, -4524.0, -3524.0, -3024.0, -3524.0, -3524.0, -5524.0, 15401.0, -4024.0, 14901.0, -4024.0, -3024.0, -4524.0, -4524.0, 15401.0, -4524.0, -3524.0, 9901.0, -3524.0, -3524.0, -3524.0, -4024.0, -2524.0, -4524.0, -4524.0, -6524.0, 15901.0, -4524.0, 12401.0, 14401.0, -3524.0, -5024.0, -4024.0, -5024.0, -4024.0, -5024.0, -4024.0, -6524.0, -3524.0, -4524.0, -5024.0, -3524.0, -4024.0, 15401.0, -4024.0, -4524.0, 12901.0, -3024.0, -3524.0, -8024.0, 291380.0, 1460.0, -4024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4524.0, -4024.0, 7901.0], "episode_lengths": [25, 100, 25, 100, 25, 100, 27, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 872, 47, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 1221, 41, 25, 25, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.115657287170246, "mean_inference_ms": 5.011698398493062, "mean_action_processing_ms": 1.3329988615506643, "mean_env_wait_ms": 0.6304170514528624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008123159408569336, "StateBufferConnector_ms": 0.007458686828613281, "ViewRequirementAgentConnector_ms": 0.4788932800292969}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2619.43940315584, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 148000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 1590.688, "sample_time_ms": 535.427, "synch_weights_time_ms": 37.795}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1534, "training_iteration": 37, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-18", "timestamp": 1715558538, "time_this_iter_s": 1.536700963973999, "time_total_s": 60.08831834793091, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72fc10>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 60.08831834793091, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 47.05, "ram_util_percent": 38.2, "gpu_util_percent0": 0.13, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.18, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.2, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 291380.0, "episode_reward_min": -8024.0, "episode_reward_mean": 2824.28, "episode_len_mean": 53.72, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -5524.0, 15401.0, -4024.0, 14901.0, -4024.0, -3024.0, -4524.0, -4524.0, 15401.0, -4524.0, -3524.0, 9901.0, -3524.0, -3524.0, -3524.0, -4024.0, -2524.0, -4524.0, -4524.0, -6524.0, 15901.0, -4524.0, 12401.0, 14401.0, -3524.0, -5024.0, -4024.0, -5024.0, -4024.0, -5024.0, -4024.0, -6524.0, -3524.0, -4524.0, -5024.0, -3524.0, -4024.0, 15401.0, -4024.0, -4524.0, 12901.0, -3024.0, -3524.0, -8024.0, 291380.0, 1460.0, -4024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4524.0, -4024.0, 7901.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -5024.0, -3524.0, -5024.0, -5024.0, -4524.0, -5024.0, -4524.0, 14401.0, -4524.0, -5024.0, 21901.0, -5524.0, 15901.0, -6024.0, -5024.0, 14901.0, -3524.0, 12401.0, -4024.0, -5524.0, -4524.0, -5024.0, 13401.0, -4524.0, -4024.0, -4024.0, 12401.0, -3024.0, 17401.0, -1434.0, 11401.0, -4024.0, -4024.0, -2524.0, -3024.0, -5024.0, 14901.0, -3524.0, -4524.0], "episode_lengths": [25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 1221, 41, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 35, 100, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.10612186332467, "mean_inference_ms": 5.004024400277956, "mean_action_processing_ms": 1.3307244662099589, "mean_env_wait_ms": 0.6289700039675723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007802248001098633, "StateBufferConnector_ms": 0.007317543029785156, "ViewRequirementAgentConnector_ms": 0.4775359630584717}}, "episode_reward_max": 291380.0, "episode_reward_min": -8024.0, "episode_reward_mean": 2824.28, "episode_len_mean": 53.72, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -5524.0, 15401.0, -4024.0, 14901.0, -4024.0, -3024.0, -4524.0, -4524.0, 15401.0, -4524.0, -3524.0, 9901.0, -3524.0, -3524.0, -3524.0, -4024.0, -2524.0, -4524.0, -4524.0, -6524.0, 15901.0, -4524.0, 12401.0, 14401.0, -3524.0, -5024.0, -4024.0, -5024.0, -4024.0, -5024.0, -4024.0, -6524.0, -3524.0, -4524.0, -5024.0, -3524.0, -4024.0, 15401.0, -4024.0, -4524.0, 12901.0, -3024.0, -3524.0, -8024.0, 291380.0, 1460.0, -4024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4524.0, -4024.0, 7901.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -5024.0, -3524.0, -5024.0, -5024.0, -4524.0, -5024.0, -4524.0, 14401.0, -4524.0, -5024.0, 21901.0, -5524.0, 15901.0, -6024.0, -5024.0, 14901.0, -3524.0, 12401.0, -4024.0, -5524.0, -4524.0, -5024.0, 13401.0, -4524.0, -4024.0, -4024.0, 12401.0, -3024.0, 17401.0, -1434.0, 11401.0, -4024.0, -4024.0, -2524.0, -3024.0, -5024.0, 14901.0, -3524.0, -4524.0], "episode_lengths": [25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 1221, 41, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 35, 100, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.10612186332467, "mean_inference_ms": 5.004024400277956, "mean_action_processing_ms": 1.3307244662099589, "mean_env_wait_ms": 0.6289700039675723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007802248001098633, "StateBufferConnector_ms": 0.007317543029785156, "ViewRequirementAgentConnector_ms": 0.4775359630584717}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2471.041961513984, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 152000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 1591.451, "sample_time_ms": 537.087, "synch_weights_time_ms": 38.111}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1578, "training_iteration": 38, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-20", "timestamp": 1715558540, "time_this_iter_s": 1.6303155422210693, "time_total_s": 61.71863389015198, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bf970>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 61.71863389015198, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 49.5, "ram_util_percent": 38.2, "gpu_util_percent0": 0.18, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.15, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.07, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.21500000000000002, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 291380.0, "episode_reward_min": -8024.0, "episode_reward_mean": 7352.41, "episode_len_mean": 72.59, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, 15401.0, -4024.0, -4524.0, 12901.0, -3024.0, -3524.0, -8024.0, 291380.0, 1460.0, -4024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4524.0, -4024.0, 7901.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -5024.0, -3524.0, -5024.0, -5024.0, -4524.0, -5024.0, -4524.0, 14401.0, -4524.0, -5024.0, 21901.0, -5524.0, 15901.0, -6024.0, -5024.0, 14901.0, -3524.0, 12401.0, -4024.0, -5524.0, -4524.0, -5024.0, 13401.0, -4524.0, -4024.0, -4024.0, 12401.0, -3024.0, 17401.0, -1434.0, 11401.0, -4024.0, -4024.0, -2524.0, -3024.0, -5024.0, 14901.0, -3524.0, -4524.0, -2524.0, -4524.0, -4524.0, -3024.0, -4024.0, 15901.0, -6024.0, -4524.0, -5024.0, -3524.0, -3524.0, -5024.0, -4524.0, -3524.0, -5524.0, -4524.0, 59796.0, -3027.0, -3524.0, -3024.0, -4024.0, -4024.0, -5024.0, -3524.0, -4524.0, -4024.0, -5524.0, 11401.0, -3524.0, 16901.0, -4024.0, -5524.0, -3024.0, -3024.0, 221633.0, 220033.0, 958.0], "episode_lengths": [25, 100, 25, 25, 100, 25, 25, 25, 1221, 41, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 35, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 305, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 968, 968, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.111418473084581, "mean_inference_ms": 5.004322044571179, "mean_action_processing_ms": 1.3311894028301297, "mean_env_wait_ms": 0.6292581962275782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077457427978515625, "StateBufferConnector_ms": 0.007543802261352539, "ViewRequirementAgentConnector_ms": 0.4859805107116699}}, "episode_reward_max": 291380.0, "episode_reward_min": -8024.0, "episode_reward_mean": 7352.41, "episode_len_mean": 72.59, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, 15401.0, -4024.0, -4524.0, 12901.0, -3024.0, -3524.0, -8024.0, 291380.0, 1460.0, -4024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4524.0, -4024.0, 7901.0, -4524.0, 20401.0, -4524.0, -4024.0, 14901.0, -5024.0, -3524.0, -5024.0, -5024.0, -4524.0, -5024.0, -4524.0, 14401.0, -4524.0, -5024.0, 21901.0, -5524.0, 15901.0, -6024.0, -5024.0, 14901.0, -3524.0, 12401.0, -4024.0, -5524.0, -4524.0, -5024.0, 13401.0, -4524.0, -4024.0, -4024.0, 12401.0, -3024.0, 17401.0, -1434.0, 11401.0, -4024.0, -4024.0, -2524.0, -3024.0, -5024.0, 14901.0, -3524.0, -4524.0, -2524.0, -4524.0, -4524.0, -3024.0, -4024.0, 15901.0, -6024.0, -4524.0, -5024.0, -3524.0, -3524.0, -5024.0, -4524.0, -3524.0, -5524.0, -4524.0, 59796.0, -3027.0, -3524.0, -3024.0, -4024.0, -4024.0, -5024.0, -3524.0, -4524.0, -4024.0, -5524.0, 11401.0, -3524.0, 16901.0, -4024.0, -5524.0, -3024.0, -3024.0, 221633.0, 220033.0, 958.0], "episode_lengths": [25, 100, 25, 25, 100, 25, 25, 25, 1221, 41, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 35, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 305, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 968, 968, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.111418473084581, "mean_inference_ms": 5.004322044571179, "mean_action_processing_ms": 1.3311894028301297, "mean_env_wait_ms": 0.6292581962275782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077457427978515625, "StateBufferConnector_ms": 0.007543802261352539, "ViewRequirementAgentConnector_ms": 0.4859805107116699}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2600.89899380595, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 156000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 1586.829, "sample_time_ms": 536.702, "synch_weights_time_ms": 38.369}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1615, "training_iteration": 39, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-21", "timestamp": 1715558541, "time_this_iter_s": 1.5513198375701904, "time_total_s": 63.26995372772217, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be3e0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 63.26995372772217, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 48.55, "ram_util_percent": 38.2, "gpu_util_percent0": 0.3, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.10500000000000001, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.14, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.23, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 221633.0, "episode_reward_min": -6024.0, "episode_reward_mean": 5245.53, "episode_len_mean": 63.47, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, -4024.0, 12401.0, -3024.0, 17401.0, -1434.0, 11401.0, -4024.0, -4024.0, -2524.0, -3024.0, -5024.0, 14901.0, -3524.0, -4524.0, -2524.0, -4524.0, -4524.0, -3024.0, -4024.0, 15901.0, -6024.0, -4524.0, -5024.0, -3524.0, -3524.0, -5024.0, -4524.0, -3524.0, -5524.0, -4524.0, 59796.0, -3027.0, -3524.0, -3024.0, -4024.0, -4024.0, -5024.0, -3524.0, -4524.0, -4024.0, -5524.0, 11401.0, -3524.0, 16901.0, -4024.0, -5524.0, -3024.0, -3024.0, 221633.0, 220033.0, 958.0, -4524.0, -4524.0, 16401.0, -4024.0, 16401.0, -3024.0, -3524.0, 16401.0, -5024.0, 13401.0, -3024.0, -4524.0, -3024.0, 14901.0, -5524.0, -3524.0, 16901.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 12401.0, -4524.0, 16401.0, -4024.0, 15401.0, -4024.0, -3024.0, 14901.0, -5024.0, -5024.0, 12901.0, -3524.0, -2524.0, -3524.0, -4024.0, -4024.0, 9901.0, -4524.0, -4524.0, -4024.0, -3024.0, 12401.0, -2524.0, 10901.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 100, 35, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 305, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 968, 968, 43, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1083054988740875, "mean_inference_ms": 5.003814004850657, "mean_action_processing_ms": 1.33086667654753, "mean_env_wait_ms": 0.6289806560779585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007899761199951172, "StateBufferConnector_ms": 0.007117748260498047, "ViewRequirementAgentConnector_ms": 0.4843409061431885}}, "episode_reward_max": 221633.0, "episode_reward_min": -6024.0, "episode_reward_mean": 5245.53, "episode_len_mean": 63.47, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, -4024.0, 12401.0, -3024.0, 17401.0, -1434.0, 11401.0, -4024.0, -4024.0, -2524.0, -3024.0, -5024.0, 14901.0, -3524.0, -4524.0, -2524.0, -4524.0, -4524.0, -3024.0, -4024.0, 15901.0, -6024.0, -4524.0, -5024.0, -3524.0, -3524.0, -5024.0, -4524.0, -3524.0, -5524.0, -4524.0, 59796.0, -3027.0, -3524.0, -3024.0, -4024.0, -4024.0, -5024.0, -3524.0, -4524.0, -4024.0, -5524.0, 11401.0, -3524.0, 16901.0, -4024.0, -5524.0, -3024.0, -3024.0, 221633.0, 220033.0, 958.0, -4524.0, -4524.0, 16401.0, -4024.0, 16401.0, -3024.0, -3524.0, 16401.0, -5024.0, 13401.0, -3024.0, -4524.0, -3024.0, 14901.0, -5524.0, -3524.0, 16901.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 12401.0, -4524.0, 16401.0, -4024.0, 15401.0, -4024.0, -3024.0, 14901.0, -5024.0, -5024.0, 12901.0, -3524.0, -2524.0, -3524.0, -4024.0, -4024.0, 9901.0, -4524.0, -4524.0, -4024.0, -3024.0, 12401.0, -2524.0, 10901.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 100, 35, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 305, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 968, 968, 43, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1083054988740875, "mean_inference_ms": 5.003814004850657, "mean_action_processing_ms": 1.33086667654753, "mean_env_wait_ms": 0.6289806560779585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007899761199951172, "StateBufferConnector_ms": 0.007117748260498047, "ViewRequirementAgentConnector_ms": 0.4843409061431885}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2498.090534626481, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 160000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 1588.52, "sample_time_ms": 535.884, "synch_weights_time_ms": 37.955}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1662, "training_iteration": 40, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-23", "timestamp": 1715558543, "time_this_iter_s": 1.613074779510498, "time_total_s": 64.88302850723267, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bfbe0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 64.88302850723267, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 46.95, "ram_util_percent": 38.2, "gpu_util_percent0": 0.13, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.11, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.2, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.21500000000000002, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 343604.0, "episode_reward_min": -5524.0, "episode_reward_mean": 10796.81, "episode_len_mean": 87.19, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -4524.0, -4024.0, -5524.0, 11401.0, -3524.0, 16901.0, -4024.0, -5524.0, -3024.0, -3024.0, 221633.0, 220033.0, 958.0, -4524.0, -4524.0, 16401.0, -4024.0, 16401.0, -3024.0, -3524.0, 16401.0, -5024.0, 13401.0, -3024.0, -4524.0, -3024.0, 14901.0, -5524.0, -3524.0, 16901.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 12401.0, -4524.0, 16401.0, -4024.0, 15401.0, -4024.0, -3024.0, 14901.0, -5024.0, -5024.0, 12901.0, -3524.0, -2524.0, -3524.0, -4024.0, -4024.0, 9901.0, -4524.0, -4524.0, -4024.0, -3024.0, 12401.0, -2524.0, 10901.0, -4024.0, -5024.0, -5024.0, -5524.0, -3524.0, -3024.0, -3524.0, -4524.0, -5024.0, -3524.0, -4024.0, -4524.0, -4024.0, 87665.0, 91565.0, 91565.0, -1035.0, -5524.0, 343604.0, 2952.0, -4024.0, -4524.0, -4524.0, -3524.0, -3024.0, 14901.0, -4024.0, 16901.0, -4024.0, -4524.0, -5524.0, 17901.0, -4524.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0], "episode_lengths": [25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 968, 968, 43, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 436, 436, 436, 36, 25, 1497, 49, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.104366396199063, "mean_inference_ms": 4.9991424835291145, "mean_action_processing_ms": 1.3283977287874371, "mean_env_wait_ms": 0.6281978881995124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007788181304931641, "StateBufferConnector_ms": 0.008002519607543945, "ViewRequirementAgentConnector_ms": 0.4731271266937256}}, "episode_reward_max": 343604.0, "episode_reward_min": -5524.0, "episode_reward_mean": 10796.81, "episode_len_mean": 87.19, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -4524.0, -4024.0, -5524.0, 11401.0, -3524.0, 16901.0, -4024.0, -5524.0, -3024.0, -3024.0, 221633.0, 220033.0, 958.0, -4524.0, -4524.0, 16401.0, -4024.0, 16401.0, -3024.0, -3524.0, 16401.0, -5024.0, 13401.0, -3024.0, -4524.0, -3024.0, 14901.0, -5524.0, -3524.0, 16901.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 12401.0, -4524.0, 16401.0, -4024.0, 15401.0, -4024.0, -3024.0, 14901.0, -5024.0, -5024.0, 12901.0, -3524.0, -2524.0, -3524.0, -4024.0, -4024.0, 9901.0, -4524.0, -4524.0, -4024.0, -3024.0, 12401.0, -2524.0, 10901.0, -4024.0, -5024.0, -5024.0, -5524.0, -3524.0, -3024.0, -3524.0, -4524.0, -5024.0, -3524.0, -4024.0, -4524.0, -4024.0, 87665.0, 91565.0, 91565.0, -1035.0, -5524.0, 343604.0, 2952.0, -4024.0, -4524.0, -4524.0, -3524.0, -3024.0, 14901.0, -4024.0, 16901.0, -4024.0, -4524.0, -5524.0, 17901.0, -4524.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0], "episode_lengths": [25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 968, 968, 43, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 436, 436, 436, 36, 25, 1497, 49, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.104366396199063, "mean_inference_ms": 4.9991424835291145, "mean_action_processing_ms": 1.3283977287874371, "mean_env_wait_ms": 0.6281978881995124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007788181304931641, "StateBufferConnector_ms": 0.008002519607543945, "ViewRequirementAgentConnector_ms": 0.4731271266937256}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2536.095626973056, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 164000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 1586.478, "sample_time_ms": 539.995, "synch_weights_time_ms": 37.412}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1701, "training_iteration": 41, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-25", "timestamp": 1715558545, "time_this_iter_s": 1.587601900100708, "time_total_s": 66.47063040733337, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bdf90>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 66.47063040733337, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 40.93333333333334, "ram_util_percent": 38.2, "gpu_util_percent0": 0.20666666666666667, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.13333333333333333, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.20999999999999996, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.19999999999999998, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": "checkpoint_000008"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 343604.0, "episode_reward_min": -5524.0, "episode_reward_mean": 5712.9, "episode_len_mean": 66.1, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, 12401.0, -4524.0, 16401.0, -4024.0, 15401.0, -4024.0, -3024.0, 14901.0, -5024.0, -5024.0, 12901.0, -3524.0, -2524.0, -3524.0, -4024.0, -4024.0, 9901.0, -4524.0, -4524.0, -4024.0, -3024.0, 12401.0, -2524.0, 10901.0, -4024.0, -5024.0, -5024.0, -5524.0, -3524.0, -3024.0, -3524.0, -4524.0, -5024.0, -3524.0, -4024.0, -4524.0, -4024.0, 87665.0, 91565.0, 91565.0, -1035.0, -5524.0, 343604.0, 2952.0, -4024.0, -4524.0, -4524.0, -3524.0, -3024.0, 14901.0, -4024.0, 16901.0, -4024.0, -4524.0, -5524.0, 17901.0, -4524.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0, -4524.0, -2024.0, 2056.0, -4524.0, 12401.0, -4024.0, 17901.0, 14401.0, -5524.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -2524.0, -3024.0, -4024.0, -2024.0, -4524.0, 13401.0, -4024.0, -3524.0, 17401.0, -4024.0, -4024.0, -3524.0, -3524.0, -5524.0, -2524.0, -4524.0, -3524.0, -5024.0, -5024.0, 12901.0], "episode_lengths": [25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 436, 436, 436, 36, 25, 1497, 49, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 45, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.105927258628288, "mean_inference_ms": 5.000728648547997, "mean_action_processing_ms": 1.3290781974195476, "mean_env_wait_ms": 0.6282587825299798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007739543914794922, "StateBufferConnector_ms": 0.008076667785644531, "ViewRequirementAgentConnector_ms": 0.4870617389678955}}, "episode_reward_max": 343604.0, "episode_reward_min": -5524.0, "episode_reward_mean": 5712.9, "episode_len_mean": 66.1, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, 12401.0, -4524.0, 16401.0, -4024.0, 15401.0, -4024.0, -3024.0, 14901.0, -5024.0, -5024.0, 12901.0, -3524.0, -2524.0, -3524.0, -4024.0, -4024.0, 9901.0, -4524.0, -4524.0, -4024.0, -3024.0, 12401.0, -2524.0, 10901.0, -4024.0, -5024.0, -5024.0, -5524.0, -3524.0, -3024.0, -3524.0, -4524.0, -5024.0, -3524.0, -4024.0, -4524.0, -4024.0, 87665.0, 91565.0, 91565.0, -1035.0, -5524.0, 343604.0, 2952.0, -4024.0, -4524.0, -4524.0, -3524.0, -3024.0, 14901.0, -4024.0, 16901.0, -4024.0, -4524.0, -5524.0, 17901.0, -4524.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0, -4524.0, -2024.0, 2056.0, -4524.0, 12401.0, -4024.0, 17901.0, 14401.0, -5524.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -2524.0, -3024.0, -4024.0, -2024.0, -4524.0, 13401.0, -4024.0, -3524.0, 17401.0, -4024.0, -4024.0, -3524.0, -3524.0, -5524.0, -2524.0, -4524.0, -3524.0, -5024.0, -5024.0, 12901.0], "episode_lengths": [25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 436, 436, 436, 36, 25, 1497, 49, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 45, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.105927258628288, "mean_inference_ms": 5.000728648547997, "mean_action_processing_ms": 1.3290781974195476, "mean_env_wait_ms": 0.6282587825299798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007739543914794922, "StateBufferConnector_ms": 0.008076667785644531, "ViewRequirementAgentConnector_ms": 0.4870617389678955}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2518.67189020011, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 168000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 1587.522, "sample_time_ms": 538.793, "synch_weights_time_ms": 37.757}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1736, "training_iteration": 42, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-27", "timestamp": 1715558547, "time_this_iter_s": 1.5991876125335693, "time_total_s": 68.06981801986694, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72f7c0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 68.06981801986694, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 46.849999999999994, "ram_util_percent": 38.2, "gpu_util_percent0": 0.16499999999999998, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.04, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.195, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.265, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 414288.0, "episode_reward_min": -5524.0, "episode_reward_mean": 16925.84, "episode_len_mean": 111.16, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14901.0, -4024.0, 16901.0, -4024.0, -4524.0, -5524.0, 17901.0, -4524.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0, -4524.0, -2024.0, 2056.0, -4524.0, 12401.0, -4024.0, 17901.0, 14401.0, -5524.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -2524.0, -3024.0, -4024.0, -2024.0, -4524.0, 13401.0, -4024.0, -3524.0, 17401.0, -4024.0, -4024.0, -3524.0, -3524.0, -5524.0, -2524.0, -4524.0, -3524.0, -5024.0, -5024.0, 12901.0, -3524.0, 16401.0, -3524.0, 17901.0, -4524.0, -4024.0, -4024.0, 78241.0, 78641.0, -534.0, -4024.0, -3024.0, 15401.0, -5024.0, -4524.0, 10901.0, -3524.0, -3524.0, 11401.0, -3524.0, -2024.0, 13901.0, -2524.0, 14901.0, -3024.0, -4024.0, -4524.0, -3524.0, 16901.0, 392488.0, 414288.0, 244967.0, -2033.0, -4524.0, -4024.0, 12901.0, -5024.0, 6901.0, 136942.0, 148342.0, 148342.0, 2952.0, 14901.0, -3524.0, -2524.0, -4524.0, -5024.0, -4524.0, 4055.0, -3024.0], "episode_lengths": [100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 45, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 360, 360, 35, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 1713, 1713, 1034, 34, 25, 25, 100, 25, 100, 659, 659, 659, 49, 100, 25, 25, 25, 25, 25, 46, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.097933931700927, "mean_inference_ms": 4.99776659732939, "mean_action_processing_ms": 1.3281884164154958, "mean_env_wait_ms": 0.6279964606730001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007611751556396484, "StateBufferConnector_ms": 0.009785890579223633, "ViewRequirementAgentConnector_ms": 0.4871518611907959}}, "episode_reward_max": 414288.0, "episode_reward_min": -5524.0, "episode_reward_mean": 16925.84, "episode_len_mean": 111.16, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14901.0, -4024.0, 16901.0, -4024.0, -4524.0, -5524.0, 17901.0, -4524.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0, -4524.0, -2024.0, 2056.0, -4524.0, 12401.0, -4024.0, 17901.0, 14401.0, -5524.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -2524.0, -3024.0, -4024.0, -2024.0, -4524.0, 13401.0, -4024.0, -3524.0, 17401.0, -4024.0, -4024.0, -3524.0, -3524.0, -5524.0, -2524.0, -4524.0, -3524.0, -5024.0, -5024.0, 12901.0, -3524.0, 16401.0, -3524.0, 17901.0, -4524.0, -4024.0, -4024.0, 78241.0, 78641.0, -534.0, -4024.0, -3024.0, 15401.0, -5024.0, -4524.0, 10901.0, -3524.0, -3524.0, 11401.0, -3524.0, -2024.0, 13901.0, -2524.0, 14901.0, -3024.0, -4024.0, -4524.0, -3524.0, 16901.0, 392488.0, 414288.0, 244967.0, -2033.0, -4524.0, -4024.0, 12901.0, -5024.0, 6901.0, 136942.0, 148342.0, 148342.0, 2952.0, 14901.0, -3524.0, -2524.0, -4524.0, -5024.0, -4524.0, 4055.0, -3024.0], "episode_lengths": [100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 45, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 360, 360, 35, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 1713, 1713, 1034, 34, 25, 25, 100, 25, 100, 659, 659, 659, 49, 100, 25, 25, 25, 25, 25, 46, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.097933931700927, "mean_inference_ms": 4.99776659732939, "mean_action_processing_ms": 1.3281884164154958, "mean_env_wait_ms": 0.6279964606730001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007611751556396484, "StateBufferConnector_ms": 0.009785890579223633, "ViewRequirementAgentConnector_ms": 0.4871518611907959}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2436.3720379480715, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 172000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 1585.17, "sample_time_ms": 538.005, "synch_weights_time_ms": 38.545}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1786, "training_iteration": 43, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-28", "timestamp": 1715558548, "time_this_iter_s": 1.6534464359283447, "time_total_s": 69.72326445579529, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72ffa0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 69.72326445579529, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 47.35, "ram_util_percent": 38.2, "gpu_util_percent0": 0.18, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14500000000000002, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.26, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.165, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 414288.0, "episode_reward_min": -6524.0, "episode_reward_mean": 24354.29, "episode_len_mean": 143.71, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13401.0, -4024.0, -3524.0, 17401.0, -4024.0, -4024.0, -3524.0, -3524.0, -5524.0, -2524.0, -4524.0, -3524.0, -5024.0, -5024.0, 12901.0, -3524.0, 16401.0, -3524.0, 17901.0, -4524.0, -4024.0, -4024.0, 78241.0, 78641.0, -534.0, -4024.0, -3024.0, 15401.0, -5024.0, -4524.0, 10901.0, -3524.0, -3524.0, 11401.0, -3524.0, -2024.0, 13901.0, -2524.0, 14901.0, -3024.0, -4024.0, -4524.0, -3524.0, 16901.0, 392488.0, 414288.0, 244967.0, -2033.0, -4524.0, -4024.0, 12901.0, -5024.0, 6901.0, 136942.0, 148342.0, 148342.0, 2952.0, 14901.0, -3524.0, -2524.0, -4524.0, -5024.0, -4524.0, 4055.0, -3024.0, -5024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -3024.0, -4024.0, -2524.0, -4524.0, -3024.0, -3024.0, -3024.0, -4024.0, -6024.0, -4524.0, -3024.0, -6524.0, -3524.0, -3524.0, -4024.0, 367362.0, 229022.0, 228022.0, -2528.0, -4024.0, -4024.0, 3052.0, -4024.0, 17901.0, -4024.0, -5524.0, -4024.0, -5024.0, -1524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 360, 360, 35, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 1713, 1713, 1034, 34, 25, 25, 100, 25, 100, 659, 659, 659, 49, 100, 25, 25, 25, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 1739, 979, 979, 29, 25, 25, 49, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.099642396268734, "mean_inference_ms": 4.998596917680216, "mean_action_processing_ms": 1.3272918501981779, "mean_env_wait_ms": 0.6273704716379301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00760650634765625, "StateBufferConnector_ms": 0.010468721389770508, "ViewRequirementAgentConnector_ms": 0.4801647663116455}}, "episode_reward_max": 414288.0, "episode_reward_min": -6524.0, "episode_reward_mean": 24354.29, "episode_len_mean": 143.71, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13401.0, -4024.0, -3524.0, 17401.0, -4024.0, -4024.0, -3524.0, -3524.0, -5524.0, -2524.0, -4524.0, -3524.0, -5024.0, -5024.0, 12901.0, -3524.0, 16401.0, -3524.0, 17901.0, -4524.0, -4024.0, -4024.0, 78241.0, 78641.0, -534.0, -4024.0, -3024.0, 15401.0, -5024.0, -4524.0, 10901.0, -3524.0, -3524.0, 11401.0, -3524.0, -2024.0, 13901.0, -2524.0, 14901.0, -3024.0, -4024.0, -4524.0, -3524.0, 16901.0, 392488.0, 414288.0, 244967.0, -2033.0, -4524.0, -4024.0, 12901.0, -5024.0, 6901.0, 136942.0, 148342.0, 148342.0, 2952.0, 14901.0, -3524.0, -2524.0, -4524.0, -5024.0, -4524.0, 4055.0, -3024.0, -5024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -3024.0, -4024.0, -2524.0, -4524.0, -3024.0, -3024.0, -3024.0, -4024.0, -6024.0, -4524.0, -3024.0, -6524.0, -3524.0, -3524.0, -4024.0, 367362.0, 229022.0, 228022.0, -2528.0, -4024.0, -4024.0, 3052.0, -4024.0, 17901.0, -4024.0, -5524.0, -4024.0, -5024.0, -1524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 360, 360, 35, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 1713, 1713, 1034, 34, 25, 25, 100, 25, 100, 659, 659, 659, 49, 100, 25, 25, 25, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 1739, 979, 979, 29, 25, 25, 49, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.099642396268734, "mean_inference_ms": 4.998596917680216, "mean_action_processing_ms": 1.3272918501981779, "mean_env_wait_ms": 0.6273704716379301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00760650634765625, "StateBufferConnector_ms": 0.010468721389770508, "ViewRequirementAgentConnector_ms": 0.4801647663116455}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2445.223087843986, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 176000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 1591.657, "sample_time_ms": 540.354, "synch_weights_time_ms": 39.287}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1821, "training_iteration": 44, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-30", "timestamp": 1715558550, "time_this_iter_s": 1.6474831104278564, "time_total_s": 71.37074756622314, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bf190>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 71.37074756622314, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 47.400000000000006, "ram_util_percent": 38.2, "gpu_util_percent0": 0.245, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.1, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.19, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.20500000000000002, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 367362.0, "episode_reward_min": -7024.0, "episode_reward_mean": 13389.65, "episode_len_mean": 98.35, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, 12901.0, -5024.0, 6901.0, 136942.0, 148342.0, 148342.0, 2952.0, 14901.0, -3524.0, -2524.0, -4524.0, -5024.0, -4524.0, 4055.0, -3024.0, -5024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -3024.0, -4024.0, -2524.0, -4524.0, -3024.0, -3024.0, -3024.0, -4024.0, -6024.0, -4524.0, -3024.0, -6524.0, -3524.0, -3524.0, -4024.0, 367362.0, 229022.0, 228022.0, -2528.0, -4024.0, -4024.0, 3052.0, -4024.0, 17901.0, -4024.0, -5524.0, -4024.0, -5024.0, -1524.0, -4024.0, -6024.0, 12401.0, -3524.0, 15901.0, -2524.0, 17401.0, -3524.0, 9401.0, -5024.0, -3024.0, -5024.0, 13901.0, -4024.0, -4524.0, 15401.0, -4524.0, 14901.0, -4524.0, -5024.0, 15401.0, -3524.0, 14401.0, -5524.0, -3524.0, 15901.0, -2524.0, -4024.0, 13901.0, -3524.0, -5524.0, -4524.0, 19901.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 15901.0, -4024.0, 36450.0, -7024.0, -4024.0, 1052.0, 39913.0, -4524.0, 14901.0, -3524.0], "episode_lengths": [25, 25, 100, 25, 100, 659, 659, 659, 49, 100, 25, 25, 25, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 1739, 979, 979, 29, 25, 25, 49, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 151, 25, 25, 49, 188, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.102572445742246, "mean_inference_ms": 4.999689056870028, "mean_action_processing_ms": 1.328044209017847, "mean_env_wait_ms": 0.6275419786172959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007681846618652344, "StateBufferConnector_ms": 0.009879112243652344, "ViewRequirementAgentConnector_ms": 0.47220945358276367}}, "episode_reward_max": 367362.0, "episode_reward_min": -7024.0, "episode_reward_mean": 13389.65, "episode_len_mean": 98.35, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, 12901.0, -5024.0, 6901.0, 136942.0, 148342.0, 148342.0, 2952.0, 14901.0, -3524.0, -2524.0, -4524.0, -5024.0, -4524.0, 4055.0, -3024.0, -5024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -3024.0, -4024.0, -2524.0, -4524.0, -3024.0, -3024.0, -3024.0, -4024.0, -6024.0, -4524.0, -3024.0, -6524.0, -3524.0, -3524.0, -4024.0, 367362.0, 229022.0, 228022.0, -2528.0, -4024.0, -4024.0, 3052.0, -4024.0, 17901.0, -4024.0, -5524.0, -4024.0, -5024.0, -1524.0, -4024.0, -6024.0, 12401.0, -3524.0, 15901.0, -2524.0, 17401.0, -3524.0, 9401.0, -5024.0, -3024.0, -5024.0, 13901.0, -4024.0, -4524.0, 15401.0, -4524.0, 14901.0, -4524.0, -5024.0, 15401.0, -3524.0, 14401.0, -5524.0, -3524.0, 15901.0, -2524.0, -4024.0, 13901.0, -3524.0, -5524.0, -4524.0, 19901.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 15901.0, -4024.0, 36450.0, -7024.0, -4024.0, 1052.0, 39913.0, -4524.0, 14901.0, -3524.0], "episode_lengths": [25, 25, 100, 25, 100, 659, 659, 659, 49, 100, 25, 25, 25, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 1739, 979, 979, 29, 25, 25, 49, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 151, 25, 25, 49, 188, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.102572445742246, "mean_inference_ms": 4.999689056870028, "mean_action_processing_ms": 1.328044209017847, "mean_env_wait_ms": 0.6275419786172959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007681846618652344, "StateBufferConnector_ms": 0.009879112243652344, "ViewRequirementAgentConnector_ms": 0.47220945358276367}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2485.9694266889246, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 180000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 1591.711, "sample_time_ms": 540.132, "synch_weights_time_ms": 39.678}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1869, "training_iteration": 45, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-32", "timestamp": 1715558552, "time_this_iter_s": 1.624330759048462, "time_total_s": 72.9950783252716, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5beec0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 72.9950783252716, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 40.5, "ram_util_percent": 38.2, "gpu_util_percent0": 0.33, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.19000000000000003, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.16, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.17333333333333334, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 367362.0, "episode_reward_min": -7024.0, "episode_reward_mean": 8944.27, "episode_len_mean": 78.73, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, -6524.0, -3524.0, -3524.0, -4024.0, 367362.0, 229022.0, 228022.0, -2528.0, -4024.0, -4024.0, 3052.0, -4024.0, 17901.0, -4024.0, -5524.0, -4024.0, -5024.0, -1524.0, -4024.0, -6024.0, 12401.0, -3524.0, 15901.0, -2524.0, 17401.0, -3524.0, 9401.0, -5024.0, -3024.0, -5024.0, 13901.0, -4024.0, -4524.0, 15401.0, -4524.0, 14901.0, -4524.0, -5024.0, 15401.0, -3524.0, 14401.0, -5524.0, -3524.0, 15901.0, -2524.0, -4024.0, 13901.0, -3524.0, -5524.0, -4524.0, 19901.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 15901.0, -4024.0, 36450.0, -7024.0, -4024.0, 1052.0, 39913.0, -4524.0, 14901.0, -3524.0, -5024.0, -2524.0, -3524.0, 8038.0, -3524.0, -4024.0, -3024.0, -3024.0, -4524.0, -6024.0, -3024.0, -5024.0, -4024.0, -4524.0, -3024.0, -5024.0, -5524.0, -6524.0, 12901.0, -3024.0, -4024.0, 17401.0, -4024.0, 2054.0, -4524.0, -5524.0, -3524.0, -4524.0, 22901.0, -3024.0, -2524.0, -4024.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 1739, 979, 979, 29, 25, 25, 49, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 151, 25, 25, 49, 188, 25, 100, 25, 25, 25, 25, 63, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 47, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.104748210622807, "mean_inference_ms": 5.0024181578786, "mean_action_processing_ms": 1.3283266792710726, "mean_env_wait_ms": 0.6276476077351542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007904052734375, "StateBufferConnector_ms": 0.008205175399780273, "ViewRequirementAgentConnector_ms": 0.46933460235595703}}, "episode_reward_max": 367362.0, "episode_reward_min": -7024.0, "episode_reward_mean": 8944.27, "episode_len_mean": 78.73, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, -6524.0, -3524.0, -3524.0, -4024.0, 367362.0, 229022.0, 228022.0, -2528.0, -4024.0, -4024.0, 3052.0, -4024.0, 17901.0, -4024.0, -5524.0, -4024.0, -5024.0, -1524.0, -4024.0, -6024.0, 12401.0, -3524.0, 15901.0, -2524.0, 17401.0, -3524.0, 9401.0, -5024.0, -3024.0, -5024.0, 13901.0, -4024.0, -4524.0, 15401.0, -4524.0, 14901.0, -4524.0, -5024.0, 15401.0, -3524.0, 14401.0, -5524.0, -3524.0, 15901.0, -2524.0, -4024.0, 13901.0, -3524.0, -5524.0, -4524.0, 19901.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 15901.0, -4024.0, 36450.0, -7024.0, -4024.0, 1052.0, 39913.0, -4524.0, 14901.0, -3524.0, -5024.0, -2524.0, -3524.0, 8038.0, -3524.0, -4024.0, -3024.0, -3024.0, -4524.0, -6024.0, -3024.0, -5024.0, -4024.0, -4524.0, -3024.0, -5024.0, -5524.0, -6524.0, 12901.0, -3024.0, -4024.0, 17401.0, -4024.0, 2054.0, -4524.0, -5524.0, -3524.0, -4524.0, 22901.0, -3024.0, -2524.0, -4024.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 1739, 979, 979, 29, 25, 25, 49, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 151, 25, 25, 49, 188, 25, 100, 25, 25, 25, 25, 63, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 47, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.104748210622807, "mean_inference_ms": 5.0024181578786, "mean_action_processing_ms": 1.3283266792710726, "mean_env_wait_ms": 0.6276476077351542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007904052734375, "StateBufferConnector_ms": 0.008205175399780273, "ViewRequirementAgentConnector_ms": 0.46933460235595703}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2302.1573888599355, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 184000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 1607.4, "sample_time_ms": 549.229, "synch_weights_time_ms": 40.026}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1902, "training_iteration": 46, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-34", "timestamp": 1715558554, "time_this_iter_s": 1.748098373413086, "time_total_s": 74.74317669868469, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bcc40>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 74.74317669868469, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 48.050000000000004, "ram_util_percent": 38.2, "gpu_util_percent0": 0.185, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.13, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.13999999999999999, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.225, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": "checkpoint_000009"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 39913.0, "episode_reward_min": -7024.0, "episode_reward_mean": 184.52, "episode_len_mean": 41.48, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5024.0, 15401.0, -3524.0, 14401.0, -5524.0, -3524.0, 15901.0, -2524.0, -4024.0, 13901.0, -3524.0, -5524.0, -4524.0, 19901.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 15901.0, -4024.0, 36450.0, -7024.0, -4024.0, 1052.0, 39913.0, -4524.0, 14901.0, -3524.0, -5024.0, -2524.0, -3524.0, 8038.0, -3524.0, -4024.0, -3024.0, -3024.0, -4524.0, -6024.0, -3024.0, -5024.0, -4024.0, -4524.0, -3024.0, -5024.0, -5524.0, -6524.0, 12901.0, -3024.0, -4024.0, 17401.0, -4024.0, 2054.0, -4524.0, -5524.0, -3524.0, -4524.0, 22901.0, -3024.0, -2524.0, -4024.0, -4024.0, -6024.0, -2524.0, -3524.0, -4024.0, -3524.0, 16401.0, -5024.0, -3024.0, -3524.0, 11401.0, 18901.0, -7024.0, -3024.0, -3524.0, -4524.0, -4524.0, -3024.0, -5524.0, -3024.0, -3524.0, -5024.0, -4024.0, 15401.0, -6024.0, -4024.0, 15901.0, -5024.0, -4524.0, -5024.0, -4024.0, -5024.0, -4024.0, 9401.0, -4524.0, -3524.0, -4524.0, -6024.0, 9901.0], "episode_lengths": [25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 151, 25, 25, 49, 188, 25, 100, 25, 25, 25, 25, 63, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 47, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.100330808968186, "mean_inference_ms": 5.003368945590607, "mean_action_processing_ms": 1.327559159689226, "mean_env_wait_ms": 0.6274023089414098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008416175842285156, "StateBufferConnector_ms": 0.007242679595947266, "ViewRequirementAgentConnector_ms": 0.47574710845947266}}, "episode_reward_max": 39913.0, "episode_reward_min": -7024.0, "episode_reward_mean": 184.52, "episode_len_mean": 41.48, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5024.0, 15401.0, -3524.0, 14401.0, -5524.0, -3524.0, 15901.0, -2524.0, -4024.0, 13901.0, -3524.0, -5524.0, -4524.0, 19901.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 15901.0, -4024.0, 36450.0, -7024.0, -4024.0, 1052.0, 39913.0, -4524.0, 14901.0, -3524.0, -5024.0, -2524.0, -3524.0, 8038.0, -3524.0, -4024.0, -3024.0, -3024.0, -4524.0, -6024.0, -3024.0, -5024.0, -4024.0, -4524.0, -3024.0, -5024.0, -5524.0, -6524.0, 12901.0, -3024.0, -4024.0, 17401.0, -4024.0, 2054.0, -4524.0, -5524.0, -3524.0, -4524.0, 22901.0, -3024.0, -2524.0, -4024.0, -4024.0, -6024.0, -2524.0, -3524.0, -4024.0, -3524.0, 16401.0, -5024.0, -3024.0, -3524.0, 11401.0, 18901.0, -7024.0, -3024.0, -3524.0, -4524.0, -4524.0, -3024.0, -5524.0, -3024.0, -3524.0, -5024.0, -4024.0, 15401.0, -6024.0, -4024.0, 15901.0, -5024.0, -4524.0, -5024.0, -4024.0, -5024.0, -4024.0, 9401.0, -4524.0, -3524.0, -4524.0, -6024.0, 9901.0], "episode_lengths": [25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 151, 25, 25, 49, 188, 25, 100, 25, 25, 25, 25, 63, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 47, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.100330808968186, "mean_inference_ms": 5.003368945590607, "mean_action_processing_ms": 1.327559159689226, "mean_env_wait_ms": 0.6274023089414098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008416175842285156, "StateBufferConnector_ms": 0.007242679595947266, "ViewRequirementAgentConnector_ms": 0.47574710845947266}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2449.913158216763, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 188000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 1617.967, "sample_time_ms": 549.431, "synch_weights_time_ms": 39.969}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1940, "training_iteration": 47, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-35", "timestamp": 1715558555, "time_this_iter_s": 1.6443867683410645, "time_total_s": 76.38756346702576, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bcaf0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 76.38756346702576, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 47.0, "ram_util_percent": 38.2, "gpu_util_percent0": 0.16, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.16, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.105, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.18, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 427720.0, "episode_reward_min": -7024.0, "episode_reward_mean": 13417.77, "episode_len_mean": 96.23, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12901.0, -3024.0, -4024.0, 17401.0, -4024.0, 2054.0, -4524.0, -5524.0, -3524.0, -4524.0, 22901.0, -3024.0, -2524.0, -4024.0, -4024.0, -6024.0, -2524.0, -3524.0, -4024.0, -3524.0, 16401.0, -5024.0, -3024.0, -3524.0, 11401.0, 18901.0, -7024.0, -3024.0, -3524.0, -4524.0, -4524.0, -3024.0, -5524.0, -3024.0, -3524.0, -5024.0, -4024.0, 15401.0, -6024.0, -4024.0, 15901.0, -5024.0, -4524.0, -5024.0, -4024.0, -5024.0, -4024.0, 9401.0, -4524.0, -3524.0, -4524.0, -6024.0, 9901.0, -4024.0, 13901.0, 13901.0, -3524.0, -3024.0, -4024.0, -2524.0, -3524.0, 15401.0, -3024.0, -3524.0, 10401.0, -4024.0, -3524.0, 15901.0, -3524.0, 427720.0, 357070.0, 245490.0, -35.0, 14401.0, -4524.0, 14401.0, -4524.0, -5524.0, -3524.0, -3524.0, -2524.0, 15401.0, -3524.0, -3024.0, 16901.0, -4524.0, -4024.0, 11401.0, -5524.0, 4901.0, -4024.0, -5024.0, -5024.0, -5024.0, -5024.0, 17401.0, 288893.0, -1033.0, -4524.0, -4524.0], "episode_lengths": [100, 25, 25, 100, 25, 47, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 1881, 1431, 1011, 36, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 1208, 34, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0971201889856035, "mean_inference_ms": 5.008987907109682, "mean_action_processing_ms": 1.3274605507129886, "mean_env_wait_ms": 0.6277621338938073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008562088012695312, "StateBufferConnector_ms": 0.008363962173461914, "ViewRequirementAgentConnector_ms": 0.5009071826934814}}, "episode_reward_max": 427720.0, "episode_reward_min": -7024.0, "episode_reward_mean": 13417.77, "episode_len_mean": 96.23, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12901.0, -3024.0, -4024.0, 17401.0, -4024.0, 2054.0, -4524.0, -5524.0, -3524.0, -4524.0, 22901.0, -3024.0, -2524.0, -4024.0, -4024.0, -6024.0, -2524.0, -3524.0, -4024.0, -3524.0, 16401.0, -5024.0, -3024.0, -3524.0, 11401.0, 18901.0, -7024.0, -3024.0, -3524.0, -4524.0, -4524.0, -3024.0, -5524.0, -3024.0, -3524.0, -5024.0, -4024.0, 15401.0, -6024.0, -4024.0, 15901.0, -5024.0, -4524.0, -5024.0, -4024.0, -5024.0, -4024.0, 9401.0, -4524.0, -3524.0, -4524.0, -6024.0, 9901.0, -4024.0, 13901.0, 13901.0, -3524.0, -3024.0, -4024.0, -2524.0, -3524.0, 15401.0, -3024.0, -3524.0, 10401.0, -4024.0, -3524.0, 15901.0, -3524.0, 427720.0, 357070.0, 245490.0, -35.0, 14401.0, -4524.0, 14401.0, -4524.0, -5524.0, -3524.0, -3524.0, -2524.0, 15401.0, -3524.0, -3024.0, 16901.0, -4524.0, -4024.0, 11401.0, -5524.0, 4901.0, -4024.0, -5024.0, -5024.0, -5024.0, -5024.0, 17401.0, 288893.0, -1033.0, -4524.0, -4524.0], "episode_lengths": [100, 25, 25, 100, 25, 47, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 1881, 1431, 1011, 36, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 1208, 34, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0971201889856035, "mean_inference_ms": 5.008987907109682, "mean_action_processing_ms": 1.3274605507129886, "mean_env_wait_ms": 0.6277621338938073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008562088012695312, "StateBufferConnector_ms": 0.008363962173461914, "ViewRequirementAgentConnector_ms": 0.5009071826934814}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2446.650878920705, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 192000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 1619.581, "sample_time_ms": 550.198, "synch_weights_time_ms": 39.371}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1987, "training_iteration": 48, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-37", "timestamp": 1715558557, "time_this_iter_s": 1.6444313526153564, "time_total_s": 78.03199481964111, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bd090>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 78.03199481964111, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 41.06666666666666, "ram_util_percent": 38.2, "gpu_util_percent0": 0.17, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.18666666666666668, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.12, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.15666666666666668, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.359375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 427720.0, "episode_reward_min": -8024.0, "episode_reward_mean": 17117.04, "episode_len_mean": 111.96, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15401.0, -6024.0, -4024.0, 15901.0, -5024.0, -4524.0, -5024.0, -4024.0, -5024.0, -4024.0, 9401.0, -4524.0, -3524.0, -4524.0, -6024.0, 9901.0, -4024.0, 13901.0, 13901.0, -3524.0, -3024.0, -4024.0, -2524.0, -3524.0, 15401.0, -3024.0, -3524.0, 10401.0, -4024.0, -3524.0, 15901.0, -3524.0, 427720.0, 357070.0, 245490.0, -35.0, 14401.0, -4524.0, 14401.0, -4524.0, -5524.0, -3524.0, -3524.0, -2524.0, 15401.0, -3524.0, -3024.0, 16901.0, -4524.0, -4024.0, 11401.0, -5524.0, 4901.0, -4024.0, -5024.0, -5024.0, -5024.0, -5024.0, 17401.0, 288893.0, -1033.0, -4524.0, -4524.0, 232636.0, 229536.0, -539.0, -4024.0, -4524.0, -3024.0, -4524.0, -5024.0, 15401.0, -4024.0, -5024.0, -4024.0, -4024.0, -5524.0, -4524.0, -4024.0, -5024.0, -5024.0, -4524.0, -5024.0, -2524.0, -5024.0, -3524.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -7024.0, -4024.0, 17901.0, -4024.0, -3524.0, -6024.0, -4024.0, -4524.0, -4024.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 1881, 1431, 1011, 36, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 1208, 34, 25, 25, 965, 965, 40, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.09326801085325, "mean_inference_ms": 5.005373036968009, "mean_action_processing_ms": 1.3263615981714583, "mean_env_wait_ms": 0.6279930373523007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00868844985961914, "StateBufferConnector_ms": 0.008872747421264648, "ViewRequirementAgentConnector_ms": 0.49820709228515625}}, "episode_reward_max": 427720.0, "episode_reward_min": -8024.0, "episode_reward_mean": 17117.04, "episode_len_mean": 111.96, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15401.0, -6024.0, -4024.0, 15901.0, -5024.0, -4524.0, -5024.0, -4024.0, -5024.0, -4024.0, 9401.0, -4524.0, -3524.0, -4524.0, -6024.0, 9901.0, -4024.0, 13901.0, 13901.0, -3524.0, -3024.0, -4024.0, -2524.0, -3524.0, 15401.0, -3024.0, -3524.0, 10401.0, -4024.0, -3524.0, 15901.0, -3524.0, 427720.0, 357070.0, 245490.0, -35.0, 14401.0, -4524.0, 14401.0, -4524.0, -5524.0, -3524.0, -3524.0, -2524.0, 15401.0, -3524.0, -3024.0, 16901.0, -4524.0, -4024.0, 11401.0, -5524.0, 4901.0, -4024.0, -5024.0, -5024.0, -5024.0, -5024.0, 17401.0, 288893.0, -1033.0, -4524.0, -4524.0, 232636.0, 229536.0, -539.0, -4024.0, -4524.0, -3024.0, -4524.0, -5024.0, 15401.0, -4024.0, -5024.0, -4024.0, -4024.0, -5524.0, -4524.0, -4024.0, -5024.0, -5024.0, -4524.0, -5024.0, -2524.0, -5024.0, -3524.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -7024.0, -4024.0, 17901.0, -4024.0, -3524.0, -6024.0, -4024.0, -4524.0, -4024.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 1881, 1431, 1011, 36, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 1208, 34, 25, 25, 965, 965, 40, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.09326801085325, "mean_inference_ms": 5.005373036968009, "mean_action_processing_ms": 1.3263615981714583, "mean_env_wait_ms": 0.6279930373523007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00868844985961914, "StateBufferConnector_ms": 0.008872747421264648, "ViewRequirementAgentConnector_ms": 0.49820709228515625}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2515.4654075857616, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 196000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 1624.805, "sample_time_ms": 549.028, "synch_weights_time_ms": 40.166}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2024, "training_iteration": 49, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-39", "timestamp": 1715558559, "time_this_iter_s": 1.598428726196289, "time_total_s": 79.6304235458374, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bef20>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 79.6304235458374, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 46.6, "ram_util_percent": 38.2, "gpu_util_percent0": 0.22499999999999998, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.06, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.16, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.21000000000000002, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 288893.0, "episode_reward_min": -9524.0, "episode_reward_mean": 15132.48, "episode_len_mean": 104.52, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5024.0, -5024.0, -5024.0, -5024.0, 17401.0, 288893.0, -1033.0, -4524.0, -4524.0, 232636.0, 229536.0, -539.0, -4024.0, -4524.0, -3024.0, -4524.0, -5024.0, 15401.0, -4024.0, -5024.0, -4024.0, -4024.0, -5524.0, -4524.0, -4024.0, -5024.0, -5024.0, -4524.0, -5024.0, -2524.0, -5024.0, -3524.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -7024.0, -4024.0, 17901.0, -4024.0, -3524.0, -6024.0, -4024.0, -4524.0, -4024.0, -3024.0, 14401.0, -5024.0, 11901.0, -4024.0, -4524.0, -4024.0, 11901.0, -4524.0, 13901.0, -5024.0, -3024.0, -3524.0, 13901.0, -4024.0, -4024.0, 16901.0, -3024.0, 11901.0, -4024.0, 13901.0, -9524.0, 9401.0, -3024.0, -6024.0, 12401.0, -4024.0, -4524.0, 12491.0, -4524.0, -2024.0, -5024.0, 15901.0, 48860.0, 52760.0, 51260.0, 460.0, -3024.0, -5024.0, 54826.0, 54226.0, -3028.0, 17401.0, 164323.0, 180723.0, 179223.0, -3027.0, 12901.0, -3524.0, -1524.0, -4524.0, 13401.0, 14901.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 100, 1208, 34, 25, 25, 965, 965, 40, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 110, 25, 25, 25, 100, 241, 241, 241, 41, 25, 25, 275, 275, 29, 100, 778, 778, 778, 28, 100, 25, 25, 25, 100, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.094275194671445, "mean_inference_ms": 4.997945856368794, "mean_action_processing_ms": 1.3245549274121948, "mean_env_wait_ms": 0.6269738927288367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008610248565673828, "StateBufferConnector_ms": 0.009581327438354492, "ViewRequirementAgentConnector_ms": 0.4713568687438965}}, "episode_reward_max": 288893.0, "episode_reward_min": -9524.0, "episode_reward_mean": 15132.48, "episode_len_mean": 104.52, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5024.0, -5024.0, -5024.0, -5024.0, 17401.0, 288893.0, -1033.0, -4524.0, -4524.0, 232636.0, 229536.0, -539.0, -4024.0, -4524.0, -3024.0, -4524.0, -5024.0, 15401.0, -4024.0, -5024.0, -4024.0, -4024.0, -5524.0, -4524.0, -4024.0, -5024.0, -5024.0, -4524.0, -5024.0, -2524.0, -5024.0, -3524.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -7024.0, -4024.0, 17901.0, -4024.0, -3524.0, -6024.0, -4024.0, -4524.0, -4024.0, -3024.0, 14401.0, -5024.0, 11901.0, -4024.0, -4524.0, -4024.0, 11901.0, -4524.0, 13901.0, -5024.0, -3024.0, -3524.0, 13901.0, -4024.0, -4024.0, 16901.0, -3024.0, 11901.0, -4024.0, 13901.0, -9524.0, 9401.0, -3024.0, -6024.0, 12401.0, -4024.0, -4524.0, 12491.0, -4524.0, -2024.0, -5024.0, 15901.0, 48860.0, 52760.0, 51260.0, 460.0, -3024.0, -5024.0, 54826.0, 54226.0, -3028.0, 17401.0, 164323.0, 180723.0, 179223.0, -3027.0, 12901.0, -3524.0, -1524.0, -4524.0, 13401.0, 14901.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 100, 1208, 34, 25, 25, 965, 965, 40, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 110, 25, 25, 25, 100, 241, 241, 241, 41, 25, 25, 275, 275, 29, 100, 778, 778, 778, 28, 100, 25, 25, 25, 100, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.094275194671445, "mean_inference_ms": 4.997945856368794, "mean_action_processing_ms": 1.3245549274121948, "mean_env_wait_ms": 0.6269738927288367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008610248565673828, "StateBufferConnector_ms": 0.009581327438354492, "ViewRequirementAgentConnector_ms": 0.4713568687438965}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2498.9228867974357, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 200000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 1624.752, "sample_time_ms": 550.092, "synch_weights_time_ms": 40.482}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2078, "training_iteration": 50, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-40", "timestamp": 1715558560, "time_this_iter_s": 1.614067554473877, "time_total_s": 81.24449110031128, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be7a0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 81.24449110031128, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 48.7, "ram_util_percent": 38.2, "gpu_util_percent0": 0.17, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.175, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.115, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.21, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 180723.0, "episode_reward_min": -9524.0, "episode_reward_mean": 8947.72, "episode_len_mean": 79.28, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, -3524.0, -7024.0, -4024.0, 17901.0, -4024.0, -3524.0, -6024.0, -4024.0, -4524.0, -4024.0, -3024.0, 14401.0, -5024.0, 11901.0, -4024.0, -4524.0, -4024.0, 11901.0, -4524.0, 13901.0, -5024.0, -3024.0, -3524.0, 13901.0, -4024.0, -4024.0, 16901.0, -3024.0, 11901.0, -4024.0, 13901.0, -9524.0, 9401.0, -3024.0, -6024.0, 12401.0, -4024.0, -4524.0, 12491.0, -4524.0, -2024.0, -5024.0, 15901.0, 48860.0, 52760.0, 51260.0, 460.0, -3024.0, -5024.0, 54826.0, 54226.0, -3028.0, 17401.0, 164323.0, 180723.0, 179223.0, -3027.0, 12901.0, -3524.0, -1524.0, -4524.0, 13401.0, 14901.0, -4024.0, -3024.0, -6524.0, -4524.0, -4024.0, -4024.0, -4024.0, -4524.0, -3024.0, -4024.0, -8024.0, -3524.0, -3524.0, -4024.0, -5024.0, -3024.0, -3024.0, -5024.0, -5024.0, -3524.0, 16401.0, -3524.0, 16901.0, -8524.0, 3052.0, -5024.0, -4024.0, -3024.0, -4024.0, 13401.0, -4024.0, -3024.0, -4524.0, 114621.0, -3533.0], "episode_lengths": [25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 110, 25, 25, 25, 100, 241, 241, 241, 41, 25, 25, 275, 275, 29, 100, 778, 778, 778, 28, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 49, 25, 25, 25, 25, 100, 25, 25, 25, 480, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1003701748834045, "mean_inference_ms": 5.005154051150181, "mean_action_processing_ms": 1.3267864543746695, "mean_env_wait_ms": 0.6273240319704421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008553266525268555, "StateBufferConnector_ms": 0.008976221084594727, "ViewRequirementAgentConnector_ms": 0.4722449779510498}}, "episode_reward_max": 180723.0, "episode_reward_min": -9524.0, "episode_reward_mean": 8947.72, "episode_len_mean": 79.28, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, -3524.0, -7024.0, -4024.0, 17901.0, -4024.0, -3524.0, -6024.0, -4024.0, -4524.0, -4024.0, -3024.0, 14401.0, -5024.0, 11901.0, -4024.0, -4524.0, -4024.0, 11901.0, -4524.0, 13901.0, -5024.0, -3024.0, -3524.0, 13901.0, -4024.0, -4024.0, 16901.0, -3024.0, 11901.0, -4024.0, 13901.0, -9524.0, 9401.0, -3024.0, -6024.0, 12401.0, -4024.0, -4524.0, 12491.0, -4524.0, -2024.0, -5024.0, 15901.0, 48860.0, 52760.0, 51260.0, 460.0, -3024.0, -5024.0, 54826.0, 54226.0, -3028.0, 17401.0, 164323.0, 180723.0, 179223.0, -3027.0, 12901.0, -3524.0, -1524.0, -4524.0, 13401.0, 14901.0, -4024.0, -3024.0, -6524.0, -4524.0, -4024.0, -4024.0, -4024.0, -4524.0, -3024.0, -4024.0, -8024.0, -3524.0, -3524.0, -4024.0, -5024.0, -3024.0, -3024.0, -5024.0, -5024.0, -3524.0, 16401.0, -3524.0, 16901.0, -8524.0, 3052.0, -5024.0, -4024.0, -3024.0, -4024.0, 13401.0, -4024.0, -3024.0, -4524.0, 114621.0, -3533.0], "episode_lengths": [25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 100, 25, 25, 100, 25, 25, 110, 25, 25, 25, 100, 241, 241, 241, 41, 25, 25, 275, 275, 29, 100, 778, 778, 778, 28, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 49, 25, 25, 25, 25, 100, 25, 25, 25, 480, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1003701748834045, "mean_inference_ms": 5.005154051150181, "mean_action_processing_ms": 1.3267864543746695, "mean_env_wait_ms": 0.6273240319704421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008553266525268555, "StateBufferConnector_ms": 0.008976221084594727, "ViewRequirementAgentConnector_ms": 0.4722449779510498}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2494.406502590346, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 204000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 1627.388, "sample_time_ms": 545.573, "synch_weights_time_ms": 40.904}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2112, "training_iteration": 51, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-42", "timestamp": 1715558562, "time_this_iter_s": 1.6117656230926514, "time_total_s": 82.85625672340393, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bff40>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 82.85625672340393, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 47.95, "ram_util_percent": 38.2, "gpu_util_percent0": 0.19, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.19, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.12, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.23500000000000001, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": "checkpoint_000010"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 417810.0, "episode_reward_min": -8524.0, "episode_reward_mean": 20757.54, "episode_len_mean": 126.46, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12491.0, -4524.0, -2024.0, -5024.0, 15901.0, 48860.0, 52760.0, 51260.0, 460.0, -3024.0, -5024.0, 54826.0, 54226.0, -3028.0, 17401.0, 164323.0, 180723.0, 179223.0, -3027.0, 12901.0, -3524.0, -1524.0, -4524.0, 13401.0, 14901.0, -4024.0, -3024.0, -6524.0, -4524.0, -4024.0, -4024.0, -4024.0, -4524.0, -3024.0, -4024.0, -8024.0, -3524.0, -3524.0, -4024.0, -5024.0, -3024.0, -3024.0, -5024.0, -5024.0, -3524.0, 16401.0, -3524.0, 16901.0, -8524.0, 3052.0, -5024.0, -4024.0, -3024.0, -4024.0, 13401.0, -4024.0, -3024.0, -4524.0, 114621.0, -3533.0, -4024.0, -4524.0, -5024.0, -4024.0, -3524.0, -3524.0, -4024.0, 16401.0, 13401.0, 417810.0, 410831.0, 274877.0, 3452.0, 148959.0, -41.0, -5524.0, -4024.0, -1524.0, -5024.0, -5524.0, -5024.0, -4524.0, -3524.0, -4024.0, 1401.0, -4524.0, -3524.0, -4024.0, -4524.0, -3024.0, -3024.0, -4524.0, -3024.0, -8524.0, 18401.0, -4024.0, -4524.0, -4024.0, -3524.0, 18401.0], "episode_lengths": [110, 25, 25, 25, 100, 241, 241, 241, 41, 25, 25, 275, 275, 29, 100, 778, 778, 778, 28, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 49, 25, 25, 25, 25, 100, 25, 25, 25, 480, 34, 25, 25, 25, 25, 25, 25, 25, 100, 100, 1791, 1670, 1124, 49, 642, 42, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.098811932381562, "mean_inference_ms": 5.0021091759084335, "mean_action_processing_ms": 1.3257540468624465, "mean_env_wait_ms": 0.6267214758271418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008174419403076172, "StateBufferConnector_ms": 0.010180473327636719, "ViewRequirementAgentConnector_ms": 0.49256014823913574}}, "episode_reward_max": 417810.0, "episode_reward_min": -8524.0, "episode_reward_mean": 20757.54, "episode_len_mean": 126.46, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12491.0, -4524.0, -2024.0, -5024.0, 15901.0, 48860.0, 52760.0, 51260.0, 460.0, -3024.0, -5024.0, 54826.0, 54226.0, -3028.0, 17401.0, 164323.0, 180723.0, 179223.0, -3027.0, 12901.0, -3524.0, -1524.0, -4524.0, 13401.0, 14901.0, -4024.0, -3024.0, -6524.0, -4524.0, -4024.0, -4024.0, -4024.0, -4524.0, -3024.0, -4024.0, -8024.0, -3524.0, -3524.0, -4024.0, -5024.0, -3024.0, -3024.0, -5024.0, -5024.0, -3524.0, 16401.0, -3524.0, 16901.0, -8524.0, 3052.0, -5024.0, -4024.0, -3024.0, -4024.0, 13401.0, -4024.0, -3024.0, -4524.0, 114621.0, -3533.0, -4024.0, -4524.0, -5024.0, -4024.0, -3524.0, -3524.0, -4024.0, 16401.0, 13401.0, 417810.0, 410831.0, 274877.0, 3452.0, 148959.0, -41.0, -5524.0, -4024.0, -1524.0, -5024.0, -5524.0, -5024.0, -4524.0, -3524.0, -4024.0, 1401.0, -4524.0, -3524.0, -4024.0, -4524.0, -3024.0, -3024.0, -4524.0, -3024.0, -8524.0, 18401.0, -4024.0, -4524.0, -4024.0, -3524.0, 18401.0], "episode_lengths": [110, 25, 25, 25, 100, 241, 241, 241, 41, 25, 25, 275, 275, 29, 100, 778, 778, 778, 28, 100, 25, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 49, 25, 25, 25, 25, 100, 25, 25, 25, 480, 34, 25, 25, 25, 25, 25, 25, 25, 100, 100, 1791, 1670, 1124, 49, 642, 42, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.098811932381562, "mean_inference_ms": 5.0021091759084335, "mean_action_processing_ms": 1.3257540468624465, "mean_env_wait_ms": 0.6267214758271418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008174419403076172, "StateBufferConnector_ms": 0.010180473327636719, "ViewRequirementAgentConnector_ms": 0.49256014823913574}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2483.8369835115736, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 208000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 1629.614, "sample_time_ms": 547.044, "synch_weights_time_ms": 40.737}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2152, "training_iteration": 52, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-44", "timestamp": 1715558564, "time_this_iter_s": 1.6197419166564941, "time_total_s": 84.47599864006042, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bc460>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 84.47599864006042, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 46.45, "ram_util_percent": 38.2, "gpu_util_percent0": 0.24, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.13, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.09000000000000001, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.33, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 417810.0, "episode_reward_min": -8524.0, "episode_reward_mean": 26450.36, "episode_len_mean": 148.64, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, -4024.0, 13401.0, -4024.0, -3024.0, -4524.0, 114621.0, -3533.0, -4024.0, -4524.0, -5024.0, -4024.0, -3524.0, -3524.0, -4024.0, 16401.0, 13401.0, 417810.0, 410831.0, 274877.0, 3452.0, 148959.0, -41.0, -5524.0, -4024.0, -1524.0, -5024.0, -5524.0, -5024.0, -4524.0, -3524.0, -4024.0, 1401.0, -4524.0, -3524.0, -4024.0, -4524.0, -3024.0, -3024.0, -4524.0, -3024.0, -8524.0, 18401.0, -4024.0, -4524.0, -4024.0, -3524.0, 18401.0, -4524.0, 14401.0, -4524.0, 16901.0, 311720.0, 339620.0, 298269.0, -536.0, -4024.0, -3524.0, -4024.0, -3024.0, -3024.0, 10901.0, -4524.0, 12901.0, -5024.0, 16401.0, 113128.0, 2953.0, -4524.0, 15901.0, 42366.0, 47766.0, 47766.0, -1034.0, 9401.0, -3524.0, -5024.0, -4524.0, -3524.0, -4024.0, 17901.0, -4024.0, 12901.0, 23968.0, 23868.0, 468.0, -3524.0, 9901.0, -3524.0, 12901.0, -4024.0, 22468.0, -1032.0, -5024.0, -4524.0, -4524.0, 18401.0, -4524.0, -4024.0, -4024.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 480, 34, 25, 25, 25, 25, 25, 25, 25, 100, 100, 1791, 1670, 1124, 49, 642, 42, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 100, 1381, 1381, 1232, 37, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 473, 48, 25, 100, 235, 235, 235, 35, 100, 25, 25, 25, 25, 25, 100, 25, 100, 133, 133, 33, 25, 100, 25, 100, 25, 133, 33, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.090700455089691, "mean_inference_ms": 4.9976747511517745, "mean_action_processing_ms": 1.3231443442398487, "mean_env_wait_ms": 0.6268194557544535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008386373519897461, "StateBufferConnector_ms": 0.011263847351074219, "ViewRequirementAgentConnector_ms": 0.4924025535583496}}, "episode_reward_max": 417810.0, "episode_reward_min": -8524.0, "episode_reward_mean": 26450.36, "episode_len_mean": 148.64, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, -4024.0, 13401.0, -4024.0, -3024.0, -4524.0, 114621.0, -3533.0, -4024.0, -4524.0, -5024.0, -4024.0, -3524.0, -3524.0, -4024.0, 16401.0, 13401.0, 417810.0, 410831.0, 274877.0, 3452.0, 148959.0, -41.0, -5524.0, -4024.0, -1524.0, -5024.0, -5524.0, -5024.0, -4524.0, -3524.0, -4024.0, 1401.0, -4524.0, -3524.0, -4024.0, -4524.0, -3024.0, -3024.0, -4524.0, -3024.0, -8524.0, 18401.0, -4024.0, -4524.0, -4024.0, -3524.0, 18401.0, -4524.0, 14401.0, -4524.0, 16901.0, 311720.0, 339620.0, 298269.0, -536.0, -4024.0, -3524.0, -4024.0, -3024.0, -3024.0, 10901.0, -4524.0, 12901.0, -5024.0, 16401.0, 113128.0, 2953.0, -4524.0, 15901.0, 42366.0, 47766.0, 47766.0, -1034.0, 9401.0, -3524.0, -5024.0, -4524.0, -3524.0, -4024.0, 17901.0, -4024.0, 12901.0, 23968.0, 23868.0, 468.0, -3524.0, 9901.0, -3524.0, 12901.0, -4024.0, 22468.0, -1032.0, -5024.0, -4524.0, -4524.0, 18401.0, -4524.0, -4024.0, -4024.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 480, 34, 25, 25, 25, 25, 25, 25, 25, 100, 100, 1791, 1670, 1124, 49, 642, 42, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 100, 1381, 1381, 1232, 37, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 473, 48, 25, 100, 235, 235, 235, 35, 100, 25, 25, 25, 25, 25, 100, 25, 100, 133, 133, 33, 25, 100, 25, 100, 25, 133, 33, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.090700455089691, "mean_inference_ms": 4.9976747511517745, "mean_action_processing_ms": 1.3231443442398487, "mean_env_wait_ms": 0.6268194557544535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008386373519897461, "StateBufferConnector_ms": 0.011263847351074219, "ViewRequirementAgentConnector_ms": 0.4924025535583496}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2525.865587500461, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 212000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 1623.795, "sample_time_ms": 546.35, "synch_weights_time_ms": 41.239}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2204, "training_iteration": 53, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-46", "timestamp": 1715558566, "time_this_iter_s": 1.5937397480010986, "time_total_s": 86.06973838806152, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bcb50>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 86.06973838806152, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 42.0, "ram_util_percent": 38.2, "gpu_util_percent0": 0.24, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.12666666666666668, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.25, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.26, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 339620.0, "episode_reward_min": -8524.0, "episode_reward_mean": 15017.54, "episode_len_mean": 101.46, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -4024.0, -4524.0, -3024.0, -3024.0, -4524.0, -3024.0, -8524.0, 18401.0, -4024.0, -4524.0, -4024.0, -3524.0, 18401.0, -4524.0, 14401.0, -4524.0, 16901.0, 311720.0, 339620.0, 298269.0, -536.0, -4024.0, -3524.0, -4024.0, -3024.0, -3024.0, 10901.0, -4524.0, 12901.0, -5024.0, 16401.0, 113128.0, 2953.0, -4524.0, 15901.0, 42366.0, 47766.0, 47766.0, -1034.0, 9401.0, -3524.0, -5024.0, -4524.0, -3524.0, -4024.0, 17901.0, -4024.0, 12901.0, 23968.0, 23868.0, 468.0, -3524.0, 9901.0, -3524.0, 12901.0, -4024.0, 22468.0, -1032.0, -5024.0, -4524.0, -4524.0, 18401.0, -4524.0, -4024.0, -4024.0, -3524.0, -5024.0, -3524.0, -4524.0, -3524.0, 41412.0, 109155.0, 107055.0, 1955.0, -6524.0, -4024.0, -4524.0, -4024.0, -3524.0, -3524.0, -5524.0, -6524.0, -4524.0, -5524.0, -3524.0, 26964.0, -5024.0, -5024.0, -2524.0, -5024.0, -4524.0, -3524.0, -7024.0, 14901.0, -4524.0, -3524.0, -4024.0, -4024.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 100, 1381, 1381, 1232, 37, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 473, 48, 25, 100, 235, 235, 235, 35, 100, 25, 25, 25, 25, 25, 100, 25, 100, 133, 133, 33, 25, 100, 25, 100, 25, 133, 33, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 189, 446, 446, 46, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 137, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.090318336873183, "mean_inference_ms": 4.9982683310218725, "mean_action_processing_ms": 1.3232113825291179, "mean_env_wait_ms": 0.6260146734438928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008795738220214844, "StateBufferConnector_ms": 0.010235309600830078, "ViewRequirementAgentConnector_ms": 0.49352550506591797}}, "episode_reward_max": 339620.0, "episode_reward_min": -8524.0, "episode_reward_mean": 15017.54, "episode_len_mean": 101.46, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -4024.0, -4524.0, -3024.0, -3024.0, -4524.0, -3024.0, -8524.0, 18401.0, -4024.0, -4524.0, -4024.0, -3524.0, 18401.0, -4524.0, 14401.0, -4524.0, 16901.0, 311720.0, 339620.0, 298269.0, -536.0, -4024.0, -3524.0, -4024.0, -3024.0, -3024.0, 10901.0, -4524.0, 12901.0, -5024.0, 16401.0, 113128.0, 2953.0, -4524.0, 15901.0, 42366.0, 47766.0, 47766.0, -1034.0, 9401.0, -3524.0, -5024.0, -4524.0, -3524.0, -4024.0, 17901.0, -4024.0, 12901.0, 23968.0, 23868.0, 468.0, -3524.0, 9901.0, -3524.0, 12901.0, -4024.0, 22468.0, -1032.0, -5024.0, -4524.0, -4524.0, 18401.0, -4524.0, -4024.0, -4024.0, -3524.0, -5024.0, -3524.0, -4524.0, -3524.0, 41412.0, 109155.0, 107055.0, 1955.0, -6524.0, -4024.0, -4524.0, -4024.0, -3524.0, -3524.0, -5524.0, -6524.0, -4524.0, -5524.0, -3524.0, 26964.0, -5024.0, -5024.0, -2524.0, -5024.0, -4524.0, -3524.0, -7024.0, 14901.0, -4524.0, -3524.0, -4024.0, -4024.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 100, 1381, 1381, 1232, 37, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 473, 48, 25, 100, 235, 235, 235, 35, 100, 25, 25, 25, 25, 25, 100, 25, 100, 133, 133, 33, 25, 100, 25, 100, 25, 133, 33, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 189, 446, 446, 46, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 137, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.090318336873183, "mean_inference_ms": 4.9982683310218725, "mean_action_processing_ms": 1.3232113825291179, "mean_env_wait_ms": 0.6260146734438928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008795738220214844, "StateBufferConnector_ms": 0.010235309600830078, "ViewRequirementAgentConnector_ms": 0.49352550506591797}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2588.9143365400255, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 216000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 1614.716, "sample_time_ms": 543.862, "synch_weights_time_ms": 40.53}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2238, "training_iteration": 54, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-47", "timestamp": 1715558567, "time_this_iter_s": 1.560143232345581, "time_total_s": 87.6298816204071, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be6b0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 87.6298816204071, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 47.95, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.09, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.195, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.13, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.245, "vram_util_percent3": 0.11656605113636363}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.30208333333333, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 109155.0, "episode_reward_min": -7024.0, "episode_reward_mean": 4861.17, "episode_len_mean": 60.83, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9901.0, -3524.0, 12901.0, -4024.0, 22468.0, -1032.0, -5024.0, -4524.0, -4524.0, 18401.0, -4524.0, -4024.0, -4024.0, -3524.0, -5024.0, -3524.0, -4524.0, -3524.0, 41412.0, 109155.0, 107055.0, 1955.0, -6524.0, -4024.0, -4524.0, -4024.0, -3524.0, -3524.0, -5524.0, -6524.0, -4524.0, -5524.0, -3524.0, 26964.0, -5024.0, -5024.0, -2524.0, -5024.0, -4524.0, -3524.0, -7024.0, 14901.0, -4524.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, 23401.0, -4524.0, -3024.0, 13901.0, -5024.0, -4024.0, -3524.0, 17901.0, -3524.0, 13901.0, -5024.0, -5024.0, -5524.0, -5524.0, 12901.0, -4524.0, -4024.0, 6901.0, -6524.0, 13901.0, -3524.0, -4024.0, 12901.0, -3024.0, 16901.0, -4024.0, -6024.0, 14901.0, -4524.0, -3024.0, -4024.0, -4524.0, -4524.0, 13401.0, -3524.0, -4024.0, -4524.0, -4024.0, 105599.0, 48274.0, 49274.0, -3027.0, 16901.0, 1557.0, 12901.0, -4524.0, -3524.0, -4024.0, 15401.0, -3024.0, 12401.0, -4024.0], "episode_lengths": [100, 25, 100, 25, 133, 33, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 189, 446, 446, 46, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 137, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 502, 227, 227, 28, 100, 44, 100, 25, 25, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.093049342981496, "mean_inference_ms": 5.001681326179937, "mean_action_processing_ms": 1.3249171421194004, "mean_env_wait_ms": 0.6270138570711835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0082244873046875, "StateBufferConnector_ms": 0.008017539978027344, "ViewRequirementAgentConnector_ms": 0.47492098808288574}}, "episode_reward_max": 109155.0, "episode_reward_min": -7024.0, "episode_reward_mean": 4861.17, "episode_len_mean": 60.83, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9901.0, -3524.0, 12901.0, -4024.0, 22468.0, -1032.0, -5024.0, -4524.0, -4524.0, 18401.0, -4524.0, -4024.0, -4024.0, -3524.0, -5024.0, -3524.0, -4524.0, -3524.0, 41412.0, 109155.0, 107055.0, 1955.0, -6524.0, -4024.0, -4524.0, -4024.0, -3524.0, -3524.0, -5524.0, -6524.0, -4524.0, -5524.0, -3524.0, 26964.0, -5024.0, -5024.0, -2524.0, -5024.0, -4524.0, -3524.0, -7024.0, 14901.0, -4524.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, 23401.0, -4524.0, -3024.0, 13901.0, -5024.0, -4024.0, -3524.0, 17901.0, -3524.0, 13901.0, -5024.0, -5024.0, -5524.0, -5524.0, 12901.0, -4524.0, -4024.0, 6901.0, -6524.0, 13901.0, -3524.0, -4024.0, 12901.0, -3024.0, 16901.0, -4024.0, -6024.0, 14901.0, -4524.0, -3024.0, -4024.0, -4524.0, -4524.0, 13401.0, -3524.0, -4024.0, -4524.0, -4024.0, 105599.0, 48274.0, 49274.0, -3027.0, 16901.0, 1557.0, 12901.0, -4524.0, -3524.0, -4024.0, 15401.0, -3024.0, 12401.0, -4024.0], "episode_lengths": [100, 25, 100, 25, 133, 33, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 189, 446, 446, 46, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 137, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 502, 227, 227, 28, 100, 44, 100, 25, 25, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.093049342981496, "mean_inference_ms": 5.001681326179937, "mean_action_processing_ms": 1.3249171421194004, "mean_env_wait_ms": 0.6270138570711835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0082244873046875, "StateBufferConnector_ms": 0.008017539978027344, "ViewRequirementAgentConnector_ms": 0.47492098808288574}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2456.184096218752, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 220000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 1616.669, "sample_time_ms": 545.92, "synch_weights_time_ms": 39.656}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2291, "training_iteration": 55, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-49", "timestamp": 1715558569, "time_this_iter_s": 1.6422321796417236, "time_total_s": 89.27211380004883, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72ec50>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 89.27211380004883, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 47.95, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.215, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.13, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.04, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.225, "vram_util_percent3": 0.11647727272727273}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 433184.0, "episode_reward_min": -7524.0, "episode_reward_mean": 11162.6, "episode_len_mean": 87.4, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2524.0, -5024.0, -4524.0, -3524.0, -7024.0, 14901.0, -4524.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, 23401.0, -4524.0, -3024.0, 13901.0, -5024.0, -4024.0, -3524.0, 17901.0, -3524.0, 13901.0, -5024.0, -5024.0, -5524.0, -5524.0, 12901.0, -4524.0, -4024.0, 6901.0, -6524.0, 13901.0, -3524.0, -4024.0, 12901.0, -3024.0, 16901.0, -4024.0, -6024.0, 14901.0, -4524.0, -3024.0, -4024.0, -4524.0, -4524.0, 13401.0, -3524.0, -4024.0, -4524.0, -4024.0, 105599.0, 48274.0, 49274.0, -3027.0, 16901.0, 1557.0, 12901.0, -4524.0, -3524.0, -4024.0, 15401.0, -3024.0, 12401.0, -4024.0, -4024.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, -7524.0, -4524.0, -3024.0, -3524.0, 16401.0, -4024.0, -4024.0, 19508.0, 17908.0, 2958.0, 18401.0, -4024.0, 15901.0, -4024.0, -5024.0, -4524.0, -5024.0, 14901.0, -3524.0, 433184.0, 367982.0, 62690.0, -1035.0, -4524.0], "episode_lengths": [25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 502, 227, 227, 28, 100, 44, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 93, 93, 43, 100, 25, 100, 25, 25, 25, 25, 100, 25, 1917, 1519, 311, 36, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.094741531278262, "mean_inference_ms": 5.001183215301794, "mean_action_processing_ms": 1.324292986295341, "mean_env_wait_ms": 0.6259424415840222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008017301559448242, "StateBufferConnector_ms": 0.008786439895629883, "ViewRequirementAgentConnector_ms": 0.4661276340484619}}, "episode_reward_max": 433184.0, "episode_reward_min": -7524.0, "episode_reward_mean": 11162.6, "episode_len_mean": 87.4, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2524.0, -5024.0, -4524.0, -3524.0, -7024.0, 14901.0, -4524.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, 23401.0, -4524.0, -3024.0, 13901.0, -5024.0, -4024.0, -3524.0, 17901.0, -3524.0, 13901.0, -5024.0, -5024.0, -5524.0, -5524.0, 12901.0, -4524.0, -4024.0, 6901.0, -6524.0, 13901.0, -3524.0, -4024.0, 12901.0, -3024.0, 16901.0, -4024.0, -6024.0, 14901.0, -4524.0, -3024.0, -4024.0, -4524.0, -4524.0, 13401.0, -3524.0, -4024.0, -4524.0, -4024.0, 105599.0, 48274.0, 49274.0, -3027.0, 16901.0, 1557.0, 12901.0, -4524.0, -3524.0, -4024.0, 15401.0, -3024.0, 12401.0, -4024.0, -4024.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, -7524.0, -4524.0, -3024.0, -3524.0, 16401.0, -4024.0, -4024.0, 19508.0, 17908.0, 2958.0, 18401.0, -4024.0, 15901.0, -4024.0, -5024.0, -4524.0, -5024.0, 14901.0, -3524.0, 433184.0, 367982.0, 62690.0, -1035.0, -4524.0], "episode_lengths": [25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 502, 227, 227, 28, 100, 44, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 93, 93, 43, 100, 25, 100, 25, 25, 25, 25, 100, 25, 1917, 1519, 311, 36, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.094741531278262, "mean_inference_ms": 5.001183215301794, "mean_action_processing_ms": 1.324292986295341, "mean_env_wait_ms": 0.6259424415840222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008017301559448242, "StateBufferConnector_ms": 0.008786439895629883, "ViewRequirementAgentConnector_ms": 0.4661276340484619}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2514.3955045099524, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 224000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 1602.003, "sample_time_ms": 538.57, "synch_weights_time_ms": 38.814}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2327, "training_iteration": 56, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-51", "timestamp": 1715558571, "time_this_iter_s": 1.5987708568572998, "time_total_s": 90.87088465690613, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844b850>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 90.87088465690613, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 48.849999999999994, "ram_util_percent": 38.1, "gpu_util_percent0": 0.21, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.08499999999999999, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.16, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.23, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": "checkpoint_000011"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 474659.0, "episode_reward_min": -7524.0, "episode_reward_mean": 18321.8, "episode_len_mean": 115.2, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, -4024.0, -4524.0, -4524.0, 13401.0, -3524.0, -4024.0, -4524.0, -4024.0, 105599.0, 48274.0, 49274.0, -3027.0, 16901.0, 1557.0, 12901.0, -4524.0, -3524.0, -4024.0, 15401.0, -3024.0, 12401.0, -4024.0, -4024.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, -7524.0, -4524.0, -3024.0, -3524.0, 16401.0, -4024.0, -4024.0, 19508.0, 17908.0, 2958.0, 18401.0, -4024.0, 15901.0, -4024.0, -5024.0, -4524.0, -5024.0, 14901.0, -3524.0, 433184.0, 367982.0, 62690.0, -1035.0, -4524.0, -4024.0, -3524.0, -4524.0, 18901.0, -3524.0, -4524.0, -4524.0, 14901.0, 15901.0, -3024.0, -4524.0, -4524.0, 474659.0, 263904.0, 1957.0, -4524.0, -3524.0, -6024.0, -4524.0, -4024.0, -3524.0, -2524.0, 15401.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, -5024.0, -6024.0, 27443.0, 462.0, 16401.0, -4024.0, -3024.0, -3524.0, -3024.0, -2524.0, -4524.0, 18901.0], "episode_lengths": [25, 25, 25, 25, 100, 25, 25, 25, 25, 502, 227, 227, 28, 100, 44, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 93, 93, 43, 100, 25, 100, 25, 25, 25, 25, 100, 25, 1917, 1519, 311, 36, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 1942, 1097, 44, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 158, 39, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.098881389784121, "mean_inference_ms": 5.000468004921131, "mean_action_processing_ms": 1.3242489749243065, "mean_env_wait_ms": 0.6257940028827202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00807332992553711, "StateBufferConnector_ms": 0.009755134582519531, "ViewRequirementAgentConnector_ms": 0.504009485244751}}, "episode_reward_max": 474659.0, "episode_reward_min": -7524.0, "episode_reward_mean": 18321.8, "episode_len_mean": 115.2, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, -4024.0, -4524.0, -4524.0, 13401.0, -3524.0, -4024.0, -4524.0, -4024.0, 105599.0, 48274.0, 49274.0, -3027.0, 16901.0, 1557.0, 12901.0, -4524.0, -3524.0, -4024.0, 15401.0, -3024.0, 12401.0, -4024.0, -4024.0, -4024.0, -3524.0, -4524.0, -3524.0, -5024.0, -4024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, -7524.0, -4524.0, -3024.0, -3524.0, 16401.0, -4024.0, -4024.0, 19508.0, 17908.0, 2958.0, 18401.0, -4024.0, 15901.0, -4024.0, -5024.0, -4524.0, -5024.0, 14901.0, -3524.0, 433184.0, 367982.0, 62690.0, -1035.0, -4524.0, -4024.0, -3524.0, -4524.0, 18901.0, -3524.0, -4524.0, -4524.0, 14901.0, 15901.0, -3024.0, -4524.0, -4524.0, 474659.0, 263904.0, 1957.0, -4524.0, -3524.0, -6024.0, -4524.0, -4024.0, -3524.0, -2524.0, 15401.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, -5024.0, -6024.0, 27443.0, 462.0, 16401.0, -4024.0, -3024.0, -3524.0, -3024.0, -2524.0, -4524.0, 18901.0], "episode_lengths": [25, 25, 25, 25, 100, 25, 25, 25, 25, 502, 227, 227, 28, 100, 44, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 93, 93, 43, 100, 25, 100, 25, 25, 25, 25, 100, 25, 1917, 1519, 311, 36, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 1942, 1097, 44, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 158, 39, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.098881389784121, "mean_inference_ms": 5.000468004921131, "mean_action_processing_ms": 1.3242489749243065, "mean_env_wait_ms": 0.6257940028827202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00807332992553711, "StateBufferConnector_ms": 0.009755134582519531, "ViewRequirementAgentConnector_ms": 0.504009485244751}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2702.214685833133, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 228000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 1586.758, "sample_time_ms": 538.291, "synch_weights_time_ms": 38.446}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2368, "training_iteration": 57, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-52", "timestamp": 1715558572, "time_this_iter_s": 1.4892804622650146, "time_total_s": 92.36016511917114, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec717c70>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 92.36016511917114, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 50.6, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.165, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.17, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.16, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.26, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 474659.0, "episode_reward_min": -8024.0, "episode_reward_mean": 16550.33, "episode_len_mean": 109.67, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, 15901.0, -4024.0, -5024.0, -4524.0, -5024.0, 14901.0, -3524.0, 433184.0, 367982.0, 62690.0, -1035.0, -4524.0, -4024.0, -3524.0, -4524.0, 18901.0, -3524.0, -4524.0, -4524.0, 14901.0, 15901.0, -3024.0, -4524.0, -4524.0, 474659.0, 263904.0, 1957.0, -4524.0, -3524.0, -6024.0, -4524.0, -4024.0, -3524.0, -2524.0, 15401.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, -5024.0, -6024.0, 27443.0, 462.0, 16401.0, -4024.0, -3024.0, -3524.0, -3024.0, -2524.0, -4524.0, 18901.0, -5024.0, 7401.0, -4024.0, -5024.0, 13901.0, -4024.0, -8024.0, -5024.0, -3524.0, -3524.0, -4524.0, -4024.0, -4024.0, 11401.0, -4524.0, -3524.0, 13901.0, -5024.0, -4024.0, 12901.0, -5024.0, 16401.0, -4524.0, -3024.0, -3024.0, -3524.0, -2524.0, 13901.0, -4024.0, -5024.0, -4524.0, 14901.0, -5024.0, 15401.0, 13401.0, 17483.0, 16883.0, 458.0, -4024.0, -3024.0, -4024.0, 16401.0, -3524.0, -6024.0, -4524.0, -7024.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 100, 25, 1917, 1519, 311, 36, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 1942, 1097, 44, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 158, 39, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 100, 118, 118, 43, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.096234622443244, "mean_inference_ms": 4.99936445595295, "mean_action_processing_ms": 1.323883526706729, "mean_env_wait_ms": 0.6259035139734119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008131742477416992, "StateBufferConnector_ms": 0.008925199508666992, "ViewRequirementAgentConnector_ms": 0.5079610347747803}}, "episode_reward_max": 474659.0, "episode_reward_min": -8024.0, "episode_reward_mean": 16550.33, "episode_len_mean": 109.67, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, 15901.0, -4024.0, -5024.0, -4524.0, -5024.0, 14901.0, -3524.0, 433184.0, 367982.0, 62690.0, -1035.0, -4524.0, -4024.0, -3524.0, -4524.0, 18901.0, -3524.0, -4524.0, -4524.0, 14901.0, 15901.0, -3024.0, -4524.0, -4524.0, 474659.0, 263904.0, 1957.0, -4524.0, -3524.0, -6024.0, -4524.0, -4024.0, -3524.0, -2524.0, 15401.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, -5024.0, -6024.0, 27443.0, 462.0, 16401.0, -4024.0, -3024.0, -3524.0, -3024.0, -2524.0, -4524.0, 18901.0, -5024.0, 7401.0, -4024.0, -5024.0, 13901.0, -4024.0, -8024.0, -5024.0, -3524.0, -3524.0, -4524.0, -4024.0, -4024.0, 11401.0, -4524.0, -3524.0, 13901.0, -5024.0, -4024.0, 12901.0, -5024.0, 16401.0, -4524.0, -3024.0, -3024.0, -3524.0, -2524.0, 13901.0, -4024.0, -5024.0, -4524.0, 14901.0, -5024.0, 15401.0, 13401.0, 17483.0, 16883.0, 458.0, -4024.0, -3024.0, -4024.0, 16401.0, -3524.0, -6024.0, -4524.0, -7024.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 100, 25, 1917, 1519, 311, 36, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 25, 1942, 1097, 44, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 158, 39, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 100, 118, 118, 43, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.096234622443244, "mean_inference_ms": 4.99936445595295, "mean_action_processing_ms": 1.323883526706729, "mean_env_wait_ms": 0.6259035139734119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008131742477416992, "StateBufferConnector_ms": 0.008925199508666992, "ViewRequirementAgentConnector_ms": 0.5079610347747803}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2431.3977712353276, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 232000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 1587.781, "sample_time_ms": 536.087, "synch_weights_time_ms": 38.819}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2414, "training_iteration": 58, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-54", "timestamp": 1715558574, "time_this_iter_s": 1.6610352993011475, "time_total_s": 94.02120041847229, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec717940>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 94.02120041847229, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 41.2, "ram_util_percent": 38.13333333333333, "gpu_util_percent0": 0.15000000000000002, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.21666666666666667, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.19000000000000003, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.2733333333333334, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 27443.0, "episode_reward_min": -8024.0, "episode_reward_mean": -203.26, "episode_len_mean": 41.26, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2524.0, 15401.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, -5024.0, -6024.0, 27443.0, 462.0, 16401.0, -4024.0, -3024.0, -3524.0, -3024.0, -2524.0, -4524.0, 18901.0, -5024.0, 7401.0, -4024.0, -5024.0, 13901.0, -4024.0, -8024.0, -5024.0, -3524.0, -3524.0, -4524.0, -4024.0, -4024.0, 11401.0, -4524.0, -3524.0, 13901.0, -5024.0, -4024.0, 12901.0, -5024.0, 16401.0, -4524.0, -3024.0, -3024.0, -3524.0, -2524.0, 13901.0, -4024.0, -5024.0, -4524.0, 14901.0, -5024.0, 15401.0, 13401.0, 17483.0, 16883.0, 458.0, -4024.0, -3024.0, -4024.0, 16401.0, -3524.0, -6024.0, -4524.0, -7024.0, -4024.0, -1524.0, -5024.0, -4024.0, -3024.0, 12401.0, -5524.0, -4524.0, -4024.0, -2524.0, -5024.0, -6024.0, -4024.0, -4524.0, -3524.0, -3524.0, -6524.0, -4024.0, 15901.0, -5024.0, -4524.0, -2024.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5524.0, -5024.0, 15901.0, -4024.0, -4524.0, -4524.0, -3024.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 158, 39, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 100, 118, 118, 43, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.096509427906609, "mean_inference_ms": 4.995009143355434, "mean_action_processing_ms": 1.322630472279012, "mean_env_wait_ms": 0.6252802032210475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007944345474243164, "StateBufferConnector_ms": 0.007261991500854492, "ViewRequirementAgentConnector_ms": 0.5167615413665771}}, "episode_reward_max": 27443.0, "episode_reward_min": -8024.0, "episode_reward_mean": -203.26, "episode_len_mean": 41.26, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2524.0, 15401.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, -5024.0, -6024.0, 27443.0, 462.0, 16401.0, -4024.0, -3024.0, -3524.0, -3024.0, -2524.0, -4524.0, 18901.0, -5024.0, 7401.0, -4024.0, -5024.0, 13901.0, -4024.0, -8024.0, -5024.0, -3524.0, -3524.0, -4524.0, -4024.0, -4024.0, 11401.0, -4524.0, -3524.0, 13901.0, -5024.0, -4024.0, 12901.0, -5024.0, 16401.0, -4524.0, -3024.0, -3024.0, -3524.0, -2524.0, 13901.0, -4024.0, -5024.0, -4524.0, 14901.0, -5024.0, 15401.0, 13401.0, 17483.0, 16883.0, 458.0, -4024.0, -3024.0, -4024.0, 16401.0, -3524.0, -6024.0, -4524.0, -7024.0, -4024.0, -1524.0, -5024.0, -4024.0, -3024.0, 12401.0, -5524.0, -4524.0, -4024.0, -2524.0, -5024.0, -6024.0, -4024.0, -4524.0, -3524.0, -3524.0, -6524.0, -4024.0, 15901.0, -5024.0, -4524.0, -2024.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5524.0, -5024.0, 15901.0, -4024.0, -4524.0, -4524.0, -3024.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 158, 39, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 100, 118, 118, 43, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.096509427906609, "mean_inference_ms": 4.995009143355434, "mean_action_processing_ms": 1.322630472279012, "mean_env_wait_ms": 0.6252802032210475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007944345474243164, "StateBufferConnector_ms": 0.007261991500854492, "ViewRequirementAgentConnector_ms": 0.5167615413665771}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2494.9228520064485, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 236000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 1589.09, "sample_time_ms": 537.675, "synch_weights_time_ms": 36.67}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2448, "training_iteration": 59, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-56", "timestamp": 1715558576, "time_this_iter_s": 1.6125614643096924, "time_total_s": 95.63376188278198, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bd1b0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 95.63376188278198, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 47.35, "ram_util_percent": 38.1, "gpu_util_percent0": 0.29500000000000004, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.22, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.185, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.125, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 35529.0, "episode_reward_min": -7024.0, "episode_reward_mean": 289.74, "episode_len_mean": 44.26, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -5024.0, -4524.0, 14901.0, -5024.0, 15401.0, 13401.0, 17483.0, 16883.0, 458.0, -4024.0, -3024.0, -4024.0, 16401.0, -3524.0, -6024.0, -4524.0, -7024.0, -4024.0, -1524.0, -5024.0, -4024.0, -3024.0, 12401.0, -5524.0, -4524.0, -4024.0, -2524.0, -5024.0, -6024.0, -4024.0, -4524.0, -3524.0, -3524.0, -6524.0, -4024.0, 15901.0, -5024.0, -4524.0, -2024.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5524.0, -5024.0, 15901.0, -4024.0, -4524.0, -4524.0, -3024.0, -4024.0, -99.0, -5524.0, -4024.0, 8901.0, -3524.0, -4524.0, -4524.0, 7901.0, -7024.0, 14901.0, -4024.0, -4024.0, 35529.0, -4524.0, -5024.0, -4024.0, 15901.0, -3524.0, 14901.0, -5024.0, -3524.0, 14401.0, -4524.0, 19901.0, -4024.0, -4024.0, 10901.0, -3524.0, -3024.0, -4524.0, -5024.0, -3524.0, 15401.0, -1024.0, -3524.0, -4524.0, -4024.0, 12401.0, 16401.0, -6024.0, -5524.0, -3524.0, 12401.0, -4524.0, -4024.0, 9901.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 100, 100, 118, 118, 43, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 172, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.093061924013599, "mean_inference_ms": 4.99797134816404, "mean_action_processing_ms": 1.3232605308959342, "mean_env_wait_ms": 0.625118405941218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007755279541015625, "StateBufferConnector_ms": 0.007057905197143555, "ViewRequirementAgentConnector_ms": 0.48152971267700195}}, "episode_reward_max": 35529.0, "episode_reward_min": -7024.0, "episode_reward_mean": 289.74, "episode_len_mean": 44.26, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -5024.0, -4524.0, 14901.0, -5024.0, 15401.0, 13401.0, 17483.0, 16883.0, 458.0, -4024.0, -3024.0, -4024.0, 16401.0, -3524.0, -6024.0, -4524.0, -7024.0, -4024.0, -1524.0, -5024.0, -4024.0, -3024.0, 12401.0, -5524.0, -4524.0, -4024.0, -2524.0, -5024.0, -6024.0, -4024.0, -4524.0, -3524.0, -3524.0, -6524.0, -4024.0, 15901.0, -5024.0, -4524.0, -2024.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5524.0, -5024.0, 15901.0, -4024.0, -4524.0, -4524.0, -3024.0, -4024.0, -99.0, -5524.0, -4024.0, 8901.0, -3524.0, -4524.0, -4524.0, 7901.0, -7024.0, 14901.0, -4024.0, -4024.0, 35529.0, -4524.0, -5024.0, -4024.0, 15901.0, -3524.0, 14901.0, -5024.0, -3524.0, 14401.0, -4524.0, 19901.0, -4024.0, -4024.0, 10901.0, -3524.0, -3024.0, -4524.0, -5024.0, -3524.0, 15401.0, -1024.0, -3524.0, -4524.0, -4024.0, 12401.0, 16401.0, -6024.0, -5524.0, -3524.0, 12401.0, -4524.0, -4024.0, 9901.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 100, 100, 118, 118, 43, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 172, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.093061924013599, "mean_inference_ms": 4.99797134816404, "mean_action_processing_ms": 1.3232605308959342, "mean_env_wait_ms": 0.625118405941218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007755279541015625, "StateBufferConnector_ms": 0.007057905197143555, "ViewRequirementAgentConnector_ms": 0.48152971267700195}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2456.852387496149, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 240000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 1591.832, "sample_time_ms": 537.434, "synch_weights_time_ms": 36.234}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2496, "training_iteration": 60, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-57", "timestamp": 1715558577, "time_this_iter_s": 1.635787010192871, "time_total_s": 97.26954889297485, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be9b0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 97.26954889297485, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 47.15, "ram_util_percent": 38.1, "gpu_util_percent0": 0.21000000000000002, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.21999999999999997, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.12000000000000001, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.15, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 35529.0, "episode_reward_min": -7524.0, "episode_reward_mean": 339.78, "episode_len_mean": 44.22, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6524.0, -4024.0, 15901.0, -5024.0, -4524.0, -2024.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5524.0, -5024.0, 15901.0, -4024.0, -4524.0, -4524.0, -3024.0, -4024.0, -99.0, -5524.0, -4024.0, 8901.0, -3524.0, -4524.0, -4524.0, 7901.0, -7024.0, 14901.0, -4024.0, -4024.0, 35529.0, -4524.0, -5024.0, -4024.0, 15901.0, -3524.0, 14901.0, -5024.0, -3524.0, 14401.0, -4524.0, 19901.0, -4024.0, -4024.0, 10901.0, -3524.0, -3024.0, -4524.0, -5024.0, -3524.0, 15401.0, -1024.0, -3524.0, -4524.0, -4024.0, 12401.0, 16401.0, -6024.0, -5524.0, -3524.0, 12401.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -7524.0, -4024.0, -4024.0, -5024.0, -2524.0, -5524.0, -4524.0, -2024.0, 25451.0, 25351.0, 3451.0, -4024.0, -2524.0, -5024.0, -5024.0, -3524.0, -3524.0, -4524.0, 10401.0, -4524.0, -3024.0, -3024.0, 16901.0, -3524.0, 14401.0, -3524.0, -3524.0, -4024.0, -4524.0, -4524.0, 13901.0, -5524.0, -3024.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 172, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 150, 150, 50, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.092595865853054, "mean_inference_ms": 4.991993191838401, "mean_action_processing_ms": 1.322694443407269, "mean_env_wait_ms": 0.6248700056826766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007715702056884766, "StateBufferConnector_ms": 0.006622791290283203, "ViewRequirementAgentConnector_ms": 0.4741511344909668}}, "episode_reward_max": 35529.0, "episode_reward_min": -7524.0, "episode_reward_mean": 339.78, "episode_len_mean": 44.22, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6524.0, -4024.0, 15901.0, -5024.0, -4524.0, -2024.0, -5024.0, -4024.0, -4024.0, -3024.0, -3524.0, -5524.0, -5024.0, 15901.0, -4024.0, -4524.0, -4524.0, -3024.0, -4024.0, -99.0, -5524.0, -4024.0, 8901.0, -3524.0, -4524.0, -4524.0, 7901.0, -7024.0, 14901.0, -4024.0, -4024.0, 35529.0, -4524.0, -5024.0, -4024.0, 15901.0, -3524.0, 14901.0, -5024.0, -3524.0, 14401.0, -4524.0, 19901.0, -4024.0, -4024.0, 10901.0, -3524.0, -3024.0, -4524.0, -5024.0, -3524.0, 15401.0, -1024.0, -3524.0, -4524.0, -4024.0, 12401.0, 16401.0, -6024.0, -5524.0, -3524.0, 12401.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -7524.0, -4024.0, -4024.0, -5024.0, -2524.0, -5524.0, -4524.0, -2024.0, 25451.0, 25351.0, 3451.0, -4024.0, -2524.0, -5024.0, -5024.0, -3524.0, -3524.0, -4524.0, 10401.0, -4524.0, -3024.0, -3024.0, 16901.0, -3524.0, 14401.0, -3524.0, -3524.0, -4024.0, -4524.0, -4524.0, 13901.0, -5524.0, -3024.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 172, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 150, 150, 50, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.092595865853054, "mean_inference_ms": 4.991993191838401, "mean_action_processing_ms": 1.322694443407269, "mean_env_wait_ms": 0.6248700056826766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007715702056884766, "StateBufferConnector_ms": 0.006622791290283203, "ViewRequirementAgentConnector_ms": 0.4741511344909668}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2439.562603122431, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 244000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 1595.437, "sample_time_ms": 539.539, "synch_weights_time_ms": 36.054}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2530, "training_iteration": 61, "trial_id": "df94b_00000", "date": "2024-05-12_17-02-59", "timestamp": 1715558579, "time_this_iter_s": 1.6506738662719727, "time_total_s": 98.92022275924683, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa1184489a0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 98.92022275924683, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 47.35, "ram_util_percent": 38.1, "gpu_util_percent0": 0.23500000000000001, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.15, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.10500000000000001, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.175, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": "checkpoint_000012"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25451.0, "episode_reward_min": -7524.0, "episode_reward_mean": 292.37, "episode_len_mean": 42.63, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5024.0, -3524.0, 14401.0, -4524.0, 19901.0, -4024.0, -4024.0, 10901.0, -3524.0, -3024.0, -4524.0, -5024.0, -3524.0, 15401.0, -1024.0, -3524.0, -4524.0, -4024.0, 12401.0, 16401.0, -6024.0, -5524.0, -3524.0, 12401.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -7524.0, -4024.0, -4024.0, -5024.0, -2524.0, -5524.0, -4524.0, -2024.0, 25451.0, 25351.0, 3451.0, -4024.0, -2524.0, -5024.0, -5024.0, -3524.0, -3524.0, -4524.0, 10401.0, -4524.0, -3024.0, -3024.0, 16901.0, -3524.0, 14401.0, -3524.0, -3524.0, -4024.0, -4524.0, -4524.0, 13901.0, -5524.0, -3024.0, -4024.0, -4024.0, -4524.0, 15401.0, -4524.0, -4524.0, 17401.0, 16401.0, -2024.0, -4524.0, 9901.0, -4024.0, -3524.0, -3024.0, -4524.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 1060.0, -5524.0, -6524.0, -438.0, -5024.0, 14401.0, -4024.0, 5543.0, -4024.0, -4524.0, -4524.0, -3024.0, -2524.0, 18901.0], "episode_lengths": [25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 150, 150, 50, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 41, 25, 25, 39, 25, 100, 25, 58, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0956516163894126, "mean_inference_ms": 4.995480671257263, "mean_action_processing_ms": 1.3239593502814486, "mean_env_wait_ms": 0.6252778906043429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007802009582519531, "StateBufferConnector_ms": 0.007126331329345703, "ViewRequirementAgentConnector_ms": 0.48170948028564453}}, "episode_reward_max": 25451.0, "episode_reward_min": -7524.0, "episode_reward_mean": 292.37, "episode_len_mean": 42.63, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5024.0, -3524.0, 14401.0, -4524.0, 19901.0, -4024.0, -4024.0, 10901.0, -3524.0, -3024.0, -4524.0, -5024.0, -3524.0, 15401.0, -1024.0, -3524.0, -4524.0, -4024.0, 12401.0, 16401.0, -6024.0, -5524.0, -3524.0, 12401.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -7524.0, -4024.0, -4024.0, -5024.0, -2524.0, -5524.0, -4524.0, -2024.0, 25451.0, 25351.0, 3451.0, -4024.0, -2524.0, -5024.0, -5024.0, -3524.0, -3524.0, -4524.0, 10401.0, -4524.0, -3024.0, -3024.0, 16901.0, -3524.0, 14401.0, -3524.0, -3524.0, -4024.0, -4524.0, -4524.0, 13901.0, -5524.0, -3024.0, -4024.0, -4024.0, -4524.0, 15401.0, -4524.0, -4524.0, 17401.0, 16401.0, -2024.0, -4524.0, 9901.0, -4024.0, -3524.0, -3024.0, -4524.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 1060.0, -5524.0, -6524.0, -438.0, -5024.0, 14401.0, -4024.0, 5543.0, -4024.0, -4524.0, -4524.0, -3024.0, -2524.0, 18901.0], "episode_lengths": [25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 150, 150, 50, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 41, 25, 25, 39, 25, 100, 25, 58, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0956516163894126, "mean_inference_ms": 4.995480671257263, "mean_action_processing_ms": 1.3239593502814486, "mean_env_wait_ms": 0.6252778906043429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007802009582519531, "StateBufferConnector_ms": 0.007126331329345703, "ViewRequirementAgentConnector_ms": 0.48170948028564453}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2651.513968590624, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 248000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 1585.254, "sample_time_ms": 538.08, "synch_weights_time_ms": 36.009}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2568, "training_iteration": 62, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-01", "timestamp": 1715558581, "time_this_iter_s": 1.5200636386871338, "time_total_s": 100.44028639793396, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118448970>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 100.44028639793396, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 46.599999999999994, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.35, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.13, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.1, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.16499999999999998, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 22901.0, "episode_reward_min": -6524.0, "episode_reward_mean": 362.7, "episode_len_mean": 42.3, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -3524.0, -4524.0, 10401.0, -4524.0, -3024.0, -3024.0, 16901.0, -3524.0, 14401.0, -3524.0, -3524.0, -4024.0, -4524.0, -4524.0, 13901.0, -5524.0, -3024.0, -4024.0, -4024.0, -4524.0, 15401.0, -4524.0, -4524.0, 17401.0, 16401.0, -2024.0, -4524.0, 9901.0, -4024.0, -3524.0, -3024.0, -4524.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 1060.0, -5524.0, -6524.0, -438.0, -5024.0, 14401.0, -4024.0, 5543.0, -4024.0, -4524.0, -4524.0, -3024.0, -2524.0, 18901.0, -4024.0, 11401.0, -4024.0, -4024.0, 8901.0, -4524.0, 1559.0, -4024.0, -5024.0, -3024.0, -5024.0, -4524.0, -4024.0, -3024.0, 16901.0, -4024.0, -3524.0, 15401.0, -4524.0, -3524.0, 15901.0, -3524.0, 20901.0, -5024.0, -5024.0, -5024.0, -3524.0, -3524.0, 15401.0, -4524.0, -4024.0, 9901.0, -4524.0, 12901.0, -4024.0, 22901.0, -2024.0, -3524.0, -3024.0, 14901.0, -5024.0, -5024.0, -4024.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 41, 25, 25, 39, 25, 100, 25, 58, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 42, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.089370457122771, "mean_inference_ms": 4.991847703208536, "mean_action_processing_ms": 1.321674014579267, "mean_env_wait_ms": 0.6240976296541689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007897615432739258, "StateBufferConnector_ms": 0.006560087203979492, "ViewRequirementAgentConnector_ms": 0.4919142723083496}}, "episode_reward_max": 22901.0, "episode_reward_min": -6524.0, "episode_reward_mean": 362.7, "episode_len_mean": 42.3, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -3524.0, -4524.0, 10401.0, -4524.0, -3024.0, -3024.0, 16901.0, -3524.0, 14401.0, -3524.0, -3524.0, -4024.0, -4524.0, -4524.0, 13901.0, -5524.0, -3024.0, -4024.0, -4024.0, -4524.0, 15401.0, -4524.0, -4524.0, 17401.0, 16401.0, -2024.0, -4524.0, 9901.0, -4024.0, -3524.0, -3024.0, -4524.0, -4024.0, -4524.0, -4024.0, -4524.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 1060.0, -5524.0, -6524.0, -438.0, -5024.0, 14401.0, -4024.0, 5543.0, -4024.0, -4524.0, -4524.0, -3024.0, -2524.0, 18901.0, -4024.0, 11401.0, -4024.0, -4024.0, 8901.0, -4524.0, 1559.0, -4024.0, -5024.0, -3024.0, -5024.0, -4524.0, -4024.0, -3024.0, 16901.0, -4024.0, -3524.0, 15401.0, -4524.0, -3524.0, 15901.0, -3524.0, 20901.0, -5024.0, -5024.0, -5024.0, -3524.0, -3524.0, 15401.0, -4524.0, -4024.0, 9901.0, -4524.0, 12901.0, -4024.0, 22901.0, -2024.0, -3524.0, -3024.0, 14901.0, -5024.0, -5024.0, -4024.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 41, 25, 25, 39, 25, 100, 25, 58, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 42, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.089370457122771, "mean_inference_ms": 4.991847703208536, "mean_action_processing_ms": 1.321674014579267, "mean_env_wait_ms": 0.6240976296541689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007897615432739258, "StateBufferConnector_ms": 0.006560087203979492, "ViewRequirementAgentConnector_ms": 0.4919142723083496}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2436.3331197194643, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 252000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 1591.075, "sample_time_ms": 537.68, "synch_weights_time_ms": 36.241}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2612, "training_iteration": 63, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-02", "timestamp": 1715558582, "time_this_iter_s": 1.6518566608428955, "time_total_s": 102.09214305877686, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec832050>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 102.09214305877686, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 40.36666666666667, "ram_util_percent": 38.13333333333333, "gpu_util_percent0": 0.22666666666666666, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.2233333333333333, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.21, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.25333333333333335, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 573180.0, "episode_reward_min": -6524.0, "episode_reward_mean": 10613.49, "episode_len_mean": 84.51, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 1060.0, -5524.0, -6524.0, -438.0, -5024.0, 14401.0, -4024.0, 5543.0, -4024.0, -4524.0, -4524.0, -3024.0, -2524.0, 18901.0, -4024.0, 11401.0, -4024.0, -4024.0, 8901.0, -4524.0, 1559.0, -4024.0, -5024.0, -3024.0, -5024.0, -4524.0, -4024.0, -3024.0, 16901.0, -4024.0, -3524.0, 15401.0, -4524.0, -3524.0, 15901.0, -3524.0, 20901.0, -5024.0, -5024.0, -5024.0, -3524.0, -3524.0, 15401.0, -4524.0, -4024.0, 9901.0, -4524.0, 12901.0, -4024.0, 22901.0, -2024.0, -3524.0, -3024.0, 14901.0, -5024.0, -5024.0, -4024.0, -4024.0, -4524.0, -3524.0, 100161.0, 99061.0, 461.0, -4024.0, 14901.0, -4024.0, -4024.0, -4524.0, -3024.0, -4524.0, -4524.0, -4024.0, -4524.0, 573180.0, 215577.0, 1952.0, -4024.0, -4524.0, 9901.0, -4524.0, -4024.0, -3524.0, -4024.0, -4024.0, -5024.0, 53369.0, 49269.0, 1958.0, -4024.0, -4524.0, 11401.0, -5524.0, -4524.0, -4024.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 41, 25, 25, 39, 25, 100, 25, 58, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 42, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 440, 440, 40, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 2421, 924, 49, 25, 25, 100, 25, 25, 25, 25, 25, 25, 232, 232, 43, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.089861226132488, "mean_inference_ms": 4.989607566800832, "mean_action_processing_ms": 1.3212701600501655, "mean_env_wait_ms": 0.6242915456256576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008123159408569336, "StateBufferConnector_ms": 0.008101701736450195, "ViewRequirementAgentConnector_ms": 0.5064718723297119}}, "episode_reward_max": 573180.0, "episode_reward_min": -6524.0, "episode_reward_mean": 10613.49, "episode_len_mean": 84.51, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, 15401.0, -4024.0, -3024.0, -4524.0, 1060.0, -5524.0, -6524.0, -438.0, -5024.0, 14401.0, -4024.0, 5543.0, -4024.0, -4524.0, -4524.0, -3024.0, -2524.0, 18901.0, -4024.0, 11401.0, -4024.0, -4024.0, 8901.0, -4524.0, 1559.0, -4024.0, -5024.0, -3024.0, -5024.0, -4524.0, -4024.0, -3024.0, 16901.0, -4024.0, -3524.0, 15401.0, -4524.0, -3524.0, 15901.0, -3524.0, 20901.0, -5024.0, -5024.0, -5024.0, -3524.0, -3524.0, 15401.0, -4524.0, -4024.0, 9901.0, -4524.0, 12901.0, -4024.0, 22901.0, -2024.0, -3524.0, -3024.0, 14901.0, -5024.0, -5024.0, -4024.0, -4024.0, -4524.0, -3524.0, 100161.0, 99061.0, 461.0, -4024.0, 14901.0, -4024.0, -4024.0, -4524.0, -3024.0, -4524.0, -4524.0, -4024.0, -4524.0, 573180.0, 215577.0, 1952.0, -4024.0, -4524.0, 9901.0, -4524.0, -4024.0, -3524.0, -4024.0, -4024.0, -5024.0, 53369.0, 49269.0, 1958.0, -4024.0, -4524.0, 11401.0, -5524.0, -4524.0, -4024.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 41, 25, 25, 39, 25, 100, 25, 58, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 42, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 440, 440, 40, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 2421, 924, 49, 25, 25, 100, 25, 25, 25, 25, 25, 25, 232, 232, 43, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.089861226132488, "mean_inference_ms": 4.989607566800832, "mean_action_processing_ms": 1.3212701600501655, "mean_env_wait_ms": 0.6242915456256576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008123159408569336, "StateBufferConnector_ms": 0.008101701736450195, "ViewRequirementAgentConnector_ms": 0.5064718723297119}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2542.550998882183, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 256000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 1593.893, "sample_time_ms": 537.157, "synch_weights_time_ms": 36.709}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2648, "training_iteration": 64, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-04", "timestamp": 1715558584, "time_this_iter_s": 1.5813539028167725, "time_total_s": 103.67349696159363, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec831f00>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 103.67349696159363, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 48.3, "ram_util_percent": 38.2, "gpu_util_percent0": 0.19999999999999998, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.21000000000000002, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.185, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.28, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 573180.0, "episode_reward_min": -9024.0, "episode_reward_mean": 17521.74, "episode_len_mean": 113.26, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9901.0, -4524.0, 12901.0, -4024.0, 22901.0, -2024.0, -3524.0, -3024.0, 14901.0, -5024.0, -5024.0, -4024.0, -4024.0, -4524.0, -3524.0, 100161.0, 99061.0, 461.0, -4024.0, 14901.0, -4024.0, -4024.0, -4524.0, -3024.0, -4524.0, -4524.0, -4024.0, -4524.0, 573180.0, 215577.0, 1952.0, -4024.0, -4524.0, 9901.0, -4524.0, -4024.0, -3524.0, -4024.0, -4024.0, -5024.0, 53369.0, 49269.0, 1958.0, -4024.0, -4524.0, 11401.0, -5524.0, -4524.0, -4024.0, -4024.0, 13901.0, -3524.0, 12401.0, -4024.0, -5024.0, -3024.0, 20401.0, -4024.0, 11401.0, -3524.0, -3524.0, 14901.0, 503540.0, 124954.0, 2454.0, -5024.0, -4524.0, 15901.0, -5024.0, 14901.0, -4024.0, -4024.0, 15401.0, -5024.0, -4524.0, 12401.0, -4024.0, 12901.0, -3024.0, -5524.0, -5524.0, -4524.0, -5024.0, 12901.0, -4024.0, -5524.0, -3524.0, -3024.0, -5024.0, -2524.0, 13401.0, 14901.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -5524.0, 12401.0, -9024.0], "episode_lengths": [100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 440, 440, 40, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 2421, 924, 49, 25, 25, 100, 25, 25, 25, 25, 25, 25, 232, 232, 43, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 2061, 547, 47, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.087811648216617, "mean_inference_ms": 4.995042360866089, "mean_action_processing_ms": 1.322147269131845, "mean_env_wait_ms": 0.624199164157777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008202075958251953, "StateBufferConnector_ms": 0.008667230606079102, "ViewRequirementAgentConnector_ms": 0.48448610305786133}}, "episode_reward_max": 573180.0, "episode_reward_min": -9024.0, "episode_reward_mean": 17521.74, "episode_len_mean": 113.26, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9901.0, -4524.0, 12901.0, -4024.0, 22901.0, -2024.0, -3524.0, -3024.0, 14901.0, -5024.0, -5024.0, -4024.0, -4024.0, -4524.0, -3524.0, 100161.0, 99061.0, 461.0, -4024.0, 14901.0, -4024.0, -4024.0, -4524.0, -3024.0, -4524.0, -4524.0, -4024.0, -4524.0, 573180.0, 215577.0, 1952.0, -4024.0, -4524.0, 9901.0, -4524.0, -4024.0, -3524.0, -4024.0, -4024.0, -5024.0, 53369.0, 49269.0, 1958.0, -4024.0, -4524.0, 11401.0, -5524.0, -4524.0, -4024.0, -4024.0, 13901.0, -3524.0, 12401.0, -4024.0, -5024.0, -3024.0, 20401.0, -4024.0, 11401.0, -3524.0, -3524.0, 14901.0, 503540.0, 124954.0, 2454.0, -5024.0, -4524.0, 15901.0, -5024.0, 14901.0, -4024.0, -4024.0, 15401.0, -5024.0, -4524.0, 12401.0, -4024.0, 12901.0, -3024.0, -5524.0, -5524.0, -4524.0, -5024.0, 12901.0, -4024.0, -5524.0, -3524.0, -3024.0, -5024.0, -2524.0, 13401.0, 14901.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -5524.0, 12401.0, -9024.0], "episode_lengths": [100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 440, 440, 40, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 2421, 924, 49, 25, 25, 100, 25, 25, 25, 25, 25, 25, 232, 232, 43, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 2061, 547, 47, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.087811648216617, "mean_inference_ms": 4.995042360866089, "mean_action_processing_ms": 1.322147269131845, "mean_env_wait_ms": 0.624199164157777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008202075958251953, "StateBufferConnector_ms": 0.008667230606079102, "ViewRequirementAgentConnector_ms": 0.48448610305786133}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2425.4142320555343, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 260000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 1595.959, "sample_time_ms": 540.882, "synch_weights_time_ms": 36.821}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2699, "training_iteration": 65, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-06", "timestamp": 1715558586, "time_this_iter_s": 1.663917064666748, "time_total_s": 105.33741402626038, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa1184489a0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 105.33741402626038, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 48.95, "ram_util_percent": 38.2, "gpu_util_percent0": 0.235, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.145, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.18, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.19, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 503540.0, "episode_reward_min": -9024.0, "episode_reward_mean": 13539.61, "episode_len_mean": 96.39, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, -3524.0, -4024.0, -4024.0, -5024.0, 53369.0, 49269.0, 1958.0, -4024.0, -4524.0, 11401.0, -5524.0, -4524.0, -4024.0, -4024.0, 13901.0, -3524.0, 12401.0, -4024.0, -5024.0, -3024.0, 20401.0, -4024.0, 11401.0, -3524.0, -3524.0, 14901.0, 503540.0, 124954.0, 2454.0, -5024.0, -4524.0, 15901.0, -5024.0, 14901.0, -4024.0, -4024.0, 15401.0, -5024.0, -4524.0, 12401.0, -4024.0, 12901.0, -3024.0, -5524.0, -5524.0, -4524.0, -5024.0, 12901.0, -4024.0, -5524.0, -3524.0, -3024.0, -5024.0, -2524.0, 13401.0, 14901.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -5524.0, 12401.0, -9024.0, -4524.0, -4024.0, -3024.0, -3524.0, -437.0, -4024.0, -3524.0, -5024.0, -4524.0, -5024.0, -4524.0, -3024.0, -5024.0, -5524.0, -5024.0, -3524.0, -7024.0, 15901.0, -2524.0, -3024.0, 17901.0, -4524.0, 3901.0, -4024.0, -524.0, -4024.0, -4024.0, 320777.0, 322277.0, -40.0, 12401.0, -4524.0, -2024.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 232, 232, 43, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 2061, 547, 47, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 38, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 1324, 1324, 41, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.092950276275362, "mean_inference_ms": 4.994347382529173, "mean_action_processing_ms": 1.3226804670998624, "mean_env_wait_ms": 0.6244628464319778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008193254470825195, "StateBufferConnector_ms": 0.007759809494018555, "ViewRequirementAgentConnector_ms": 0.4756433963775635}}, "episode_reward_max": 503540.0, "episode_reward_min": -9024.0, "episode_reward_mean": 13539.61, "episode_len_mean": 96.39, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, -3524.0, -4024.0, -4024.0, -5024.0, 53369.0, 49269.0, 1958.0, -4024.0, -4524.0, 11401.0, -5524.0, -4524.0, -4024.0, -4024.0, 13901.0, -3524.0, 12401.0, -4024.0, -5024.0, -3024.0, 20401.0, -4024.0, 11401.0, -3524.0, -3524.0, 14901.0, 503540.0, 124954.0, 2454.0, -5024.0, -4524.0, 15901.0, -5024.0, 14901.0, -4024.0, -4024.0, 15401.0, -5024.0, -4524.0, 12401.0, -4024.0, 12901.0, -3024.0, -5524.0, -5524.0, -4524.0, -5024.0, 12901.0, -4024.0, -5524.0, -3524.0, -3024.0, -5024.0, -2524.0, 13401.0, 14901.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -5524.0, 12401.0, -9024.0, -4524.0, -4024.0, -3024.0, -3524.0, -437.0, -4024.0, -3524.0, -5024.0, -4524.0, -5024.0, -4524.0, -3024.0, -5024.0, -5524.0, -5024.0, -3524.0, -7024.0, 15901.0, -2524.0, -3024.0, 17901.0, -4524.0, 3901.0, -4024.0, -524.0, -4024.0, -4024.0, 320777.0, 322277.0, -40.0, 12401.0, -4524.0, -2024.0, -4024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 232, 232, 43, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 2061, 547, 47, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 38, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 1324, 1324, 41, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.092950276275362, "mean_inference_ms": 4.994347382529173, "mean_action_processing_ms": 1.3226804670998624, "mean_env_wait_ms": 0.6244628464319778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008193254470825195, "StateBufferConnector_ms": 0.007759809494018555, "ViewRequirementAgentConnector_ms": 0.4756433963775635}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2594.4508199624006, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 264000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 1591.051, "sample_time_ms": 539.605, "synch_weights_time_ms": 36.441}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2733, "training_iteration": 66, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-08", "timestamp": 1715558588, "time_this_iter_s": 1.5543217658996582, "time_total_s": 106.89173579216003, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa1184485e0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 106.89173579216003, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 47.75, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.185, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.095, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.18, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.175, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": "checkpoint_000013"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 322277.0, "episode_reward_min": -9024.0, "episode_reward_mean": 9979.62, "episode_len_mean": 82.38, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12401.0, -4024.0, 12901.0, -3024.0, -5524.0, -5524.0, -4524.0, -5024.0, 12901.0, -4024.0, -5524.0, -3524.0, -3024.0, -5024.0, -2524.0, 13401.0, 14901.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -5524.0, 12401.0, -9024.0, -4524.0, -4024.0, -3024.0, -3524.0, -437.0, -4024.0, -3524.0, -5024.0, -4524.0, -5024.0, -4524.0, -3024.0, -5024.0, -5524.0, -5024.0, -3524.0, -7024.0, 15901.0, -2524.0, -3024.0, 17901.0, -4524.0, 3901.0, -4024.0, -524.0, -4024.0, -4024.0, 320777.0, 322277.0, -40.0, 12401.0, -4524.0, -2024.0, -4024.0, -3524.0, -1933.0, 9401.0, -4024.0, -4024.0, -3524.0, -4524.0, 12901.0, 18901.0, -3024.0, -3024.0, -4024.0, 13901.0, -4524.0, -4524.0, -3524.0, -3524.0, -1524.0, -3024.0, -4024.0, -5524.0, 15401.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, -3024.0, -6024.0, 8901.0, -4024.0, -3024.0, -4024.0, -4024.0, 273572.0, 144852.0, 3452.0, 20401.0], "episode_lengths": [100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 38, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 1324, 1324, 41, 100, 25, 25, 25, 25, 34, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 1129, 649, 49, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.101409745105454, "mean_inference_ms": 4.995765050227481, "mean_action_processing_ms": 1.3230928575389749, "mean_env_wait_ms": 0.625234129866621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008223772048950195, "StateBufferConnector_ms": 0.0073986053466796875, "ViewRequirementAgentConnector_ms": 0.48148250579833984}}, "episode_reward_max": 322277.0, "episode_reward_min": -9024.0, "episode_reward_mean": 9979.62, "episode_len_mean": 82.38, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12401.0, -4024.0, 12901.0, -3024.0, -5524.0, -5524.0, -4524.0, -5024.0, 12901.0, -4024.0, -5524.0, -3524.0, -3024.0, -5024.0, -2524.0, 13401.0, 14901.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -5524.0, 12401.0, -9024.0, -4524.0, -4024.0, -3024.0, -3524.0, -437.0, -4024.0, -3524.0, -5024.0, -4524.0, -5024.0, -4524.0, -3024.0, -5024.0, -5524.0, -5024.0, -3524.0, -7024.0, 15901.0, -2524.0, -3024.0, 17901.0, -4524.0, 3901.0, -4024.0, -524.0, -4024.0, -4024.0, 320777.0, 322277.0, -40.0, 12401.0, -4524.0, -2024.0, -4024.0, -3524.0, -1933.0, 9401.0, -4024.0, -4024.0, -3524.0, -4524.0, 12901.0, 18901.0, -3024.0, -3024.0, -4024.0, 13901.0, -4524.0, -4524.0, -3524.0, -3524.0, -1524.0, -3024.0, -4024.0, -5524.0, 15401.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, -3024.0, -6024.0, 8901.0, -4024.0, -3024.0, -4024.0, -4024.0, 273572.0, 144852.0, 3452.0, 20401.0], "episode_lengths": [100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 38, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 1324, 1324, 41, 100, 25, 25, 25, 25, 34, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 1129, 649, 49, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.101409745105454, "mean_inference_ms": 4.995765050227481, "mean_action_processing_ms": 1.3230928575389749, "mean_env_wait_ms": 0.625234129866621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008223772048950195, "StateBufferConnector_ms": 0.0073986053466796875, "ViewRequirementAgentConnector_ms": 0.48148250579833984}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2514.9084769177634, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 268000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 1602.076, "sample_time_ms": 540.536, "synch_weights_time_ms": 36.471}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2774, "training_iteration": 67, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-09", "timestamp": 1715558589, "time_this_iter_s": 1.5989165306091309, "time_total_s": 108.49065232276917, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be440>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 108.49065232276917, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 48.25, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.115, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.135, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.22999999999999998, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 322277.0, "episode_reward_min": -8024.0, "episode_reward_mean": 10596.5, "episode_len_mean": 84.5, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15901.0, -2524.0, -3024.0, 17901.0, -4524.0, 3901.0, -4024.0, -524.0, -4024.0, -4024.0, 320777.0, 322277.0, -40.0, 12401.0, -4524.0, -2024.0, -4024.0, -3524.0, -1933.0, 9401.0, -4024.0, -4024.0, -3524.0, -4524.0, 12901.0, 18901.0, -3024.0, -3024.0, -4024.0, 13901.0, -4524.0, -4524.0, -3524.0, -3524.0, -1524.0, -3024.0, -4024.0, -5524.0, 15401.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, -3024.0, -6024.0, 8901.0, -4024.0, -3024.0, -4024.0, -4024.0, 273572.0, 144852.0, 3452.0, 20401.0, -4024.0, 14901.0, -5024.0, -3024.0, 13401.0, -3524.0, -4524.0, -3524.0, -4024.0, -1524.0, -3524.0, -3524.0, -4524.0, 14901.0, -3524.0, -3024.0, 12401.0, -3524.0, -4024.0, 8901.0, -5524.0, -4524.0, -4024.0, -3524.0, -4024.0, 6401.0, -4024.0, -5524.0, 15901.0, -3524.0, 10901.0, -6024.0, 14901.0, -3524.0, -3524.0, -3524.0, -3024.0, 12901.0, -3024.0, -4024.0, -4024.0, -5024.0], "episode_lengths": [100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 1324, 1324, 41, 100, 25, 25, 25, 25, 34, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 1129, 649, 49, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.095843852886345, "mean_inference_ms": 4.994489275160942, "mean_action_processing_ms": 1.322362879979709, "mean_env_wait_ms": 0.6245462681012248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008040189743041992, "StateBufferConnector_ms": 0.0071032047271728516, "ViewRequirementAgentConnector_ms": 0.4785475730895996}}, "episode_reward_max": 322277.0, "episode_reward_min": -8024.0, "episode_reward_mean": 10596.5, "episode_len_mean": 84.5, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15901.0, -2524.0, -3024.0, 17901.0, -4524.0, 3901.0, -4024.0, -524.0, -4024.0, -4024.0, 320777.0, 322277.0, -40.0, 12401.0, -4524.0, -2024.0, -4024.0, -3524.0, -1933.0, 9401.0, -4024.0, -4024.0, -3524.0, -4524.0, 12901.0, 18901.0, -3024.0, -3024.0, -4024.0, 13901.0, -4524.0, -4524.0, -3524.0, -3524.0, -1524.0, -3024.0, -4024.0, -5524.0, 15401.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, -3024.0, -6024.0, 8901.0, -4024.0, -3024.0, -4024.0, -4024.0, 273572.0, 144852.0, 3452.0, 20401.0, -4024.0, 14901.0, -5024.0, -3024.0, 13401.0, -3524.0, -4524.0, -3524.0, -4024.0, -1524.0, -3524.0, -3524.0, -4524.0, 14901.0, -3524.0, -3024.0, 12401.0, -3524.0, -4024.0, 8901.0, -5524.0, -4524.0, -4024.0, -3524.0, -4024.0, 6401.0, -4024.0, -5524.0, 15901.0, -3524.0, 10901.0, -6024.0, 14901.0, -3524.0, -3524.0, -3524.0, -3024.0, 12901.0, -3024.0, -4024.0, -4024.0, -5024.0], "episode_lengths": [100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 1324, 1324, 41, 100, 25, 25, 25, 25, 34, 100, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 1129, 649, 49, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.095843852886345, "mean_inference_ms": 4.994489275160942, "mean_action_processing_ms": 1.322362879979709, "mean_env_wait_ms": 0.6245462681012248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008040189743041992, "StateBufferConnector_ms": 0.0071032047271728516, "ViewRequirementAgentConnector_ms": 0.4785475730895996}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2491.3306462690143, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 272000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 1598.121, "sample_time_ms": 538.652, "synch_weights_time_ms": 36.09}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2816, "training_iteration": 68, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-11", "timestamp": 1715558591, "time_this_iter_s": 1.6148443222045898, "time_total_s": 110.10549664497375, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5be7d0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 110.10549664497375, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 40.23333333333333, "ram_util_percent": 38.1, "gpu_util_percent0": 0.24000000000000002, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.21666666666666667, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.12, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.17666666666666667, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 273572.0, "episode_reward_min": -8024.0, "episode_reward_mean": 8681.65, "episode_len_mean": 78.35, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5524.0, 15401.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, -3024.0, -6024.0, 8901.0, -4024.0, -3024.0, -4024.0, -4024.0, 273572.0, 144852.0, 3452.0, 20401.0, -4024.0, 14901.0, -5024.0, -3024.0, 13401.0, -3524.0, -4524.0, -3524.0, -4024.0, -1524.0, -3524.0, -3524.0, -4524.0, 14901.0, -3524.0, -3024.0, 12401.0, -3524.0, -4024.0, 8901.0, -5524.0, -4524.0, -4024.0, -3524.0, -4024.0, 6401.0, -4024.0, -5524.0, 15901.0, -3524.0, 10901.0, -6024.0, 14901.0, -3524.0, -3524.0, -3524.0, -3024.0, 12901.0, -3024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4024.0, -3524.0, 12901.0, -3524.0, 138008.0, 1958.0, -4524.0, -4524.0, -3024.0, -6024.0, -3524.0, 127483.0, 136383.0, 133383.0, 958.0, -5024.0, -6024.0, -4024.0, -3524.0, -3024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, -3024.0, -4524.0, -4024.0, -4024.0, 15401.0, -2524.0, -3524.0, -3524.0, -4524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 1129, 649, 49, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 593, 43, 25, 25, 25, 25, 25, 618, 618, 618, 43, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.091693155168477, "mean_inference_ms": 4.989691230709326, "mean_action_processing_ms": 1.320859336092141, "mean_env_wait_ms": 0.6239687750954929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007884025573730469, "StateBufferConnector_ms": 0.0077877044677734375, "ViewRequirementAgentConnector_ms": 0.48126816749572754}}, "episode_reward_max": 273572.0, "episode_reward_min": -8024.0, "episode_reward_mean": 8681.65, "episode_len_mean": 78.35, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5524.0, 15401.0, -4024.0, -8024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, -3024.0, -6024.0, 8901.0, -4024.0, -3024.0, -4024.0, -4024.0, 273572.0, 144852.0, 3452.0, 20401.0, -4024.0, 14901.0, -5024.0, -3024.0, 13401.0, -3524.0, -4524.0, -3524.0, -4024.0, -1524.0, -3524.0, -3524.0, -4524.0, 14901.0, -3524.0, -3024.0, 12401.0, -3524.0, -4024.0, 8901.0, -5524.0, -4524.0, -4024.0, -3524.0, -4024.0, 6401.0, -4024.0, -5524.0, 15901.0, -3524.0, 10901.0, -6024.0, 14901.0, -3524.0, -3524.0, -3524.0, -3024.0, 12901.0, -3024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4024.0, -3524.0, 12901.0, -3524.0, 138008.0, 1958.0, -4524.0, -4524.0, -3024.0, -6024.0, -3524.0, 127483.0, 136383.0, 133383.0, 958.0, -5024.0, -6024.0, -4024.0, -3524.0, -3024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, -3024.0, -4524.0, -4024.0, -4024.0, 15401.0, -2524.0, -3524.0, -3524.0, -4524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 1129, 649, 49, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 593, 43, 25, 25, 25, 25, 25, 618, 618, 618, 43, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.091693155168477, "mean_inference_ms": 4.989691230709326, "mean_action_processing_ms": 1.320859336092141, "mean_env_wait_ms": 0.6239687750954929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007884025573730469, "StateBufferConnector_ms": 0.0077877044677734375, "ViewRequirementAgentConnector_ms": 0.48126816749572754}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2568.712755713923, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 276000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 1593.515, "sample_time_ms": 538.401, "synch_weights_time_ms": 36.892}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2853, "training_iteration": 69, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-13", "timestamp": 1715558593, "time_this_iter_s": 1.5697696208953857, "time_total_s": 111.67526626586914, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bcca0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 111.67526626586914, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 47.55, "ram_util_percent": 38.1, "gpu_util_percent0": 0.22999999999999998, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.21500000000000002, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.16, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.12, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 138008.0, "episode_reward_min": -8024.0, "episode_reward_mean": 5159.19, "episode_len_mean": 64.81, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -5524.0, 15901.0, -3524.0, 10901.0, -6024.0, 14901.0, -3524.0, -3524.0, -3524.0, -3024.0, 12901.0, -3024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4024.0, -3524.0, 12901.0, -3524.0, 138008.0, 1958.0, -4524.0, -4524.0, -3024.0, -6024.0, -3524.0, 127483.0, 136383.0, 133383.0, 958.0, -5024.0, -6024.0, -4024.0, -3524.0, -3024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, -3024.0, -4524.0, -4024.0, -4024.0, 15401.0, -2524.0, -3524.0, -3524.0, -4524.0, -5524.0, 11401.0, -5524.0, -5024.0, 11901.0, 4053.0, -3524.0, 16401.0, -4024.0, 14401.0, -4024.0, -3524.0, -5024.0, 14901.0, -2524.0, -3024.0, 13401.0, -3524.0, 6401.0, -4524.0, 12401.0, -5024.0, -4024.0, -3524.0, 11401.0, -4024.0, -4024.0, -5024.0, -4024.0, -5024.0, 15401.0, -3524.0, -4524.0, -4524.0, -4524.0, -8024.0, -3524.0, 10401.0, 13901.0, -4524.0, -3524.0, -4024.0, 12401.0, -4524.0, -4024.0, 13901.0, -6024.0], "episode_lengths": [25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 593, 43, 25, 25, 25, 25, 25, 618, 618, 618, 43, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 48, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.088567299189751, "mean_inference_ms": 4.990874468045456, "mean_action_processing_ms": 1.3208580604700253, "mean_env_wait_ms": 0.6236728985786885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007803678512573242, "StateBufferConnector_ms": 0.007166385650634766, "ViewRequirementAgentConnector_ms": 0.47392868995666504}}, "episode_reward_max": 138008.0, "episode_reward_min": -8024.0, "episode_reward_mean": 5159.19, "episode_len_mean": 64.81, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -5524.0, 15901.0, -3524.0, 10901.0, -6024.0, 14901.0, -3524.0, -3524.0, -3524.0, -3024.0, 12901.0, -3024.0, -4024.0, -4024.0, -5024.0, -5024.0, -5024.0, -4024.0, -3524.0, 12901.0, -3524.0, 138008.0, 1958.0, -4524.0, -4524.0, -3024.0, -6024.0, -3524.0, 127483.0, 136383.0, 133383.0, 958.0, -5024.0, -6024.0, -4024.0, -3524.0, -3024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, -3024.0, -4524.0, -4024.0, -4024.0, 15401.0, -2524.0, -3524.0, -3524.0, -4524.0, -5524.0, 11401.0, -5524.0, -5024.0, 11901.0, 4053.0, -3524.0, 16401.0, -4024.0, 14401.0, -4024.0, -3524.0, -5024.0, 14901.0, -2524.0, -3024.0, 13401.0, -3524.0, 6401.0, -4524.0, 12401.0, -5024.0, -4024.0, -3524.0, 11401.0, -4024.0, -4024.0, -5024.0, -4024.0, -5024.0, 15401.0, -3524.0, -4524.0, -4524.0, -4524.0, -8024.0, -3524.0, 10401.0, 13901.0, -4524.0, -3524.0, -4024.0, 12401.0, -4524.0, -4024.0, 13901.0, -6024.0], "episode_lengths": [25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 593, 43, 25, 25, 25, 25, 25, 618, 618, 618, 43, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 48, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.088567299189751, "mean_inference_ms": 4.990874468045456, "mean_action_processing_ms": 1.3208580604700253, "mean_env_wait_ms": 0.6236728985786885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007803678512573242, "StateBufferConnector_ms": 0.007166385650634766, "ViewRequirementAgentConnector_ms": 0.47392868995666504}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2390.550543384792, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 280000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 1598.031, "sample_time_ms": 548.686, "synch_weights_time_ms": 36.2}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2900, "training_iteration": 70, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-14", "timestamp": 1715558594, "time_this_iter_s": 1.6851015090942383, "time_total_s": 113.36036777496338, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bfc10>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 113.36036777496338, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 45.8, "ram_util_percent": 38.1, "gpu_util_percent0": 0.175, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.11000000000000001, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.115, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.2, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 51976.0, "episode_reward_min": -8024.0, "episode_reward_mean": 650.7, "episode_len_mean": 44.3, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -3524.0, -3024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, -3024.0, -4524.0, -4024.0, -4024.0, 15401.0, -2524.0, -3524.0, -3524.0, -4524.0, -5524.0, 11401.0, -5524.0, -5024.0, 11901.0, 4053.0, -3524.0, 16401.0, -4024.0, 14401.0, -4024.0, -3524.0, -5024.0, 14901.0, -2524.0, -3024.0, 13401.0, -3524.0, 6401.0, -4524.0, 12401.0, -5024.0, -4024.0, -3524.0, 11401.0, -4024.0, -4024.0, -5024.0, -4024.0, -5024.0, 15401.0, -3524.0, -4524.0, -4524.0, -4524.0, -8024.0, -3524.0, 10401.0, 13901.0, -4524.0, -3524.0, -4024.0, 12401.0, -4524.0, -4024.0, 13901.0, -6024.0, -3524.0, -4024.0, -4524.0, -3524.0, -4024.0, -7524.0, -2524.0, -4024.0, -5524.0, 46385.0, -40.0, -4524.0, -3524.0, -4524.0, -3524.0, -3024.0, -3524.0, -3024.0, 51976.0, -3024.0, -5024.0, 13401.0, -4524.0, 20901.0, -4524.0, 18901.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 13901.0, -2524.0, -4024.0, -5024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 48, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 216, 41, 25, 25, 25, 25, 25, 25, 25, 225, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.088711205533741, "mean_inference_ms": 4.988863281714551, "mean_action_processing_ms": 1.3207345901139738, "mean_env_wait_ms": 0.623605287532451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007706403732299805, "StateBufferConnector_ms": 0.006318330764770508, "ViewRequirementAgentConnector_ms": 0.4769906997680664}}, "episode_reward_max": 51976.0, "episode_reward_min": -8024.0, "episode_reward_mean": 650.7, "episode_len_mean": 44.3, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -3524.0, -3024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, -3024.0, -4524.0, -4024.0, -4024.0, 15401.0, -2524.0, -3524.0, -3524.0, -4524.0, -5524.0, 11401.0, -5524.0, -5024.0, 11901.0, 4053.0, -3524.0, 16401.0, -4024.0, 14401.0, -4024.0, -3524.0, -5024.0, 14901.0, -2524.0, -3024.0, 13401.0, -3524.0, 6401.0, -4524.0, 12401.0, -5024.0, -4024.0, -3524.0, 11401.0, -4024.0, -4024.0, -5024.0, -4024.0, -5024.0, 15401.0, -3524.0, -4524.0, -4524.0, -4524.0, -8024.0, -3524.0, 10401.0, 13901.0, -4524.0, -3524.0, -4024.0, 12401.0, -4524.0, -4024.0, 13901.0, -6024.0, -3524.0, -4024.0, -4524.0, -3524.0, -4024.0, -7524.0, -2524.0, -4024.0, -5524.0, 46385.0, -40.0, -4524.0, -3524.0, -4524.0, -3524.0, -3024.0, -3524.0, -3024.0, 51976.0, -3024.0, -5024.0, 13401.0, -4524.0, 20901.0, -4524.0, 18901.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 13901.0, -2524.0, -4024.0, -5024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 48, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 216, 41, 25, 25, 25, 25, 25, 25, 25, 225, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.088711205533741, "mean_inference_ms": 4.988863281714551, "mean_action_processing_ms": 1.3207345901139738, "mean_env_wait_ms": 0.623605287532451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007706403732299805, "StateBufferConnector_ms": 0.006318330764770508, "ViewRequirementAgentConnector_ms": 0.4769906997680664}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2597.5466296736117, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 284000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 1588.059, "sample_time_ms": 549.026, "synch_weights_time_ms": 35.683}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2935, "training_iteration": 71, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-16", "timestamp": 1715558596, "time_this_iter_s": 1.5509250164031982, "time_total_s": 114.91129279136658, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72eb00>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 114.91129279136658, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 47.7, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.16, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.1, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.065, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.19, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": "checkpoint_000014"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 51976.0, "episode_reward_min": -8024.0, "episode_reward_mean": 353.05, "episode_len_mean": 42.95, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, 12401.0, -5024.0, -4024.0, -3524.0, 11401.0, -4024.0, -4024.0, -5024.0, -4024.0, -5024.0, 15401.0, -3524.0, -4524.0, -4524.0, -4524.0, -8024.0, -3524.0, 10401.0, 13901.0, -4524.0, -3524.0, -4024.0, 12401.0, -4524.0, -4024.0, 13901.0, -6024.0, -3524.0, -4024.0, -4524.0, -3524.0, -4024.0, -7524.0, -2524.0, -4024.0, -5524.0, 46385.0, -40.0, -4524.0, -3524.0, -4524.0, -3524.0, -3024.0, -3524.0, -3024.0, 51976.0, -3024.0, -5024.0, 13401.0, -4524.0, 20901.0, -4524.0, 18901.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 13901.0, -2524.0, -4024.0, -5024.0, -3524.0, -6524.0, 14901.0, -4024.0, -4024.0, -5024.0, 14901.0, 13901.0, -4024.0, -4024.0, 15901.0, -4524.0, 1559.0, -3524.0, -4024.0, -4024.0, -2524.0, -4524.0, -4024.0, 9901.0, -6024.0, -2024.0, 1555.0, -3024.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, 16401.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, 14901.0], "episode_lengths": [25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 216, 41, 25, 25, 25, 25, 25, 25, 25, 225, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 100, 25, 42, 25, 25, 25, 25, 25, 25, 100, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.090348008221699, "mean_inference_ms": 4.991146662325415, "mean_action_processing_ms": 1.3210032365341307, "mean_env_wait_ms": 0.6239507213815448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007828235626220703, "StateBufferConnector_ms": 0.006696224212646484, "ViewRequirementAgentConnector_ms": 0.47615861892700195}}, "episode_reward_max": 51976.0, "episode_reward_min": -8024.0, "episode_reward_mean": 353.05, "episode_len_mean": 42.95, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, 12401.0, -5024.0, -4024.0, -3524.0, 11401.0, -4024.0, -4024.0, -5024.0, -4024.0, -5024.0, 15401.0, -3524.0, -4524.0, -4524.0, -4524.0, -8024.0, -3524.0, 10401.0, 13901.0, -4524.0, -3524.0, -4024.0, 12401.0, -4524.0, -4024.0, 13901.0, -6024.0, -3524.0, -4024.0, -4524.0, -3524.0, -4024.0, -7524.0, -2524.0, -4024.0, -5524.0, 46385.0, -40.0, -4524.0, -3524.0, -4524.0, -3524.0, -3024.0, -3524.0, -3024.0, 51976.0, -3024.0, -5024.0, 13401.0, -4524.0, 20901.0, -4524.0, 18901.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 13901.0, -2524.0, -4024.0, -5024.0, -3524.0, -6524.0, 14901.0, -4024.0, -4024.0, -5024.0, 14901.0, 13901.0, -4024.0, -4024.0, 15901.0, -4524.0, 1559.0, -3524.0, -4024.0, -4024.0, -2524.0, -4524.0, -4024.0, 9901.0, -6024.0, -2024.0, 1555.0, -3024.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, 16401.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, 14901.0], "episode_lengths": [25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 216, 41, 25, 25, 25, 25, 25, 25, 25, 225, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 100, 25, 42, 25, 25, 25, 25, 25, 25, 100, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.090348008221699, "mean_inference_ms": 4.991146662325415, "mean_action_processing_ms": 1.3210032365341307, "mean_env_wait_ms": 0.6239507213815448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007828235626220703, "StateBufferConnector_ms": 0.006696224212646484, "ViewRequirementAgentConnector_ms": 0.47615861892700195}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2609.6395362221456, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 288000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 1590.479, "sample_time_ms": 548.772, "synch_weights_time_ms": 35.765}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2972, "training_iteration": 72, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-18", "timestamp": 1715558598, "time_this_iter_s": 1.5444855690002441, "time_total_s": 116.45577836036682, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72fdf0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 116.45577836036682, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 48.0, "ram_util_percent": 38.2, "gpu_util_percent0": 0.095, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.21500000000000002, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.215, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.14, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 166420.0, "episode_reward_min": -7024.0, "episode_reward_mean": 3874.6, "episode_len_mean": 56.4, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51976.0, -3024.0, -5024.0, 13401.0, -4524.0, 20901.0, -4524.0, 18901.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 13901.0, -2524.0, -4024.0, -5024.0, -3524.0, -6524.0, 14901.0, -4024.0, -4024.0, -5024.0, 14901.0, 13901.0, -4024.0, -4024.0, 15901.0, -4524.0, 1559.0, -3524.0, -4024.0, -4024.0, -2524.0, -4524.0, -4024.0, 9901.0, -6024.0, -2024.0, 1555.0, -3024.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, 16401.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, 14901.0, -4524.0, 12901.0, -4524.0, -4024.0, 14901.0, -4524.0, -4024.0, -3024.0, -3524.0, -4024.0, -3524.0, -3524.0, -4524.0, -3524.0, 12401.0, -3024.0, 12901.0, -3524.0, -4024.0, 13901.0, -5524.0, -5024.0, -3524.0, -3524.0, -7024.0, -5024.0, 12901.0, -5024.0, 166420.0, 164820.0, 961.0, 12401.0, -4024.0, -5024.0, 16901.0, -5524.0, 23901.0, -3524.0, -5024.0, -5024.0, -5024.0, 5901.0, -4024.0, -4024.0, -4024.0, -4524.0], "episode_lengths": [225, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 100, 25, 42, 25, 25, 25, 25, 25, 25, 100, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 681, 681, 40, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.088076650240791, "mean_inference_ms": 4.989045974751365, "mean_action_processing_ms": 1.319453386213948, "mean_env_wait_ms": 0.6229029443974379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076847076416015625, "StateBufferConnector_ms": 0.006851911544799805, "ViewRequirementAgentConnector_ms": 0.4787411689758301}}, "episode_reward_max": 166420.0, "episode_reward_min": -7024.0, "episode_reward_mean": 3874.6, "episode_len_mean": 56.4, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51976.0, -3024.0, -5024.0, 13401.0, -4524.0, 20901.0, -4524.0, 18901.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 13901.0, -2524.0, -4024.0, -5024.0, -3524.0, -6524.0, 14901.0, -4024.0, -4024.0, -5024.0, 14901.0, 13901.0, -4024.0, -4024.0, 15901.0, -4524.0, 1559.0, -3524.0, -4024.0, -4024.0, -2524.0, -4524.0, -4024.0, 9901.0, -6024.0, -2024.0, 1555.0, -3024.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, 16401.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, 14901.0, -4524.0, 12901.0, -4524.0, -4024.0, 14901.0, -4524.0, -4024.0, -3024.0, -3524.0, -4024.0, -3524.0, -3524.0, -4524.0, -3524.0, 12401.0, -3024.0, 12901.0, -3524.0, -4024.0, 13901.0, -5524.0, -5024.0, -3524.0, -3524.0, -7024.0, -5024.0, 12901.0, -5024.0, 166420.0, 164820.0, 961.0, 12401.0, -4024.0, -5024.0, 16901.0, -5524.0, 23901.0, -3524.0, -5024.0, -5024.0, -5024.0, 5901.0, -4024.0, -4024.0, -4024.0, -4524.0], "episode_lengths": [225, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 25, 100, 25, 42, 25, 25, 25, 25, 25, 25, 100, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 681, 681, 40, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.088076650240791, "mean_inference_ms": 4.989045974751365, "mean_action_processing_ms": 1.319453386213948, "mean_env_wait_ms": 0.6229029443974379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076847076416015625, "StateBufferConnector_ms": 0.006851911544799805, "ViewRequirementAgentConnector_ms": 0.4787411689758301}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2497.553911382265, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 292000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 1586.455, "sample_time_ms": 552.917, "synch_weights_time_ms": 34.992}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3018, "training_iteration": 73, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-19", "timestamp": 1715558599, "time_this_iter_s": 1.6103012561798096, "time_total_s": 118.06607961654663, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118448cd0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 118.06607961654663, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 40.6, "ram_util_percent": 38.2, "gpu_util_percent0": 0.14666666666666664, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.13333333333333333, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.17666666666666667, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.15333333333333332, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 166420.0, "episode_reward_min": -7024.0, "episode_reward_mean": 2542.69, "episode_len_mean": 51.31, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2524.0, -4524.0, -4024.0, 9901.0, -6024.0, -2024.0, 1555.0, -3024.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, 16401.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, 14901.0, -4524.0, 12901.0, -4524.0, -4024.0, 14901.0, -4524.0, -4024.0, -3024.0, -3524.0, -4024.0, -3524.0, -3524.0, -4524.0, -3524.0, 12401.0, -3024.0, 12901.0, -3524.0, -4024.0, 13901.0, -5524.0, -5024.0, -3524.0, -3524.0, -7024.0, -5024.0, 12901.0, -5024.0, 166420.0, 164820.0, 961.0, 12401.0, -4024.0, -5024.0, 16901.0, -5524.0, 23901.0, -3524.0, -5024.0, -5024.0, -5024.0, 5901.0, -4024.0, -4024.0, -4024.0, -4524.0, -3024.0, -3524.0, -5024.0, 15401.0, -4524.0, -3524.0, -3024.0, -5024.0, -3024.0, -4524.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 16401.0, -6024.0, -3524.0, -4524.0, 20901.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -3524.0, -3524.0, -1432.0, 13401.0, -2524.0, -4024.0, -4024.0, -6524.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 681, 681, 40, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 33, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0887578011358485, "mean_inference_ms": 4.989758959654271, "mean_action_processing_ms": 1.3201731409850463, "mean_env_wait_ms": 0.6231486686765284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007723569869995117, "StateBufferConnector_ms": 0.006989717483520508, "ViewRequirementAgentConnector_ms": 0.4851071834564209}}, "episode_reward_max": 166420.0, "episode_reward_min": -7024.0, "episode_reward_mean": 2542.69, "episode_len_mean": 51.31, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2524.0, -4524.0, -4024.0, 9901.0, -6024.0, -2024.0, 1555.0, -3024.0, -4524.0, -4024.0, -3024.0, -4524.0, -4024.0, 16401.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, 14901.0, -4524.0, 12901.0, -4524.0, -4024.0, 14901.0, -4524.0, -4024.0, -3024.0, -3524.0, -4024.0, -3524.0, -3524.0, -4524.0, -3524.0, 12401.0, -3024.0, 12901.0, -3524.0, -4024.0, 13901.0, -5524.0, -5024.0, -3524.0, -3524.0, -7024.0, -5024.0, 12901.0, -5024.0, 166420.0, 164820.0, 961.0, 12401.0, -4024.0, -5024.0, 16901.0, -5524.0, 23901.0, -3524.0, -5024.0, -5024.0, -5024.0, 5901.0, -4024.0, -4024.0, -4024.0, -4524.0, -3024.0, -3524.0, -5024.0, 15401.0, -4524.0, -3524.0, -3024.0, -5024.0, -3024.0, -4524.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 16401.0, -6024.0, -3524.0, -4524.0, 20901.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -3524.0, -3524.0, -1432.0, 13401.0, -2524.0, -4024.0, -4024.0, -6524.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 46, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 681, 681, 40, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 33, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0887578011358485, "mean_inference_ms": 4.989758959654271, "mean_action_processing_ms": 1.3201731409850463, "mean_env_wait_ms": 0.6231486686765284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007723569869995117, "StateBufferConnector_ms": 0.006989717483520508, "ViewRequirementAgentConnector_ms": 0.4851071834564209}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2498.985047095364, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 296000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 1589.197, "sample_time_ms": 552.164, "synch_weights_time_ms": 33.881}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3051, "training_iteration": 74, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-21", "timestamp": 1715558601, "time_this_iter_s": 1.6101014614105225, "time_total_s": 119.67618107795715, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118448ca0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 119.67618107795715, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 46.85, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.24, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.22, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.1, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.14, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34895833333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 678933.0, "episode_reward_min": -7524.0, "episode_reward_mean": 20170.98, "episode_len_mean": 125.02, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12401.0, -4024.0, -5024.0, 16901.0, -5524.0, 23901.0, -3524.0, -5024.0, -5024.0, -5024.0, 5901.0, -4024.0, -4024.0, -4024.0, -4524.0, -3024.0, -3524.0, -5024.0, 15401.0, -4524.0, -3524.0, -3024.0, -5024.0, -3024.0, -4524.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 16401.0, -6024.0, -3524.0, -4524.0, 20901.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -3524.0, -3524.0, -1432.0, 13401.0, -2524.0, -4024.0, -4024.0, -6524.0, 454588.0, 248453.0, 244453.0, 2453.0, 13901.0, -3024.0, -4024.0, 13401.0, -4524.0, -4524.0, -3524.0, 14901.0, -3524.0, 10401.0, -6524.0, -3524.0, 11901.0, -4024.0, -3524.0, -3024.0, 14401.0, -4524.0, 11901.0, -4024.0, -4524.0, 16901.0, -4024.0, -4524.0, 11401.0, -3524.0, -4524.0, -4024.0, -4024.0, 14401.0, -5024.0, -3524.0, 678933.0, 372554.0, 2454.0, -5024.0, -4024.0, 13401.0, -4524.0, 8401.0, -4524.0, -7524.0, -4524.0, 14901.0, -3024.0, -4524.0, 12401.0, -2524.0], "episode_lengths": [100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 33, 100, 25, 25, 25, 25, 2013, 1048, 1048, 48, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 2768, 1547, 47, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083363502690149, "mean_inference_ms": 4.987922320823134, "mean_action_processing_ms": 1.319778845364236, "mean_env_wait_ms": 0.6230358254798513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077893733978271484, "StateBufferConnector_ms": 0.009361743927001953, "ViewRequirementAgentConnector_ms": 0.49427294731140137}}, "episode_reward_max": 678933.0, "episode_reward_min": -7524.0, "episode_reward_mean": 20170.98, "episode_len_mean": 125.02, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12401.0, -4024.0, -5024.0, 16901.0, -5524.0, 23901.0, -3524.0, -5024.0, -5024.0, -5024.0, 5901.0, -4024.0, -4024.0, -4024.0, -4524.0, -3024.0, -3524.0, -5024.0, 15401.0, -4524.0, -3524.0, -3024.0, -5024.0, -3024.0, -4524.0, -4024.0, -4024.0, -4024.0, -4024.0, -3524.0, 16401.0, -6024.0, -3524.0, -4524.0, 20901.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -3524.0, -3524.0, -1432.0, 13401.0, -2524.0, -4024.0, -4024.0, -6524.0, 454588.0, 248453.0, 244453.0, 2453.0, 13901.0, -3024.0, -4024.0, 13401.0, -4524.0, -4524.0, -3524.0, 14901.0, -3524.0, 10401.0, -6524.0, -3524.0, 11901.0, -4024.0, -3524.0, -3024.0, 14401.0, -4524.0, 11901.0, -4024.0, -4524.0, 16901.0, -4024.0, -4524.0, 11401.0, -3524.0, -4524.0, -4024.0, -4024.0, 14401.0, -5024.0, -3524.0, 678933.0, 372554.0, 2454.0, -5024.0, -4024.0, 13401.0, -4524.0, 8401.0, -4524.0, -7524.0, -4524.0, 14901.0, -3024.0, -4524.0, 12401.0, -2524.0], "episode_lengths": [100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 33, 100, 25, 25, 25, 25, 2013, 1048, 1048, 48, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 2768, 1547, 47, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083363502690149, "mean_inference_ms": 4.987922320823134, "mean_action_processing_ms": 1.319778845364236, "mean_env_wait_ms": 0.6230358254798513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077893733978271484, "StateBufferConnector_ms": 0.009361743927001953, "ViewRequirementAgentConnector_ms": 0.49427294731140137}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2557.6716508378754, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 300000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 1580.669, "sample_time_ms": 548.123, "synch_weights_time_ms": 32.729}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3103, "training_iteration": 75, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-23", "timestamp": 1715558603, "time_this_iter_s": 1.5751972198486328, "time_total_s": 121.25137829780579, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118449780>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 121.25137829780579, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 48.55, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.25, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.185, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.2, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.12, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 678933.0, "episode_reward_min": -7524.0, "episode_reward_mean": 25012.72, "episode_len_mean": 145.28, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -4024.0, -3524.0, -3524.0, -1432.0, 13401.0, -2524.0, -4024.0, -4024.0, -6524.0, 454588.0, 248453.0, 244453.0, 2453.0, 13901.0, -3024.0, -4024.0, 13401.0, -4524.0, -4524.0, -3524.0, 14901.0, -3524.0, 10401.0, -6524.0, -3524.0, 11901.0, -4024.0, -3524.0, -3024.0, 14401.0, -4524.0, 11901.0, -4024.0, -4524.0, 16901.0, -4024.0, -4524.0, 11401.0, -3524.0, -4524.0, -4024.0, -4024.0, 14401.0, -5024.0, -3524.0, 678933.0, 372554.0, 2454.0, -5024.0, -4024.0, 13401.0, -4524.0, 8401.0, -4524.0, -7524.0, -4524.0, 14901.0, -3024.0, -4524.0, 12401.0, -2524.0, -5024.0, -4024.0, 203190.0, 110530.0, 109030.0, -36.0, -4524.0, -3524.0, -3524.0, -5024.0, -4024.0, -5524.0, -6024.0, -4024.0, -4524.0, -7024.0, -3524.0, -4024.0, 104633.0, -42.0, 14901.0, -4024.0, -4024.0, 14901.0, -3524.0, -4524.0, 12401.0, -4524.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, 14901.0, -4024.0, -4024.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 33, 100, 25, 25, 25, 25, 2013, 1048, 1048, 48, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 2768, 1547, 47, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 911, 471, 471, 37, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 468, 43, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.079231137842234, "mean_inference_ms": 4.983636019220707, "mean_action_processing_ms": 1.319449603969793, "mean_env_wait_ms": 0.6225290371246195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007819890975952148, "StateBufferConnector_ms": 0.010468482971191406, "ViewRequirementAgentConnector_ms": 0.4994809627532959}}, "episode_reward_max": 678933.0, "episode_reward_min": -7524.0, "episode_reward_mean": 25012.72, "episode_len_mean": 145.28, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -4024.0, -3524.0, -3524.0, -1432.0, 13401.0, -2524.0, -4024.0, -4024.0, -6524.0, 454588.0, 248453.0, 244453.0, 2453.0, 13901.0, -3024.0, -4024.0, 13401.0, -4524.0, -4524.0, -3524.0, 14901.0, -3524.0, 10401.0, -6524.0, -3524.0, 11901.0, -4024.0, -3524.0, -3024.0, 14401.0, -4524.0, 11901.0, -4024.0, -4524.0, 16901.0, -4024.0, -4524.0, 11401.0, -3524.0, -4524.0, -4024.0, -4024.0, 14401.0, -5024.0, -3524.0, 678933.0, 372554.0, 2454.0, -5024.0, -4024.0, 13401.0, -4524.0, 8401.0, -4524.0, -7524.0, -4524.0, 14901.0, -3024.0, -4524.0, 12401.0, -2524.0, -5024.0, -4024.0, 203190.0, 110530.0, 109030.0, -36.0, -4524.0, -3524.0, -3524.0, -5024.0, -4024.0, -5524.0, -6024.0, -4024.0, -4524.0, -7024.0, -3524.0, -4024.0, 104633.0, -42.0, 14901.0, -4024.0, -4024.0, 14901.0, -3524.0, -4524.0, 12401.0, -4524.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, 14901.0, -4024.0, -4024.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 33, 100, 25, 25, 25, 25, 2013, 1048, 1048, 48, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 2768, 1547, 47, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 911, 471, 471, 37, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 468, 43, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.079231137842234, "mean_inference_ms": 4.983636019220707, "mean_action_processing_ms": 1.319449603969793, "mean_env_wait_ms": 0.6225290371246195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007819890975952148, "StateBufferConnector_ms": 0.010468482971191406, "ViewRequirementAgentConnector_ms": 0.4994809627532959}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2407.3546989231113, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 304000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 1592.652, "sample_time_ms": 551.72, "synch_weights_time_ms": 33.455}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3141, "training_iteration": 76, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-24", "timestamp": 1715558604, "time_this_iter_s": 1.6711740493774414, "time_total_s": 122.92255234718323, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844a200>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 122.92255234718323, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 49.95, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.185, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.09, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.16499999999999998, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.205, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": "checkpoint_000015"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.36979166666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 678933.0, "episode_reward_min": -7524.0, "episode_reward_mean": 17252.43, "episode_len_mean": 111.57, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, 14401.0, -5024.0, -3524.0, 678933.0, 372554.0, 2454.0, -5024.0, -4024.0, 13401.0, -4524.0, 8401.0, -4524.0, -7524.0, -4524.0, 14901.0, -3024.0, -4524.0, 12401.0, -2524.0, -5024.0, -4024.0, 203190.0, 110530.0, 109030.0, -36.0, -4524.0, -3524.0, -3524.0, -5024.0, -4024.0, -5524.0, -6024.0, -4024.0, -4524.0, -7024.0, -3524.0, -4024.0, 104633.0, -42.0, 14901.0, -4024.0, -4024.0, 14901.0, -3524.0, -4524.0, 12401.0, -4524.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, 14901.0, -4024.0, -4024.0, -3024.0, -2524.0, -5024.0, -3524.0, 11901.0, -3524.0, -5024.0, -4024.0, 14901.0, 12901.0, -4524.0, 108630.0, 50246.0, -1529.0, 14901.0, -3024.0, -3524.0, -4024.0, -4024.0, -4524.0, -3524.0, -6024.0, -4524.0, 16901.0, -3024.0, -4524.0, -5024.0, -6024.0, 31948.0, 8031.0, 6931.0, 1456.0, -4024.0, -3524.0, -3524.0, 19401.0, -4024.0, -4024.0, -4024.0, -4524.0, -4524.0, 15401.0], "episode_lengths": [25, 25, 100, 25, 25, 2768, 1547, 47, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 911, 471, 471, 37, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 468, 43, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 471, 255, 30, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 153, 70, 70, 45, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.088156033685232, "mean_inference_ms": 4.99380034465517, "mean_action_processing_ms": 1.3227174433564386, "mean_env_wait_ms": 0.6234252904313076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007781028747558594, "StateBufferConnector_ms": 0.009596586227416992, "ViewRequirementAgentConnector_ms": 0.4880409240722656}}, "episode_reward_max": 678933.0, "episode_reward_min": -7524.0, "episode_reward_mean": 17252.43, "episode_len_mean": 111.57, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, 14401.0, -5024.0, -3524.0, 678933.0, 372554.0, 2454.0, -5024.0, -4024.0, 13401.0, -4524.0, 8401.0, -4524.0, -7524.0, -4524.0, 14901.0, -3024.0, -4524.0, 12401.0, -2524.0, -5024.0, -4024.0, 203190.0, 110530.0, 109030.0, -36.0, -4524.0, -3524.0, -3524.0, -5024.0, -4024.0, -5524.0, -6024.0, -4024.0, -4524.0, -7024.0, -3524.0, -4024.0, 104633.0, -42.0, 14901.0, -4024.0, -4024.0, 14901.0, -3524.0, -4524.0, 12401.0, -4524.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, 14901.0, -4024.0, -4024.0, -3024.0, -2524.0, -5024.0, -3524.0, 11901.0, -3524.0, -5024.0, -4024.0, 14901.0, 12901.0, -4524.0, 108630.0, 50246.0, -1529.0, 14901.0, -3024.0, -3524.0, -4024.0, -4024.0, -4524.0, -3524.0, -6024.0, -4524.0, 16901.0, -3024.0, -4524.0, -5024.0, -6024.0, 31948.0, 8031.0, 6931.0, 1456.0, -4024.0, -3524.0, -3524.0, 19401.0, -4024.0, -4024.0, -4024.0, -4524.0, -4524.0, 15401.0], "episode_lengths": [25, 25, 100, 25, 25, 2768, 1547, 47, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 911, 471, 471, 37, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 468, 43, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 471, 255, 30, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 153, 70, 70, 45, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.088156033685232, "mean_inference_ms": 4.99380034465517, "mean_action_processing_ms": 1.3227174433564386, "mean_env_wait_ms": 0.6234252904313076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007781028747558594, "StateBufferConnector_ms": 0.009596586227416992, "ViewRequirementAgentConnector_ms": 0.4880409240722656}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2518.9059648072366, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 308000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 1592.4, "sample_time_ms": 551.488, "synch_weights_time_ms": 32.88}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3182, "training_iteration": 77, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-26", "timestamp": 1715558606, "time_this_iter_s": 1.5982434749603271, "time_total_s": 124.52079582214355, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844a530>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 124.52079582214355, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 47.25, "ram_util_percent": 38.2, "gpu_util_percent0": 0.2, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.055, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.155, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.23500000000000001, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.44270833333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 210684.0, "episode_reward_min": -6024.0, "episode_reward_mean": 6297.38, "episode_len_mean": 67.62, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12401.0, -4524.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, 14901.0, -4024.0, -4024.0, -3024.0, -2524.0, -5024.0, -3524.0, 11901.0, -3524.0, -5024.0, -4024.0, 14901.0, 12901.0, -4524.0, 108630.0, 50246.0, -1529.0, 14901.0, -3024.0, -3524.0, -4024.0, -4024.0, -4524.0, -3524.0, -6024.0, -4524.0, 16901.0, -3024.0, -4524.0, -5024.0, -6024.0, 31948.0, 8031.0, 6931.0, 1456.0, -4024.0, -3524.0, -3524.0, 19401.0, -4024.0, -4024.0, -4024.0, -4524.0, -4524.0, 15401.0, -4024.0, 12901.0, -4024.0, 13901.0, -3524.0, -4024.0, -5524.0, -3524.0, -3524.0, -3524.0, -3524.0, -6024.0, -3524.0, 17401.0, -3524.0, 13401.0, -4524.0, -5524.0, 17401.0, -3024.0, -5524.0, -5024.0, -5024.0, -4024.0, -4024.0, -3524.0, 14401.0, -5024.0, -5024.0, 15401.0, -3524.0, -3524.0, -4024.0, -3599.0, 210684.0, 126934.0, 128934.0, 1459.0, -5024.0, -3524.0, -4524.0, -3024.0, 15401.0, -5524.0, -4024.0, -3024.0, -4524.0], "episode_lengths": [100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 471, 255, 30, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 153, 70, 70, 45, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 917, 567, 567, 42, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.087664767831357, "mean_inference_ms": 4.993898960693665, "mean_action_processing_ms": 1.3221764129694915, "mean_env_wait_ms": 0.6231659432756921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007946968078613281, "StateBufferConnector_ms": 0.008960485458374023, "ViewRequirementAgentConnector_ms": 0.47591352462768555}}, "episode_reward_max": 210684.0, "episode_reward_min": -6024.0, "episode_reward_mean": 6297.38, "episode_len_mean": 67.62, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12401.0, -4524.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, 14901.0, -4024.0, -4024.0, -3024.0, -2524.0, -5024.0, -3524.0, 11901.0, -3524.0, -5024.0, -4024.0, 14901.0, 12901.0, -4524.0, 108630.0, 50246.0, -1529.0, 14901.0, -3024.0, -3524.0, -4024.0, -4024.0, -4524.0, -3524.0, -6024.0, -4524.0, 16901.0, -3024.0, -4524.0, -5024.0, -6024.0, 31948.0, 8031.0, 6931.0, 1456.0, -4024.0, -3524.0, -3524.0, 19401.0, -4024.0, -4024.0, -4024.0, -4524.0, -4524.0, 15401.0, -4024.0, 12901.0, -4024.0, 13901.0, -3524.0, -4024.0, -5524.0, -3524.0, -3524.0, -3524.0, -3524.0, -6024.0, -3524.0, 17401.0, -3524.0, 13401.0, -4524.0, -5524.0, 17401.0, -3024.0, -5524.0, -5024.0, -5024.0, -4024.0, -4024.0, -3524.0, 14401.0, -5024.0, -5024.0, 15401.0, -3524.0, -3524.0, -4024.0, -3599.0, 210684.0, 126934.0, 128934.0, 1459.0, -5024.0, -3524.0, -4524.0, -3024.0, 15401.0, -5524.0, -4024.0, -3024.0, -4524.0], "episode_lengths": [100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 100, 25, 471, 255, 30, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 153, 70, 70, 45, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 917, 567, 567, 42, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.087664767831357, "mean_inference_ms": 4.993898960693665, "mean_action_processing_ms": 1.3221764129694915, "mean_env_wait_ms": 0.6231659432756921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007946968078613281, "StateBufferConnector_ms": 0.008960485458374023, "ViewRequirementAgentConnector_ms": 0.47591352462768555}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2548.8158724906593, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 312000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 1588.778, "sample_time_ms": 551.83, "synch_weights_time_ms": 33.306}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3229, "training_iteration": 78, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-28", "timestamp": 1715558608, "time_this_iter_s": 1.5819780826568604, "time_total_s": 126.10277390480042, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72cfd0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 126.10277390480042, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 41.9, "ram_util_percent": 38.13333333333333, "gpu_util_percent0": 0.20666666666666667, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.11666666666666665, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.10333333333333333, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.17666666666666667, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 210684.0, "episode_reward_min": -9024.0, "episode_reward_mean": 4164.69, "episode_len_mean": 59.31, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6024.0, -4524.0, 16901.0, -3024.0, -4524.0, -5024.0, -6024.0, 31948.0, 8031.0, 6931.0, 1456.0, -4024.0, -3524.0, -3524.0, 19401.0, -4024.0, -4024.0, -4024.0, -4524.0, -4524.0, 15401.0, -4024.0, 12901.0, -4024.0, 13901.0, -3524.0, -4024.0, -5524.0, -3524.0, -3524.0, -3524.0, -3524.0, -6024.0, -3524.0, 17401.0, -3524.0, 13401.0, -4524.0, -5524.0, 17401.0, -3024.0, -5524.0, -5024.0, -5024.0, -4024.0, -4024.0, -3524.0, 14401.0, -5024.0, -5024.0, 15401.0, -3524.0, -3524.0, -4024.0, -3599.0, 210684.0, 126934.0, 128934.0, 1459.0, -5024.0, -3524.0, -4524.0, -3024.0, 15401.0, -5524.0, -4024.0, -3024.0, -4524.0, -4024.0, -9024.0, -4024.0, -3524.0, -5024.0, 15401.0, -3524.0, -3524.0, -7024.0, -4024.0, -4524.0, -4024.0, -3524.0, -3524.0, 14901.0, -4024.0, -4024.0, -3024.0, 11401.0, -4024.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -4024.0, -4024.0, -4024.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 153, 70, 70, 45, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 917, 567, 567, 42, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0882127783982405, "mean_inference_ms": 4.9926512551522855, "mean_action_processing_ms": 1.3225427740804887, "mean_env_wait_ms": 0.6237130708616975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007860660552978516, "StateBufferConnector_ms": 0.00815892219543457, "ViewRequirementAgentConnector_ms": 0.47627997398376465}}, "episode_reward_max": 210684.0, "episode_reward_min": -9024.0, "episode_reward_mean": 4164.69, "episode_len_mean": 59.31, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6024.0, -4524.0, 16901.0, -3024.0, -4524.0, -5024.0, -6024.0, 31948.0, 8031.0, 6931.0, 1456.0, -4024.0, -3524.0, -3524.0, 19401.0, -4024.0, -4024.0, -4024.0, -4524.0, -4524.0, 15401.0, -4024.0, 12901.0, -4024.0, 13901.0, -3524.0, -4024.0, -5524.0, -3524.0, -3524.0, -3524.0, -3524.0, -6024.0, -3524.0, 17401.0, -3524.0, 13401.0, -4524.0, -5524.0, 17401.0, -3024.0, -5524.0, -5024.0, -5024.0, -4024.0, -4024.0, -3524.0, 14401.0, -5024.0, -5024.0, 15401.0, -3524.0, -3524.0, -4024.0, -3599.0, 210684.0, 126934.0, 128934.0, 1459.0, -5024.0, -3524.0, -4524.0, -3024.0, 15401.0, -5524.0, -4024.0, -3024.0, -4524.0, -4024.0, -9024.0, -4024.0, -3524.0, -5024.0, 15401.0, -3524.0, -3524.0, -7024.0, -4024.0, -4524.0, -4024.0, -3524.0, -3524.0, 14901.0, -4024.0, -4024.0, -3024.0, 11401.0, -4024.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -4024.0, -4024.0, -4024.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 153, 70, 70, 45, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 917, 567, 567, 42, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0882127783982405, "mean_inference_ms": 4.9926512551522855, "mean_action_processing_ms": 1.3225427740804887, "mean_env_wait_ms": 0.6237130708616975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007860660552978516, "StateBufferConnector_ms": 0.00815892219543457, "ViewRequirementAgentConnector_ms": 0.47627997398376465}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2577.806199469572, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 316000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 1588.228, "sample_time_ms": 551.971, "synch_weights_time_ms": 33.438}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3261, "training_iteration": 79, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-29", "timestamp": 1715558609, "time_this_iter_s": 1.5636401176452637, "time_total_s": 127.66641402244568, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72cb80>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 127.66641402244568, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 47.150000000000006, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.15000000000000002, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.175, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.13, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 210684.0, "episode_reward_min": -9024.0, "episode_reward_mean": 4861.41, "episode_len_mean": 61.59, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15401.0, -3524.0, -3524.0, -4024.0, -3599.0, 210684.0, 126934.0, 128934.0, 1459.0, -5024.0, -3524.0, -4524.0, -3024.0, 15401.0, -5524.0, -4024.0, -3024.0, -4524.0, -4024.0, -9024.0, -4024.0, -3524.0, -5024.0, 15401.0, -3524.0, -3524.0, -7024.0, -4024.0, -4524.0, -4024.0, -3524.0, -3524.0, 14901.0, -4024.0, -4024.0, -3024.0, 11401.0, -4024.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -4024.0, -4024.0, -4024.0, -2524.0, 17901.0, -4024.0, 16401.0, -4024.0, 1060.0, -4024.0, -4524.0, 16901.0, -3024.0, 14901.0, -4024.0, -4024.0, -4024.0, 18901.0, -4024.0, -4024.0, -4024.0, 16401.0, -4024.0, 13901.0, -3024.0, -4024.0, 11401.0, -5524.0, -2524.0, -4024.0, 16901.0, -5024.0, -5024.0, -5524.0, -5024.0, 18401.0, -4024.0, -4024.0, 11901.0, -2024.0, -4024.0, -8524.0, 16401.0, -4024.0, 14901.0, -4524.0, -4524.0, -4024.0, 15901.0, -3024.0, -3024.0, 16901.0, -4024.0], "episode_lengths": [100, 25, 25, 25, 100, 917, 567, 567, 42, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 41, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.084597143494786, "mean_inference_ms": 4.991181534554789, "mean_action_processing_ms": 1.3211983200933712, "mean_env_wait_ms": 0.6230915916927979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007601022720336914, "StateBufferConnector_ms": 0.007565498352050781, "ViewRequirementAgentConnector_ms": 0.4778764247894287}}, "episode_reward_max": 210684.0, "episode_reward_min": -9024.0, "episode_reward_mean": 4861.41, "episode_len_mean": 61.59, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15401.0, -3524.0, -3524.0, -4024.0, -3599.0, 210684.0, 126934.0, 128934.0, 1459.0, -5024.0, -3524.0, -4524.0, -3024.0, 15401.0, -5524.0, -4024.0, -3024.0, -4524.0, -4024.0, -9024.0, -4024.0, -3524.0, -5024.0, 15401.0, -3524.0, -3524.0, -7024.0, -4024.0, -4524.0, -4024.0, -3524.0, -3524.0, 14901.0, -4024.0, -4024.0, -3024.0, 11401.0, -4024.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -4024.0, -4024.0, -4024.0, -2524.0, 17901.0, -4024.0, 16401.0, -4024.0, 1060.0, -4024.0, -4524.0, 16901.0, -3024.0, 14901.0, -4024.0, -4024.0, -4024.0, 18901.0, -4024.0, -4024.0, -4024.0, 16401.0, -4024.0, 13901.0, -3024.0, -4024.0, 11401.0, -5524.0, -2524.0, -4024.0, 16901.0, -5024.0, -5024.0, -5524.0, -5024.0, 18401.0, -4024.0, -4024.0, 11901.0, -2024.0, -4024.0, -8524.0, 16401.0, -4024.0, 14901.0, -4524.0, -4524.0, -4024.0, 15901.0, -3024.0, -3024.0, 16901.0, -4024.0], "episode_lengths": [100, 25, 25, 25, 100, 917, 567, 567, 42, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 41, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.084597143494786, "mean_inference_ms": 4.991181534554789, "mean_action_processing_ms": 1.3211983200933712, "mean_env_wait_ms": 0.6230915916927979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007601022720336914, "StateBufferConnector_ms": 0.007565498352050781, "ViewRequirementAgentConnector_ms": 0.4778764247894287}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2560.9585619128984, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 320000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 1577.093, "sample_time_ms": 542.11, "synch_weights_time_ms": 34.488}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3311, "training_iteration": 80, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-31", "timestamp": 1715558611, "time_this_iter_s": 1.5749304294586182, "time_total_s": 129.2413444519043, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bca60>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 129.2413444519043, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 47.3, "ram_util_percent": 38.2, "gpu_util_percent0": 0.245, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.15, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.03, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.21, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18901.0, "episode_reward_min": -8524.0, "episode_reward_mean": 56.09, "episode_len_mean": 40.91, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, 11401.0, -4024.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -4024.0, -4024.0, -4024.0, -2524.0, 17901.0, -4024.0, 16401.0, -4024.0, 1060.0, -4024.0, -4524.0, 16901.0, -3024.0, 14901.0, -4024.0, -4024.0, -4024.0, 18901.0, -4024.0, -4024.0, -4024.0, 16401.0, -4024.0, 13901.0, -3024.0, -4024.0, 11401.0, -5524.0, -2524.0, -4024.0, 16901.0, -5024.0, -5024.0, -5524.0, -5024.0, 18401.0, -4024.0, -4024.0, 11901.0, -2024.0, -4024.0, -8524.0, 16401.0, -4024.0, 14901.0, -4524.0, -4524.0, -4024.0, 15901.0, -3024.0, -3024.0, 16901.0, -4024.0, -4024.0, -3524.0, -3024.0, -3524.0, -4024.0, -4524.0, -4524.0, -5024.0, -5024.0, -3524.0, -4024.0, -4024.0, -3524.0, -5524.0, -4524.0, -3524.0, 14901.0, -4524.0, -5524.0, 13401.0, -4024.0, -2524.0, 14901.0, -3524.0, -4524.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -2524.0, 15401.0, -5524.0, -4024.0, -3524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 41, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.082746268038144, "mean_inference_ms": 4.987507764268688, "mean_action_processing_ms": 1.3200699893933716, "mean_env_wait_ms": 0.6225563294323521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007605791091918945, "StateBufferConnector_ms": 0.006322383880615234, "ViewRequirementAgentConnector_ms": 0.4726908206939697}}, "episode_reward_max": 18901.0, "episode_reward_min": -8524.0, "episode_reward_mean": 56.09, "episode_len_mean": 40.91, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, 11401.0, -4024.0, -4024.0, -4524.0, -4024.0, -3524.0, -4024.0, -4524.0, -4024.0, 12901.0, -3524.0, -4024.0, -4024.0, -4024.0, -2524.0, 17901.0, -4024.0, 16401.0, -4024.0, 1060.0, -4024.0, -4524.0, 16901.0, -3024.0, 14901.0, -4024.0, -4024.0, -4024.0, 18901.0, -4024.0, -4024.0, -4024.0, 16401.0, -4024.0, 13901.0, -3024.0, -4024.0, 11401.0, -5524.0, -2524.0, -4024.0, 16901.0, -5024.0, -5024.0, -5524.0, -5024.0, 18401.0, -4024.0, -4024.0, 11901.0, -2024.0, -4024.0, -8524.0, 16401.0, -4024.0, 14901.0, -4524.0, -4524.0, -4024.0, 15901.0, -3024.0, -3024.0, 16901.0, -4024.0, -4024.0, -3524.0, -3024.0, -3524.0, -4024.0, -4524.0, -4524.0, -5024.0, -5024.0, -3524.0, -4024.0, -4024.0, -3524.0, -5524.0, -4524.0, -3524.0, 14901.0, -4524.0, -5524.0, 13401.0, -4024.0, -2524.0, 14901.0, -3524.0, -4524.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -2524.0, 15401.0, -5524.0, -4024.0, -3524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 41, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.082746268038144, "mean_inference_ms": 4.987507764268688, "mean_action_processing_ms": 1.3200699893933716, "mean_env_wait_ms": 0.6225563294323521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007605791091918945, "StateBufferConnector_ms": 0.006322383880615234, "ViewRequirementAgentConnector_ms": 0.4726908206939697}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2546.5808679665593, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 324000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 1580.175, "sample_time_ms": 540.377, "synch_weights_time_ms": 34.605}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3346, "training_iteration": 81, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-33", "timestamp": 1715558613, "time_this_iter_s": 1.5804803371429443, "time_total_s": 130.82182478904724, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bf310>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 130.82182478904724, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 47.35, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.21500000000000002, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.205, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.09000000000000001, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.26, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": "checkpoint_000016"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 48276.0, "episode_reward_min": -8524.0, "episode_reward_mean": 1066.5, "episode_len_mean": 45.5, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5524.0, -2524.0, -4024.0, 16901.0, -5024.0, -5024.0, -5524.0, -5024.0, 18401.0, -4024.0, -4024.0, 11901.0, -2024.0, -4024.0, -8524.0, 16401.0, -4024.0, 14901.0, -4524.0, -4524.0, -4024.0, 15901.0, -3024.0, -3024.0, 16901.0, -4024.0, -4024.0, -3524.0, -3024.0, -3524.0, -4024.0, -4524.0, -4524.0, -5024.0, -5024.0, -3524.0, -4024.0, -4024.0, -3524.0, -5524.0, -4524.0, -3524.0, 14901.0, -4524.0, -5524.0, 13401.0, -4024.0, -2524.0, 14901.0, -3524.0, -4524.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -2524.0, 15401.0, -5524.0, -4024.0, -3524.0, -4524.0, 42376.0, 48276.0, 46276.0, 1451.0, -4524.0, 13901.0, -4524.0, -3524.0, 16401.0, 10901.0, -4024.0, -4524.0, 13901.0, -4524.0, -4024.0, -5524.0, -5024.0, -5024.0, -4024.0, -5524.0, -4524.0, 12401.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, 18401.0, -3024.0, -3524.0, -4524.0, 18901.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, 15901.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 225, 225, 225, 50, 25, 100, 25, 25, 100, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.087828423884294, "mean_inference_ms": 4.990195602302416, "mean_action_processing_ms": 1.3214120383899515, "mean_env_wait_ms": 0.6229220956399005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007999897003173828, "StateBufferConnector_ms": 0.007538557052612305, "ViewRequirementAgentConnector_ms": 0.4885673522949219}}, "episode_reward_max": 48276.0, "episode_reward_min": -8524.0, "episode_reward_mean": 1066.5, "episode_len_mean": 45.5, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5524.0, -2524.0, -4024.0, 16901.0, -5024.0, -5024.0, -5524.0, -5024.0, 18401.0, -4024.0, -4024.0, 11901.0, -2024.0, -4024.0, -8524.0, 16401.0, -4024.0, 14901.0, -4524.0, -4524.0, -4024.0, 15901.0, -3024.0, -3024.0, 16901.0, -4024.0, -4024.0, -3524.0, -3024.0, -3524.0, -4024.0, -4524.0, -4524.0, -5024.0, -5024.0, -3524.0, -4024.0, -4024.0, -3524.0, -5524.0, -4524.0, -3524.0, 14901.0, -4524.0, -5524.0, 13401.0, -4024.0, -2524.0, 14901.0, -3524.0, -4524.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -2524.0, 15401.0, -5524.0, -4024.0, -3524.0, -4524.0, 42376.0, 48276.0, 46276.0, 1451.0, -4524.0, 13901.0, -4524.0, -3524.0, 16401.0, 10901.0, -4024.0, -4524.0, 13901.0, -4524.0, -4024.0, -5524.0, -5024.0, -5024.0, -4024.0, -5524.0, -4524.0, 12401.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, 18401.0, -3024.0, -3524.0, -4524.0, 18901.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, 15901.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 225, 225, 225, 50, 25, 100, 25, 25, 100, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.087828423884294, "mean_inference_ms": 4.990195602302416, "mean_action_processing_ms": 1.3214120383899515, "mean_env_wait_ms": 0.6229220956399005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007999897003173828, "StateBufferConnector_ms": 0.007538557052612305, "ViewRequirementAgentConnector_ms": 0.4885673522949219}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2521.4976815054424, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 328000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 1585.533, "sample_time_ms": 542.148, "synch_weights_time_ms": 34.103}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3385, "training_iteration": 82, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-34", "timestamp": 1715558614, "time_this_iter_s": 1.5978777408599854, "time_total_s": 132.41970252990723, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bff70>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 132.41970252990723, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 46.900000000000006, "ram_util_percent": 38.1, "gpu_util_percent0": 0.17, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.2, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.27, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.18, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 419820.0, "episode_reward_min": -6024.0, "episode_reward_mean": 12083.14, "episode_len_mean": 89.86, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2524.0, 14901.0, -3524.0, -4524.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -2524.0, 15401.0, -5524.0, -4024.0, -3524.0, -4524.0, 42376.0, 48276.0, 46276.0, 1451.0, -4524.0, 13901.0, -4524.0, -3524.0, 16401.0, 10901.0, -4024.0, -4524.0, 13901.0, -4524.0, -4024.0, -5524.0, -5024.0, -5024.0, -4024.0, -5524.0, -4524.0, 12401.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, 18401.0, -3024.0, -3524.0, -4524.0, 18901.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, 15901.0, -4024.0, 11401.0, -4524.0, 16401.0, -4024.0, -3024.0, -3524.0, -4024.0, -2524.0, -3524.0, -4024.0, -3524.0, -2524.0, -4524.0, 15401.0, 388920.0, 419820.0, 293793.0, 960.0, -5524.0, 11901.0, -5524.0, -4524.0, -4024.0, -3024.0, -4024.0, -4524.0, -3524.0, 17901.0, -6024.0, -5524.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -3524.0, -3024.0, 14401.0, -4024.0, -5024.0, -5024.0, -3524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 225, 225, 225, 50, 25, 100, 25, 25, 100, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 1681, 1681, 1208, 41, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.082685785106769, "mean_inference_ms": 4.988700461986707, "mean_action_processing_ms": 1.31963379181907, "mean_env_wait_ms": 0.6219162202171521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008339166641235352, "StateBufferConnector_ms": 0.008661746978759766, "ViewRequirementAgentConnector_ms": 0.4904942512512207}}, "episode_reward_max": 419820.0, "episode_reward_min": -6024.0, "episode_reward_mean": 12083.14, "episode_len_mean": 89.86, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2524.0, 14901.0, -3524.0, -4524.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -2524.0, 15401.0, -5524.0, -4024.0, -3524.0, -4524.0, 42376.0, 48276.0, 46276.0, 1451.0, -4524.0, 13901.0, -4524.0, -3524.0, 16401.0, 10901.0, -4024.0, -4524.0, 13901.0, -4524.0, -4024.0, -5524.0, -5024.0, -5024.0, -4024.0, -5524.0, -4524.0, 12401.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, 18401.0, -3024.0, -3524.0, -4524.0, 18901.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, 15901.0, -4024.0, 11401.0, -4524.0, 16401.0, -4024.0, -3024.0, -3524.0, -4024.0, -2524.0, -3524.0, -4024.0, -3524.0, -2524.0, -4524.0, 15401.0, 388920.0, 419820.0, 293793.0, 960.0, -5524.0, 11901.0, -5524.0, -4524.0, -4024.0, -3024.0, -4024.0, -4524.0, -3524.0, 17901.0, -6024.0, -5524.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -3524.0, -3024.0, 14401.0, -4024.0, -5024.0, -5024.0, -3524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 225, 225, 225, 50, 25, 100, 25, 25, 100, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 1681, 1681, 1208, 41, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.082685785106769, "mean_inference_ms": 4.988700461986707, "mean_action_processing_ms": 1.31963379181907, "mean_env_wait_ms": 0.6219162202171521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008339166641235352, "StateBufferConnector_ms": 0.008661746978759766, "ViewRequirementAgentConnector_ms": 0.4904942512512207}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2415.5693295610795, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 332000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 1590.967, "sample_time_ms": 542.004, "synch_weights_time_ms": 34.113}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3432, "training_iteration": 83, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-36", "timestamp": 1715558616, "time_this_iter_s": 1.66951584815979, "time_total_s": 134.08921837806702, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec5bebf0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 134.08921837806702, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 40.50000000000001, "ram_util_percent": 38.13333333333333, "gpu_util_percent0": 0.25, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.18000000000000002, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.15, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.20000000000000004, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 419820.0, "episode_reward_min": -6024.0, "episode_reward_mean": 10410.68, "episode_len_mean": 82.32, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5024.0, -5024.0, -4024.0, -5524.0, -4524.0, 12401.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, 18401.0, -3024.0, -3524.0, -4524.0, 18901.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, 15901.0, -4024.0, 11401.0, -4524.0, 16401.0, -4024.0, -3024.0, -3524.0, -4024.0, -2524.0, -3524.0, -4024.0, -3524.0, -2524.0, -4524.0, 15401.0, 388920.0, 419820.0, 293793.0, 960.0, -5524.0, 11901.0, -5524.0, -4524.0, -4024.0, -3024.0, -4024.0, -4524.0, -3524.0, 17901.0, -6024.0, -5524.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -3524.0, -3024.0, 14401.0, -4024.0, -5024.0, -5024.0, -3524.0, -2524.0, -3524.0, 2055.0, -4024.0, -4524.0, 18401.0, -5024.0, -4524.0, -4024.0, -4024.0, -3524.0, -4524.0, -4524.0, 15901.0, -4024.0, -4024.0, -5024.0, 15901.0, -4024.0, -3024.0, -2524.0, -4024.0, -3524.0, -5524.0, -3024.0, -3524.0, 20401.0, -3524.0, -3524.0, -4024.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 1681, 1681, 1208, 41, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 46, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083554461252972, "mean_inference_ms": 4.989539112616154, "mean_action_processing_ms": 1.3203485387815288, "mean_env_wait_ms": 0.622561740511168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008329629898071289, "StateBufferConnector_ms": 0.007446765899658203, "ViewRequirementAgentConnector_ms": 0.49399471282958984}}, "episode_reward_max": 419820.0, "episode_reward_min": -6024.0, "episode_reward_mean": 10410.68, "episode_len_mean": 82.32, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5024.0, -5024.0, -4024.0, -5524.0, -4524.0, 12401.0, -4024.0, -4524.0, -3524.0, -4024.0, -4024.0, 18401.0, -3024.0, -3524.0, -4524.0, 18901.0, -4024.0, -4024.0, -3024.0, -3524.0, -5024.0, 15901.0, -4024.0, 11401.0, -4524.0, 16401.0, -4024.0, -3024.0, -3524.0, -4024.0, -2524.0, -3524.0, -4024.0, -3524.0, -2524.0, -4524.0, 15401.0, 388920.0, 419820.0, 293793.0, 960.0, -5524.0, 11901.0, -5524.0, -4524.0, -4024.0, -3024.0, -4024.0, -4524.0, -3524.0, 17901.0, -6024.0, -5524.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -3524.0, -3024.0, 14401.0, -4024.0, -5024.0, -5024.0, -3524.0, -2524.0, -3524.0, 2055.0, -4024.0, -4524.0, 18401.0, -5024.0, -4524.0, -4024.0, -4024.0, -3524.0, -4524.0, -4524.0, 15901.0, -4024.0, -4024.0, -5024.0, 15901.0, -4024.0, -3024.0, -2524.0, -4024.0, -3524.0, -5524.0, -3024.0, -3524.0, 20401.0, -3524.0, -3524.0, -4024.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 1681, 1681, 1208, 41, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 46, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083554461252972, "mean_inference_ms": 4.989539112616154, "mean_action_processing_ms": 1.3203485387815288, "mean_env_wait_ms": 0.622561740511168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008329629898071289, "StateBufferConnector_ms": 0.007446765899658203, "ViewRequirementAgentConnector_ms": 0.49399471282958984}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2646.428904934847, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 336000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 1582.046, "sample_time_ms": 542.341, "synch_weights_time_ms": 34.323}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3463, "training_iteration": 84, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-38", "timestamp": 1715558618, "time_this_iter_s": 1.5242195129394531, "time_total_s": 135.61343789100647, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72e800>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 135.61343789100647, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 46.400000000000006, "ram_util_percent": 38.1, "gpu_util_percent0": 0.22500000000000003, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.02, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.09, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.265, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 33933.0, "episode_reward_min": -6024.0, "episode_reward_mean": 749.86, "episode_len_mean": 43.14, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17901.0, -6024.0, -5524.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -3524.0, -3024.0, 14401.0, -4024.0, -5024.0, -5024.0, -3524.0, -2524.0, -3524.0, 2055.0, -4024.0, -4524.0, 18401.0, -5024.0, -4524.0, -4024.0, -4024.0, -3524.0, -4524.0, -4524.0, 15901.0, -4024.0, -4024.0, -5024.0, 15901.0, -4024.0, -3024.0, -2524.0, -4024.0, -3524.0, -5524.0, -3024.0, -3524.0, 20401.0, -3524.0, -3524.0, -4024.0, -3024.0, -3524.0, 13901.0, -4024.0, -4024.0, 21401.0, -5024.0, -4524.0, -4024.0, 11901.0, -4524.0, 16901.0, -5024.0, -4524.0, -3024.0, 15401.0, -4024.0, -4024.0, 33933.0, -4524.0, -4524.0, -4024.0, 11401.0, -4524.0, 15401.0, -4524.0, -4024.0, -4024.0, 14901.0, -4024.0, -3524.0, -4524.0, -4024.0, 14901.0, -4524.0, -3024.0, 15901.0, -4024.0, -4024.0, -4524.0, 16901.0, -4024.0, 14401.0, -4524.0, -4524.0, -4024.0, 15901.0, -2524.0, -4024.0, 16401.0, -4524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 46, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 168, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081242397501868, "mean_inference_ms": 4.988022089865962, "mean_action_processing_ms": 1.320079571039285, "mean_env_wait_ms": 0.6222090395572557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007921457290649414, "StateBufferConnector_ms": 0.005973100662231445, "ViewRequirementAgentConnector_ms": 0.4723353385925293}}, "episode_reward_max": 33933.0, "episode_reward_min": -6024.0, "episode_reward_mean": 749.86, "episode_len_mean": 43.14, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17901.0, -6024.0, -5524.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -3524.0, -3024.0, 14401.0, -4024.0, -5024.0, -5024.0, -3524.0, -2524.0, -3524.0, 2055.0, -4024.0, -4524.0, 18401.0, -5024.0, -4524.0, -4024.0, -4024.0, -3524.0, -4524.0, -4524.0, 15901.0, -4024.0, -4024.0, -5024.0, 15901.0, -4024.0, -3024.0, -2524.0, -4024.0, -3524.0, -5524.0, -3024.0, -3524.0, 20401.0, -3524.0, -3524.0, -4024.0, -3024.0, -3524.0, 13901.0, -4024.0, -4024.0, 21401.0, -5024.0, -4524.0, -4024.0, 11901.0, -4524.0, 16901.0, -5024.0, -4524.0, -3024.0, 15401.0, -4024.0, -4024.0, 33933.0, -4524.0, -4524.0, -4024.0, 11401.0, -4524.0, 15401.0, -4524.0, -4024.0, -4024.0, 14901.0, -4024.0, -3524.0, -4524.0, -4024.0, 14901.0, -4524.0, -3024.0, 15901.0, -4024.0, -4024.0, -4524.0, 16901.0, -4024.0, 14401.0, -4524.0, -4524.0, -4024.0, 15901.0, -2524.0, -4024.0, 16401.0, -4524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 46, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 168, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081242397501868, "mean_inference_ms": 4.988022089865962, "mean_action_processing_ms": 1.320079571039285, "mean_env_wait_ms": 0.6222090395572557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007921457290649414, "StateBufferConnector_ms": 0.005973100662231445, "ViewRequirementAgentConnector_ms": 0.4723353385925293}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2623.248401867037, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 340000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 1578.137, "sample_time_ms": 540.779, "synch_weights_time_ms": 33.572}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3513, "training_iteration": 85, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-39", "timestamp": 1715558619, "time_this_iter_s": 1.532170295715332, "time_total_s": 137.1456081867218, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72fee0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 137.1456081867218, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 46.25, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.19, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.18, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.135, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.09, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 33933.0, "episode_reward_min": -5524.0, "episode_reward_mean": 455.57, "episode_len_mean": 41.43, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15901.0, -4024.0, -3024.0, -2524.0, -4024.0, -3524.0, -5524.0, -3024.0, -3524.0, 20401.0, -3524.0, -3524.0, -4024.0, -3024.0, -3524.0, 13901.0, -4024.0, -4024.0, 21401.0, -5024.0, -4524.0, -4024.0, 11901.0, -4524.0, 16901.0, -5024.0, -4524.0, -3024.0, 15401.0, -4024.0, -4024.0, 33933.0, -4524.0, -4524.0, -4024.0, 11401.0, -4524.0, 15401.0, -4524.0, -4024.0, -4024.0, 14901.0, -4024.0, -3524.0, -4524.0, -4024.0, 14901.0, -4524.0, -3024.0, 15901.0, -4024.0, -4024.0, -4524.0, 16901.0, -4024.0, 14401.0, -4524.0, -4524.0, -4024.0, 15901.0, -2524.0, -4024.0, 16401.0, -4524.0, -3524.0, -3524.0, -4024.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -4024.0, -5024.0, -3524.0, -4524.0, -5524.0, -4024.0, 18901.0, -3524.0, -2024.0, 15901.0, -3024.0, -3024.0, 16401.0, -3024.0, -3524.0, -2524.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, 16901.0, -2524.0, -4524.0, -3524.0], "episode_lengths": [100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 168, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.078046781814957, "mean_inference_ms": 4.984576074346523, "mean_action_processing_ms": 1.3186180792402349, "mean_env_wait_ms": 0.6216651784212484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007835149765014648, "StateBufferConnector_ms": 0.006041049957275391, "ViewRequirementAgentConnector_ms": 0.4692544937133789}}, "episode_reward_max": 33933.0, "episode_reward_min": -5524.0, "episode_reward_mean": 455.57, "episode_len_mean": 41.43, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15901.0, -4024.0, -3024.0, -2524.0, -4024.0, -3524.0, -5524.0, -3024.0, -3524.0, 20401.0, -3524.0, -3524.0, -4024.0, -3024.0, -3524.0, 13901.0, -4024.0, -4024.0, 21401.0, -5024.0, -4524.0, -4024.0, 11901.0, -4524.0, 16901.0, -5024.0, -4524.0, -3024.0, 15401.0, -4024.0, -4024.0, 33933.0, -4524.0, -4524.0, -4024.0, 11401.0, -4524.0, 15401.0, -4524.0, -4024.0, -4024.0, 14901.0, -4024.0, -3524.0, -4524.0, -4024.0, 14901.0, -4524.0, -3024.0, 15901.0, -4024.0, -4024.0, -4524.0, 16901.0, -4024.0, 14401.0, -4524.0, -4524.0, -4024.0, 15901.0, -2524.0, -4024.0, 16401.0, -4524.0, -3524.0, -3524.0, -4024.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -4024.0, -5024.0, -3524.0, -4524.0, -5524.0, -4024.0, 18901.0, -3524.0, -2024.0, 15901.0, -3024.0, -3024.0, 16401.0, -3024.0, -3524.0, -2524.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, 16901.0, -2524.0, -4524.0, -3524.0], "episode_lengths": [100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 168, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.078046781814957, "mean_inference_ms": 4.984576074346523, "mean_action_processing_ms": 1.3186180792402349, "mean_env_wait_ms": 0.6216651784212484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007835149765014648, "StateBufferConnector_ms": 0.006041049957275391, "ViewRequirementAgentConnector_ms": 0.4692544937133789}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2488.4528050688614, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 344000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 1572.722, "sample_time_ms": 537.387, "synch_weights_time_ms": 32.855}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3549, "training_iteration": 86, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-41", "timestamp": 1715558621, "time_this_iter_s": 1.6184148788452148, "time_total_s": 138.76402306556702, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118449630>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 138.76402306556702, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 49.05, "ram_util_percent": 38.2, "gpu_util_percent0": 0.26, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.18, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.13, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.21000000000000002, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": "checkpoint_000017"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 87712.0, "episode_reward_min": -6524.0, "episode_reward_mean": 873.22, "episode_len_mean": 43.78, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15401.0, -4524.0, -4024.0, -4024.0, 14901.0, -4024.0, -3524.0, -4524.0, -4024.0, 14901.0, -4524.0, -3024.0, 15901.0, -4024.0, -4024.0, -4524.0, 16901.0, -4024.0, 14401.0, -4524.0, -4524.0, -4024.0, 15901.0, -2524.0, -4024.0, 16401.0, -4524.0, -3524.0, -3524.0, -4024.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -4024.0, -5024.0, -3524.0, -4524.0, -5524.0, -4024.0, 18901.0, -3524.0, -2024.0, 15901.0, -3024.0, -3024.0, 16401.0, -3024.0, -3524.0, -2524.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, 16901.0, -2524.0, -4524.0, -3524.0, -3524.0, -3524.0, -3024.0, 10401.0, -3524.0, -4024.0, 17901.0, 15901.0, -4524.0, 87712.0, -38.0, -3524.0, -3524.0, 13901.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -4024.0, -4024.0, -2024.0, -5024.0, -5024.0, 7401.0, -5024.0, -4024.0, -3524.0, 14401.0, -4024.0, -4524.0, -6524.0, -3024.0, -3524.0, 18401.0], "episode_lengths": [100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 389, 39, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.086332033867987, "mean_inference_ms": 4.988944234417068, "mean_action_processing_ms": 1.3208589658372338, "mean_env_wait_ms": 0.6225251046009427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00786447525024414, "StateBufferConnector_ms": 0.006838321685791016, "ViewRequirementAgentConnector_ms": 0.48201966285705566}}, "episode_reward_max": 87712.0, "episode_reward_min": -6524.0, "episode_reward_mean": 873.22, "episode_len_mean": 43.78, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15401.0, -4524.0, -4024.0, -4024.0, 14901.0, -4024.0, -3524.0, -4524.0, -4024.0, 14901.0, -4524.0, -3024.0, 15901.0, -4024.0, -4024.0, -4524.0, 16901.0, -4024.0, 14401.0, -4524.0, -4524.0, -4024.0, 15901.0, -2524.0, -4024.0, 16401.0, -4524.0, -3524.0, -3524.0, -4024.0, -5024.0, -4024.0, -4024.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -4024.0, -5024.0, -3524.0, -4524.0, -5524.0, -4024.0, 18901.0, -3524.0, -2024.0, 15901.0, -3024.0, -3024.0, 16401.0, -3024.0, -3524.0, -2524.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, 16901.0, -2524.0, -4524.0, -3524.0, -3524.0, -3524.0, -3024.0, 10401.0, -3524.0, -4024.0, 17901.0, 15901.0, -4524.0, 87712.0, -38.0, -3524.0, -3524.0, 13901.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -4024.0, -4024.0, -2024.0, -5024.0, -5024.0, 7401.0, -5024.0, -4024.0, -3524.0, 14401.0, -4024.0, -4524.0, -6524.0, -3024.0, -3524.0, 18401.0], "episode_lengths": [100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 389, 39, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.086332033867987, "mean_inference_ms": 4.988944234417068, "mean_action_processing_ms": 1.3208589658372338, "mean_env_wait_ms": 0.6225251046009427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00786447525024414, "StateBufferConnector_ms": 0.006838321685791016, "ViewRequirementAgentConnector_ms": 0.48201966285705566}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2605.9480460456407, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 348000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 1567.417, "sample_time_ms": 538.772, "synch_weights_time_ms": 33.392}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3586, "training_iteration": 87, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-43", "timestamp": 1715558623, "time_this_iter_s": 1.545947790145874, "time_total_s": 140.3099708557129, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118449b10>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 140.3099708557129, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 47.400000000000006, "ram_util_percent": 38.150000000000006, "gpu_util_percent0": 0.34, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.16999999999999998, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.13, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.19, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 87712.0, "episode_reward_min": -6524.0, "episode_reward_mean": 543.97, "episode_len_mean": 43.03, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18901.0, -3524.0, -2024.0, 15901.0, -3024.0, -3024.0, 16401.0, -3024.0, -3524.0, -2524.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, 16901.0, -2524.0, -4524.0, -3524.0, -3524.0, -3524.0, -3024.0, 10401.0, -3524.0, -4024.0, 17901.0, 15901.0, -4524.0, 87712.0, -38.0, -3524.0, -3524.0, 13901.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -4024.0, -4024.0, -2024.0, -5024.0, -5024.0, 7401.0, -5024.0, -4024.0, -3524.0, 14401.0, -4024.0, -4524.0, -6524.0, -3024.0, -3524.0, 18401.0, -4024.0, 8901.0, -6024.0, -3024.0, 12901.0, -4024.0, -3524.0, -4024.0, -3524.0, -3524.0, -3524.0, -3524.0, -3024.0, -4024.0, -4024.0, -4524.0, -5024.0, 18401.0, -5024.0, -3524.0, -2524.0, -4524.0, -4524.0, -4024.0, -4024.0, 12901.0, -4024.0, -3524.0, 16401.0, -4524.0, -4024.0, -4024.0, -4024.0, 14401.0, -4524.0, -4024.0, -3524.0, -3024.0, -4524.0, 9901.0, -5524.0, -3524.0, -3524.0, -5024.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 389, 39, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.08126631922413, "mean_inference_ms": 4.986443420287261, "mean_action_processing_ms": 1.3193183197413985, "mean_env_wait_ms": 0.621819109591635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007631540298461914, "StateBufferConnector_ms": 0.006718873977661133, "ViewRequirementAgentConnector_ms": 0.47800397872924805}}, "episode_reward_max": 87712.0, "episode_reward_min": -6524.0, "episode_reward_mean": 543.97, "episode_len_mean": 43.03, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18901.0, -3524.0, -2024.0, 15901.0, -3024.0, -3024.0, 16401.0, -3024.0, -3524.0, -2524.0, -4024.0, -4024.0, -3524.0, -4024.0, -3524.0, 16901.0, -2524.0, -4524.0, -3524.0, -3524.0, -3524.0, -3024.0, 10401.0, -3524.0, -4024.0, 17901.0, 15901.0, -4524.0, 87712.0, -38.0, -3524.0, -3524.0, 13901.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -4024.0, -4024.0, -2024.0, -5024.0, -5024.0, 7401.0, -5024.0, -4024.0, -3524.0, 14401.0, -4024.0, -4524.0, -6524.0, -3024.0, -3524.0, 18401.0, -4024.0, 8901.0, -6024.0, -3024.0, 12901.0, -4024.0, -3524.0, -4024.0, -3524.0, -3524.0, -3524.0, -3524.0, -3024.0, -4024.0, -4024.0, -4524.0, -5024.0, 18401.0, -5024.0, -3524.0, -2524.0, -4524.0, -4524.0, -4024.0, -4024.0, 12901.0, -4024.0, -3524.0, 16401.0, -4524.0, -4024.0, -4024.0, -4024.0, 14401.0, -4524.0, -4024.0, -3524.0, -3024.0, -4524.0, 9901.0, -5524.0, -3524.0, -3524.0, -5024.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 389, 39, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.08126631922413, "mean_inference_ms": 4.986443420287261, "mean_action_processing_ms": 1.3193183197413985, "mean_env_wait_ms": 0.621819109591635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007631540298461914, "StateBufferConnector_ms": 0.006718873977661133, "ViewRequirementAgentConnector_ms": 0.47800397872924805}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2502.9816980491405, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 352000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 1570.291, "sample_time_ms": 538.863, "synch_weights_time_ms": 33.106}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3630, "training_iteration": 88, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-44", "timestamp": 1715558624, "time_this_iter_s": 1.6087157726287842, "time_total_s": 141.91868662834167, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844a350>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 141.91868662834167, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 47.8, "ram_util_percent": 38.2, "gpu_util_percent0": 0.15, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.13, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.23, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.20500000000000002, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 37915.0, "episode_reward_min": -7024.0, "episode_reward_mean": -490.32, "episode_len_mean": 39.32, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, 13901.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -4024.0, -4024.0, -2024.0, -5024.0, -5024.0, 7401.0, -5024.0, -4024.0, -3524.0, 14401.0, -4024.0, -4524.0, -6524.0, -3024.0, -3524.0, 18401.0, -4024.0, 8901.0, -6024.0, -3024.0, 12901.0, -4024.0, -3524.0, -4024.0, -3524.0, -3524.0, -3524.0, -3524.0, -3024.0, -4024.0, -4024.0, -4524.0, -5024.0, 18401.0, -5024.0, -3524.0, -2524.0, -4524.0, -4524.0, -4024.0, -4024.0, 12901.0, -4024.0, -3524.0, 16401.0, -4524.0, -4024.0, -4024.0, -4024.0, 14401.0, -4524.0, -4024.0, -3524.0, -3024.0, -4524.0, 9901.0, -5524.0, -3524.0, -3524.0, -5024.0, -3024.0, -3024.0, -4524.0, -4024.0, -3024.0, -3524.0, -3524.0, -3024.0, -4524.0, 37915.0, -5524.0, -2524.0, 31944.0, -4524.0, 14901.0, -3524.0, -3024.0, -5024.0, 15401.0, -3024.0, -4524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -7024.0, 17401.0, 1062.0, -3524.0, -4524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 186, 25, 25, 157, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 39, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0809489354477435, "mean_inference_ms": 4.9865542102400555, "mean_action_processing_ms": 1.3197661961949145, "mean_env_wait_ms": 0.6220091593489336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007647991180419922, "StateBufferConnector_ms": 0.006392717361450195, "ViewRequirementAgentConnector_ms": 0.49712300300598145}}, "episode_reward_max": 37915.0, "episode_reward_min": -7024.0, "episode_reward_mean": -490.32, "episode_len_mean": 39.32, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, 13901.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4524.0, 14401.0, -4024.0, -4024.0, -2024.0, -5024.0, -5024.0, 7401.0, -5024.0, -4024.0, -3524.0, 14401.0, -4024.0, -4524.0, -6524.0, -3024.0, -3524.0, 18401.0, -4024.0, 8901.0, -6024.0, -3024.0, 12901.0, -4024.0, -3524.0, -4024.0, -3524.0, -3524.0, -3524.0, -3524.0, -3024.0, -4024.0, -4024.0, -4524.0, -5024.0, 18401.0, -5024.0, -3524.0, -2524.0, -4524.0, -4524.0, -4024.0, -4024.0, 12901.0, -4024.0, -3524.0, 16401.0, -4524.0, -4024.0, -4024.0, -4024.0, 14401.0, -4524.0, -4024.0, -3524.0, -3024.0, -4524.0, 9901.0, -5524.0, -3524.0, -3524.0, -5024.0, -3024.0, -3024.0, -4524.0, -4024.0, -3024.0, -3524.0, -3524.0, -3024.0, -4524.0, 37915.0, -5524.0, -2524.0, 31944.0, -4524.0, 14901.0, -3524.0, -3024.0, -5024.0, 15401.0, -3024.0, -4524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -7024.0, 17401.0, 1062.0, -3524.0, -4524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 186, 25, 25, 157, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 39, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0809489354477435, "mean_inference_ms": 4.9865542102400555, "mean_action_processing_ms": 1.3197661961949145, "mean_env_wait_ms": 0.6220091593489336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007647991180419922, "StateBufferConnector_ms": 0.006392717361450195, "ViewRequirementAgentConnector_ms": 0.49712300300598145}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2439.3845391509853, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 356000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 1579.096, "sample_time_ms": 539.866, "synch_weights_time_ms": 33.487}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3661, "training_iteration": 89, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-46", "timestamp": 1715558626, "time_this_iter_s": 1.6503674983978271, "time_total_s": 143.5690541267395, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844aa70>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 143.5690541267395, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 40.666666666666664, "ram_util_percent": 38.2, "gpu_util_percent0": 0.18666666666666665, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.14, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.12333333333333334, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.2833333333333334, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 193768.0, "episode_reward_min": -7024.0, "episode_reward_mean": 2478.77, "episode_len_mean": 51.23, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12901.0, -4024.0, -3524.0, 16401.0, -4524.0, -4024.0, -4024.0, -4024.0, 14401.0, -4524.0, -4024.0, -3524.0, -3024.0, -4524.0, 9901.0, -5524.0, -3524.0, -3524.0, -5024.0, -3024.0, -3024.0, -4524.0, -4024.0, -3024.0, -3524.0, -3524.0, -3024.0, -4524.0, 37915.0, -5524.0, -2524.0, 31944.0, -4524.0, 14901.0, -3524.0, -3024.0, -5024.0, 15401.0, -3024.0, -4524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -7024.0, 17401.0, 1062.0, -3524.0, -4524.0, -2024.0, 13401.0, -5024.0, -4024.0, 11401.0, -4024.0, -3524.0, -4524.0, 15401.0, -4024.0, 15401.0, -4024.0, -3524.0, -3024.0, -5024.0, 13901.0, -3524.0, -4024.0, -4524.0, 193768.0, -1032.0, -3024.0, 11401.0, -4524.0, -4524.0, -3524.0, 11901.0, -5024.0, -5524.0, -3524.0, -3524.0, 16401.0, -3524.0, -2524.0, 14401.0, -4024.0, -4024.0, -4024.0, 12901.0, -4024.0, 14401.0, -4024.0, -5024.0, -3524.0, -4524.0, 15901.0, -3524.0, -3024.0, 12901.0, -3524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 186, 25, 25, 157, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 39, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 833, 33, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081475693981654, "mean_inference_ms": 4.986326059992256, "mean_action_processing_ms": 1.3195237694234465, "mean_env_wait_ms": 0.6219948917059985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007703065872192383, "StateBufferConnector_ms": 0.006203889846801758, "ViewRequirementAgentConnector_ms": 0.48926758766174316}}, "episode_reward_max": 193768.0, "episode_reward_min": -7024.0, "episode_reward_mean": 2478.77, "episode_len_mean": 51.23, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12901.0, -4024.0, -3524.0, 16401.0, -4524.0, -4024.0, -4024.0, -4024.0, 14401.0, -4524.0, -4024.0, -3524.0, -3024.0, -4524.0, 9901.0, -5524.0, -3524.0, -3524.0, -5024.0, -3024.0, -3024.0, -4524.0, -4024.0, -3024.0, -3524.0, -3524.0, -3024.0, -4524.0, 37915.0, -5524.0, -2524.0, 31944.0, -4524.0, 14901.0, -3524.0, -3024.0, -5024.0, 15401.0, -3024.0, -4524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -7024.0, 17401.0, 1062.0, -3524.0, -4524.0, -2024.0, 13401.0, -5024.0, -4024.0, 11401.0, -4024.0, -3524.0, -4524.0, 15401.0, -4024.0, 15401.0, -4024.0, -3524.0, -3024.0, -5024.0, 13901.0, -3524.0, -4024.0, -4524.0, 193768.0, -1032.0, -3024.0, 11401.0, -4524.0, -4524.0, -3524.0, 11901.0, -5024.0, -5524.0, -3524.0, -3524.0, 16401.0, -3524.0, -2524.0, 14401.0, -4024.0, -4024.0, -4024.0, 12901.0, -4024.0, 14401.0, -4024.0, -5024.0, -3524.0, -4524.0, 15901.0, -3524.0, -3024.0, 12901.0, -3524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 186, 25, 25, 157, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 39, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 833, 33, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081475693981654, "mean_inference_ms": 4.986326059992256, "mean_action_processing_ms": 1.3195237694234465, "mean_env_wait_ms": 0.6219948917059985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007703065872192383, "StateBufferConnector_ms": 0.006203889846801758, "ViewRequirementAgentConnector_ms": 0.48926758766174316}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2485.2561194033387, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 360000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 1583.854, "sample_time_ms": 539.339, "synch_weights_time_ms": 32.843}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3711, "training_iteration": 90, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-48", "timestamp": 1715558628, "time_this_iter_s": 1.6238682270050049, "time_total_s": 145.1929223537445, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844b070>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 145.1929223537445, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 47.1, "ram_util_percent": 38.2, "gpu_util_percent0": 0.265, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.165, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.07, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.175, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 193768.0, "episode_reward_min": -9024.0, "episode_reward_mean": 1859.83, "episode_len_mean": 49.17, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, -5024.0, 15401.0, -3024.0, -4524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -7024.0, 17401.0, 1062.0, -3524.0, -4524.0, -2024.0, 13401.0, -5024.0, -4024.0, 11401.0, -4024.0, -3524.0, -4524.0, 15401.0, -4024.0, 15401.0, -4024.0, -3524.0, -3024.0, -5024.0, 13901.0, -3524.0, -4024.0, -4524.0, 193768.0, -1032.0, -3024.0, 11401.0, -4524.0, -4524.0, -3524.0, 11901.0, -5024.0, -5524.0, -3524.0, -3524.0, 16401.0, -3524.0, -2524.0, 14401.0, -4024.0, -4024.0, -4024.0, 12901.0, -4024.0, 14401.0, -4024.0, -5024.0, -3524.0, -4524.0, 15901.0, -3524.0, -3024.0, 12901.0, -3524.0, -3024.0, -5524.0, -9024.0, 34414.0, -3524.0, -4524.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, -4024.0, -5524.0, -3024.0, -3524.0, -5024.0, 19401.0, -4024.0, -4024.0, 14901.0, -3524.0, -3524.0, 11901.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, 13901.0, -4024.0, -4524.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 39, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 833, 33, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 187, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.079082489908718, "mean_inference_ms": 4.981396979561978, "mean_action_processing_ms": 1.3179570200996975, "mean_env_wait_ms": 0.6217103215173939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076923370361328125, "StateBufferConnector_ms": 0.0061931610107421875, "ViewRequirementAgentConnector_ms": 0.48989081382751465}}, "episode_reward_max": 193768.0, "episode_reward_min": -9024.0, "episode_reward_mean": 1859.83, "episode_len_mean": 49.17, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, -5024.0, 15401.0, -3024.0, -4524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -7024.0, 17401.0, 1062.0, -3524.0, -4524.0, -2024.0, 13401.0, -5024.0, -4024.0, 11401.0, -4024.0, -3524.0, -4524.0, 15401.0, -4024.0, 15401.0, -4024.0, -3524.0, -3024.0, -5024.0, 13901.0, -3524.0, -4024.0, -4524.0, 193768.0, -1032.0, -3024.0, 11401.0, -4524.0, -4524.0, -3524.0, 11901.0, -5024.0, -5524.0, -3524.0, -3524.0, 16401.0, -3524.0, -2524.0, 14401.0, -4024.0, -4024.0, -4024.0, 12901.0, -4024.0, 14401.0, -4024.0, -5024.0, -3524.0, -4524.0, 15901.0, -3524.0, -3024.0, 12901.0, -3524.0, -3024.0, -5524.0, -9024.0, 34414.0, -3524.0, -4524.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, -4024.0, -5524.0, -3024.0, -3524.0, -5024.0, 19401.0, -4024.0, -4024.0, 14901.0, -3524.0, -3524.0, 11901.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, 13901.0, -4024.0, -4524.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 39, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 833, 33, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 187, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.079082489908718, "mean_inference_ms": 4.981396979561978, "mean_action_processing_ms": 1.3179570200996975, "mean_env_wait_ms": 0.6217103215173939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076923370361328125, "StateBufferConnector_ms": 0.0061931610107421875, "ViewRequirementAgentConnector_ms": 0.48989081382751465}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2616.968663697261, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 364000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 1579.629, "sample_time_ms": 539.552, "synch_weights_time_ms": 33.512}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3746, "training_iteration": 91, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-50", "timestamp": 1715558630, "time_this_iter_s": 1.5373053550720215, "time_total_s": 146.73022770881653, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa2ec72d090>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 146.73022770881653, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 48.099999999999994, "ram_util_percent": 38.2, "gpu_util_percent0": 0.18, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.135, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.195, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.18, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": "checkpoint_000018"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 93208.0, "episode_reward_min": -9024.0, "episode_reward_mean": 883.23, "episode_len_mean": 44.77, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -3524.0, 11901.0, -5024.0, -5524.0, -3524.0, -3524.0, 16401.0, -3524.0, -2524.0, 14401.0, -4024.0, -4024.0, -4024.0, 12901.0, -4024.0, 14401.0, -4024.0, -5024.0, -3524.0, -4524.0, 15901.0, -3524.0, -3024.0, 12901.0, -3524.0, -3024.0, -5524.0, -9024.0, 34414.0, -3524.0, -4524.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, -4024.0, -5524.0, -3024.0, -3524.0, -5024.0, 19401.0, -4024.0, -4024.0, 14901.0, -3524.0, -3524.0, 11901.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, 13901.0, -4024.0, -4524.0, -4024.0, 93208.0, 2454.0, -4524.0, -4524.0, -3524.0, 11401.0, -4524.0, -4024.0, 14401.0, -5024.0, -3524.0, 17901.0, 13901.0, -4024.0, -4524.0, -3524.0, -5524.0, -3524.0, -4524.0, -4024.0, 17401.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 13901.0, -3524.0, -4024.0, -4024.0, 15401.0, -3524.0, -5024.0, -3524.0, -4524.0, -4024.0, -3524.0, 16901.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 187, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 393, 47, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.089287955811482, "mean_inference_ms": 4.987555974445325, "mean_action_processing_ms": 1.3200674955406233, "mean_env_wait_ms": 0.6223487456439266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008236408233642578, "StateBufferConnector_ms": 0.006615400314331055, "ViewRequirementAgentConnector_ms": 0.498615026473999}}, "episode_reward_max": 93208.0, "episode_reward_min": -9024.0, "episode_reward_mean": 883.23, "episode_len_mean": 44.77, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -3524.0, 11901.0, -5024.0, -5524.0, -3524.0, -3524.0, 16401.0, -3524.0, -2524.0, 14401.0, -4024.0, -4024.0, -4024.0, 12901.0, -4024.0, 14401.0, -4024.0, -5024.0, -3524.0, -4524.0, 15901.0, -3524.0, -3024.0, 12901.0, -3524.0, -3024.0, -5524.0, -9024.0, 34414.0, -3524.0, -4524.0, -4024.0, -4524.0, -4524.0, -5024.0, -4024.0, -4524.0, -4024.0, -5524.0, -3024.0, -3524.0, -5024.0, 19401.0, -4024.0, -4024.0, 14901.0, -3524.0, -3524.0, 11901.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, 13901.0, -4024.0, -4524.0, -4024.0, 93208.0, 2454.0, -4524.0, -4524.0, -3524.0, 11401.0, -4524.0, -4024.0, 14401.0, -5024.0, -3524.0, 17901.0, 13901.0, -4024.0, -4524.0, -3524.0, -5524.0, -3524.0, -4524.0, -4024.0, 17401.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 13901.0, -3524.0, -4024.0, -4024.0, 15401.0, -3524.0, -5024.0, -3524.0, -4524.0, -4024.0, -3524.0, 16901.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 187, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 393, 47, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.089287955811482, "mean_inference_ms": 4.987555974445325, "mean_action_processing_ms": 1.3200674955406233, "mean_env_wait_ms": 0.6223487456439266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008236408233642578, "StateBufferConnector_ms": 0.006615400314331055, "ViewRequirementAgentConnector_ms": 0.498615026473999}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2587.287003032779, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 368000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 1575.595, "sample_time_ms": 538.483, "synch_weights_time_ms": 34.208}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3785, "training_iteration": 92, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-51", "timestamp": 1715558631, "time_this_iter_s": 1.5576722621917725, "time_total_s": 148.2878999710083, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118458430>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 148.2878999710083, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 47.2, "ram_util_percent": 38.2, "gpu_util_percent0": 0.18, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.08, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.13, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.215, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 93208.0, "episode_reward_min": -7024.0, "episode_reward_mean": 745.5, "episode_len_mean": 43.5, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, 14901.0, -3524.0, -3524.0, 11901.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, 13901.0, -4024.0, -4524.0, -4024.0, 93208.0, 2454.0, -4524.0, -4524.0, -3524.0, 11401.0, -4524.0, -4024.0, 14401.0, -5024.0, -3524.0, 17901.0, 13901.0, -4024.0, -4524.0, -3524.0, -5524.0, -3524.0, -4524.0, -4024.0, 17401.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 13901.0, -3524.0, -4024.0, -4024.0, 15401.0, -3524.0, -5024.0, -3524.0, -4524.0, -4024.0, -3524.0, 16901.0, -3524.0, 18401.0, -4524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -5024.0, 23475.0, -4524.0, -3524.0, -6024.0, -4524.0, -3524.0, -3524.0, -4524.0, -7024.0, -4524.0, 13901.0, -5024.0, -4024.0, -3524.0, -2024.0, -5024.0, -4524.0, -4524.0, 13401.0, -4024.0, -4024.0, 14901.0, -3024.0, -3024.0, -4024.0, -3524.0, 16401.0, 67.0, -4024.0, -3024.0, -3024.0, 16901.0, -4524.0, -3524.0, -4024.0, -3024.0], "episode_lengths": [25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 393, 47, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 126, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 34, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.08039343639393, "mean_inference_ms": 4.983984881168452, "mean_action_processing_ms": 1.318355992904677, "mean_env_wait_ms": 0.6214037963329017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008099079132080078, "StateBufferConnector_ms": 0.006482839584350586, "ViewRequirementAgentConnector_ms": 0.4926793575286865}}, "episode_reward_max": 93208.0, "episode_reward_min": -7024.0, "episode_reward_mean": 745.5, "episode_len_mean": 43.5, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, 14901.0, -3524.0, -3524.0, 11901.0, -3524.0, -4024.0, -4024.0, -3024.0, -4024.0, -4024.0, -4024.0, -4024.0, 13901.0, -4024.0, -4524.0, -4024.0, 93208.0, 2454.0, -4524.0, -4524.0, -3524.0, 11401.0, -4524.0, -4024.0, 14401.0, -5024.0, -3524.0, 17901.0, 13901.0, -4024.0, -4524.0, -3524.0, -5524.0, -3524.0, -4524.0, -4024.0, 17401.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 13901.0, -3524.0, -4024.0, -4024.0, 15401.0, -3524.0, -5024.0, -3524.0, -4524.0, -4024.0, -3524.0, 16901.0, -3524.0, 18401.0, -4524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -5024.0, 23475.0, -4524.0, -3524.0, -6024.0, -4524.0, -3524.0, -3524.0, -4524.0, -7024.0, -4524.0, 13901.0, -5024.0, -4024.0, -3524.0, -2024.0, -5024.0, -4524.0, -4524.0, 13401.0, -4024.0, -4024.0, 14901.0, -3024.0, -3024.0, -4024.0, -3524.0, 16401.0, 67.0, -4024.0, -3024.0, -3024.0, 16901.0, -4524.0, -3524.0, -4024.0, -3024.0], "episode_lengths": [25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 393, 47, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 126, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 34, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.08039343639393, "mean_inference_ms": 4.983984881168452, "mean_action_processing_ms": 1.318355992904677, "mean_env_wait_ms": 0.6214037963329017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008099079132080078, "StateBufferConnector_ms": 0.006482839584350586, "ViewRequirementAgentConnector_ms": 0.4926793575286865}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2476.716185590265, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 372000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 1571.509, "sample_time_ms": 534.865, "synch_weights_time_ms": 34.16}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3830, "training_iteration": 93, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-53", "timestamp": 1715558633, "time_this_iter_s": 1.6259081363677979, "time_total_s": 149.9138081073761, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118459840>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 149.9138081073761, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 50.75, "ram_util_percent": 38.2, "gpu_util_percent0": 0.35, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.185, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.14500000000000002, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.135, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26901.0, "episode_reward_min": -7024.0, "episode_reward_mean": -410.85, "episode_len_mean": 38.85, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -3524.0, -5524.0, -3524.0, -4524.0, -4024.0, 17401.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 13901.0, -3524.0, -4024.0, -4024.0, 15401.0, -3524.0, -5024.0, -3524.0, -4524.0, -4024.0, -3524.0, 16901.0, -3524.0, 18401.0, -4524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -5024.0, 23475.0, -4524.0, -3524.0, -6024.0, -4524.0, -3524.0, -3524.0, -4524.0, -7024.0, -4524.0, 13901.0, -5024.0, -4024.0, -3524.0, -2024.0, -5024.0, -4524.0, -4524.0, 13401.0, -4024.0, -4024.0, 14901.0, -3024.0, -3024.0, -4024.0, -3524.0, 16401.0, 67.0, -4024.0, -3024.0, -3024.0, 16901.0, -4524.0, -3524.0, -4024.0, -3024.0, -4024.0, -4024.0, -2524.0, 26901.0, -4524.0, -4024.0, -4024.0, -5524.0, -3524.0, 5401.0, -4024.0, -4524.0, 17401.0, -3524.0, 14901.0, -3524.0, -4024.0, -4024.0, 13401.0, -4024.0, -5024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 15901.0, -5024.0, -4524.0, -4524.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 126, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 34, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083057550926172, "mean_inference_ms": 4.9845721010720885, "mean_action_processing_ms": 1.3186279501635911, "mean_env_wait_ms": 0.6218922065289526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008475303649902344, "StateBufferConnector_ms": 0.006223440170288086, "ViewRequirementAgentConnector_ms": 0.49613070487976074}}, "episode_reward_max": 26901.0, "episode_reward_min": -7024.0, "episode_reward_mean": -410.85, "episode_len_mean": 38.85, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -3524.0, -5524.0, -3524.0, -4524.0, -4024.0, 17401.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, 13901.0, -3524.0, -4024.0, -4024.0, 15401.0, -3524.0, -5024.0, -3524.0, -4524.0, -4024.0, -3524.0, 16901.0, -3524.0, 18401.0, -4524.0, -4024.0, 14901.0, -3524.0, -4024.0, -4024.0, -5024.0, 23475.0, -4524.0, -3524.0, -6024.0, -4524.0, -3524.0, -3524.0, -4524.0, -7024.0, -4524.0, 13901.0, -5024.0, -4024.0, -3524.0, -2024.0, -5024.0, -4524.0, -4524.0, 13401.0, -4024.0, -4024.0, 14901.0, -3024.0, -3024.0, -4024.0, -3524.0, 16401.0, 67.0, -4024.0, -3024.0, -3024.0, 16901.0, -4524.0, -3524.0, -4024.0, -3024.0, -4024.0, -4024.0, -2524.0, 26901.0, -4524.0, -4024.0, -4024.0, -5524.0, -3524.0, 5401.0, -4024.0, -4524.0, 17401.0, -3524.0, 14901.0, -3524.0, -4024.0, -4024.0, 13401.0, -4024.0, -5024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 15901.0, -5024.0, -4524.0, -4524.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 100, 25, 25, 25, 25, 126, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 34, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083057550926172, "mean_inference_ms": 4.9845721010720885, "mean_action_processing_ms": 1.3186279501635911, "mean_env_wait_ms": 0.6218922065289526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008475303649902344, "StateBufferConnector_ms": 0.006223440170288086, "ViewRequirementAgentConnector_ms": 0.49613070487976074}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2570.287661077534, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 376000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 1575.989, "sample_time_ms": 535.743, "synch_weights_time_ms": 35.32}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3861, "training_iteration": 94, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-55", "timestamp": 1715558635, "time_this_iter_s": 1.5690312385559082, "time_total_s": 151.482839345932, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11845a590>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 151.482839345932, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 42.699999999999996, "ram_util_percent": 38.2, "gpu_util_percent0": 0.24, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.21666666666666667, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.26666666666666666, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.20333333333333334, "vram_util_percent3": 0.11638849431818182}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26901.0, "episode_reward_min": -6024.0, "episode_reward_mean": 90.41, "episode_len_mean": 41.59, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5024.0, -4524.0, -4524.0, 13401.0, -4024.0, -4024.0, 14901.0, -3024.0, -3024.0, -4024.0, -3524.0, 16401.0, 67.0, -4024.0, -3024.0, -3024.0, 16901.0, -4524.0, -3524.0, -4024.0, -3024.0, -4024.0, -4024.0, -2524.0, 26901.0, -4524.0, -4024.0, -4024.0, -5524.0, -3524.0, 5401.0, -4024.0, -4524.0, 17401.0, -3524.0, 14901.0, -3524.0, -4024.0, -4024.0, 13401.0, -4024.0, -5024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 15901.0, -5024.0, -4524.0, -4524.0, -3524.0, 13401.0, -4024.0, -4024.0, 14401.0, -5024.0, -5024.0, -4024.0, -2524.0, 13901.0, -3524.0, -4024.0, -4024.0, -4024.0, 15401.0, -3524.0, -4024.0, -4524.0, -5024.0, -5024.0, 12401.0, -4524.0, -4524.0, 14401.0, -3024.0, -3524.0, -4024.0, -4024.0, 15401.0, -5024.0, -4024.0, 9401.0, -5024.0, -6024.0, -4524.0, -4024.0, 15901.0, -4024.0, 15901.0, -3524.0, -3524.0, -4024.0, -4524.0, 13401.0, -3524.0, -3024.0, 12401.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 34, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083620595746521, "mean_inference_ms": 4.988010727730939, "mean_action_processing_ms": 1.3183718947417333, "mean_env_wait_ms": 0.6217315267680344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008018016815185547, "StateBufferConnector_ms": 0.0061113834381103516, "ViewRequirementAgentConnector_ms": 0.4804511070251465}}, "episode_reward_max": 26901.0, "episode_reward_min": -6024.0, "episode_reward_mean": 90.41, "episode_len_mean": 41.59, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5024.0, -4524.0, -4524.0, 13401.0, -4024.0, -4024.0, 14901.0, -3024.0, -3024.0, -4024.0, -3524.0, 16401.0, 67.0, -4024.0, -3024.0, -3024.0, 16901.0, -4524.0, -3524.0, -4024.0, -3024.0, -4024.0, -4024.0, -2524.0, 26901.0, -4524.0, -4024.0, -4024.0, -5524.0, -3524.0, 5401.0, -4024.0, -4524.0, 17401.0, -3524.0, 14901.0, -3524.0, -4024.0, -4024.0, 13401.0, -4024.0, -5024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 15901.0, -5024.0, -4524.0, -4524.0, -3524.0, 13401.0, -4024.0, -4024.0, 14401.0, -5024.0, -5024.0, -4024.0, -2524.0, 13901.0, -3524.0, -4024.0, -4024.0, -4024.0, 15401.0, -3524.0, -4024.0, -4524.0, -5024.0, -5024.0, 12401.0, -4524.0, -4524.0, 14401.0, -3024.0, -3524.0, -4024.0, -4024.0, 15401.0, -5024.0, -4024.0, 9401.0, -5024.0, -6024.0, -4524.0, -4024.0, 15901.0, -4024.0, 15901.0, -3524.0, -3524.0, -4024.0, -4524.0, 13401.0, -3524.0, -3024.0, 12401.0, -4024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 34, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083620595746521, "mean_inference_ms": 4.988010727730939, "mean_action_processing_ms": 1.3183718947417333, "mean_env_wait_ms": 0.6217315267680344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008018016815185547, "StateBufferConnector_ms": 0.0061113834381103516, "ViewRequirementAgentConnector_ms": 0.4804511070251465}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2487.2822155013937, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 380000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 1584.324, "sample_time_ms": 542.861, "synch_weights_time_ms": 35.764}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3909, "training_iteration": 95, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-56", "timestamp": 1715558636, "time_this_iter_s": 1.6160492897033691, "time_total_s": 153.09888863563538, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11845ab90>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 153.09888863563538, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 46.45, "ram_util_percent": 38.2, "gpu_util_percent0": 0.185, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.08499999999999999, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.18, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.19, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 187814.0, "episode_reward_min": -6024.0, "episode_reward_mean": 1544.26, "episode_len_mean": 47.74, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, 13401.0, -4024.0, -5024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 15901.0, -5024.0, -4524.0, -4524.0, -3524.0, 13401.0, -4024.0, -4024.0, 14401.0, -5024.0, -5024.0, -4024.0, -2524.0, 13901.0, -3524.0, -4024.0, -4024.0, -4024.0, 15401.0, -3524.0, -4024.0, -4524.0, -5024.0, -5024.0, 12401.0, -4524.0, -4524.0, 14401.0, -3024.0, -3524.0, -4024.0, -4024.0, 15401.0, -5024.0, -4024.0, 9401.0, -5024.0, -6024.0, -4524.0, -4024.0, 15901.0, -4024.0, 15901.0, -3524.0, -3524.0, -4024.0, -4524.0, 13401.0, -3524.0, -3024.0, 12401.0, -4024.0, -6024.0, -4024.0, -3524.0, -4024.0, 11901.0, -3524.0, 15901.0, -3024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -3024.0, -3524.0, -3024.0, -4024.0, 187814.0, -36.0, 21401.0, -4024.0, -4524.0, -4024.0, 12401.0, -5024.0, -4024.0, 16401.0, -4524.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -4524.0, 14901.0, -4024.0, -4524.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 787, 37, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081742710557583, "mean_inference_ms": 4.988147896972207, "mean_action_processing_ms": 1.3174886103682162, "mean_env_wait_ms": 0.6214123986067234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007942914962768555, "StateBufferConnector_ms": 0.006322145462036133, "ViewRequirementAgentConnector_ms": 0.4809112548828125}}, "episode_reward_max": 187814.0, "episode_reward_min": -6024.0, "episode_reward_mean": 1544.26, "episode_len_mean": 47.74, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, 13401.0, -4024.0, -5024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -4024.0, 15901.0, -5024.0, -4524.0, -4524.0, -3524.0, 13401.0, -4024.0, -4024.0, 14401.0, -5024.0, -5024.0, -4024.0, -2524.0, 13901.0, -3524.0, -4024.0, -4024.0, -4024.0, 15401.0, -3524.0, -4024.0, -4524.0, -5024.0, -5024.0, 12401.0, -4524.0, -4524.0, 14401.0, -3024.0, -3524.0, -4024.0, -4024.0, 15401.0, -5024.0, -4024.0, 9401.0, -5024.0, -6024.0, -4524.0, -4024.0, 15901.0, -4024.0, 15901.0, -3524.0, -3524.0, -4024.0, -4524.0, 13401.0, -3524.0, -3024.0, 12401.0, -4024.0, -6024.0, -4024.0, -3524.0, -4024.0, 11901.0, -3524.0, 15901.0, -3024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -3024.0, -3524.0, -3024.0, -4024.0, 187814.0, -36.0, 21401.0, -4024.0, -4524.0, -4024.0, 12401.0, -5024.0, -4024.0, 16401.0, -4524.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -4524.0, 14901.0, -4024.0, -4524.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 787, 37, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081742710557583, "mean_inference_ms": 4.988147896972207, "mean_action_processing_ms": 1.3174886103682162, "mean_env_wait_ms": 0.6214123986067234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007942914962768555, "StateBufferConnector_ms": 0.006322145462036133, "ViewRequirementAgentConnector_ms": 0.4809112548828125}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2447.6617522943343, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 384000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 1587.002, "sample_time_ms": 544.046, "synch_weights_time_ms": 36.713}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3946, "training_iteration": 96, "trial_id": "df94b_00000", "date": "2024-05-12_17-03-58", "timestamp": 1715558638, "time_this_iter_s": 1.6488053798675537, "time_total_s": 154.74769401550293, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11845aaa0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 154.74769401550293, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 48.75, "ram_util_percent": 38.2, "gpu_util_percent0": 0.25, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.06, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.155, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.22999999999999998, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": "checkpoint_000019"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 275985.0, "episode_reward_min": -6024.0, "episode_reward_mean": 4589.19, "episode_len_mean": 58.81, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, 15401.0, -5024.0, -4024.0, 9401.0, -5024.0, -6024.0, -4524.0, -4024.0, 15901.0, -4024.0, 15901.0, -3524.0, -3524.0, -4024.0, -4524.0, 13401.0, -3524.0, -3024.0, 12401.0, -4024.0, -6024.0, -4024.0, -3524.0, -4024.0, 11901.0, -3524.0, 15901.0, -3024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -3024.0, -3524.0, -3024.0, -4024.0, 187814.0, -36.0, 21401.0, -4024.0, -4524.0, -4024.0, 12401.0, -5024.0, -4024.0, 16401.0, -4524.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -4524.0, 14901.0, -4024.0, -4524.0, -3524.0, -3024.0, -3524.0, -4024.0, 275985.0, 460.0, -4024.0, 17901.0, -3524.0, -4024.0, 15901.0, -4024.0, -4524.0, 15401.0, 17401.0, -5024.0, -4524.0, -4524.0, -4524.0, -4024.0, -4524.0, -5024.0, 15901.0, -3024.0, -4524.0, -4524.0, -4524.0, -4024.0, 13401.0, -3524.0, -3024.0, -4024.0, -4024.0, 12901.0, -4524.0, -4524.0, -3024.0, -4024.0, -2524.0, -4024.0, 19401.0], "episode_lengths": [25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 787, 37, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 1116, 41, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.086098193267919, "mean_inference_ms": 4.999037204758958, "mean_action_processing_ms": 1.3194515303228465, "mean_env_wait_ms": 0.6215980932380979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008050203323364258, "StateBufferConnector_ms": 0.006623029708862305, "ViewRequirementAgentConnector_ms": 0.4894676208496094}}, "episode_reward_max": 275985.0, "episode_reward_min": -6024.0, "episode_reward_mean": 4589.19, "episode_len_mean": 58.81, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, 15401.0, -5024.0, -4024.0, 9401.0, -5024.0, -6024.0, -4524.0, -4024.0, 15901.0, -4024.0, 15901.0, -3524.0, -3524.0, -4024.0, -4524.0, 13401.0, -3524.0, -3024.0, 12401.0, -4024.0, -6024.0, -4024.0, -3524.0, -4024.0, 11901.0, -3524.0, 15901.0, -3024.0, -4024.0, -4024.0, -4024.0, -4524.0, -4024.0, -3024.0, -3524.0, -3024.0, -4024.0, 187814.0, -36.0, 21401.0, -4024.0, -4524.0, -4024.0, 12401.0, -5024.0, -4024.0, 16401.0, -4524.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -4524.0, 14901.0, -4024.0, -4524.0, -3524.0, -3024.0, -3524.0, -4024.0, 275985.0, 460.0, -4024.0, 17901.0, -3524.0, -4024.0, 15901.0, -4024.0, -4524.0, 15401.0, 17401.0, -5024.0, -4524.0, -4524.0, -4524.0, -4024.0, -4524.0, -5024.0, 15901.0, -3024.0, -4524.0, -4524.0, -4524.0, -4024.0, 13401.0, -3524.0, -3024.0, -4024.0, -4024.0, 12901.0, -4524.0, -4524.0, -3024.0, -4024.0, -2524.0, -4024.0, 19401.0], "episode_lengths": [25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 787, 37, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 1116, 41, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.086098193267919, "mean_inference_ms": 4.999037204758958, "mean_action_processing_ms": 1.3194515303228465, "mean_env_wait_ms": 0.6215980932380979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008050203323364258, "StateBufferConnector_ms": 0.006623029708862305, "ViewRequirementAgentConnector_ms": 0.4894676208496094}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2593.6458427377615, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 388000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 1587.729, "sample_time_ms": 543.784, "synch_weights_time_ms": 35.504}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3987, "training_iteration": 97, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-00", "timestamp": 1715558640, "time_this_iter_s": 1.5542187690734863, "time_total_s": 156.30191278457642, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844ba00>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 156.30191278457642, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 47.15, "ram_util_percent": 38.2, "gpu_util_percent0": 0.21, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.155, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.135, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.215, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 275985.0, "episode_reward_min": -7024.0, "episode_reward_mean": 3035.29, "episode_len_mean": 52.71, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, 12401.0, -5024.0, -4024.0, 16401.0, -4524.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -4524.0, 14901.0, -4024.0, -4524.0, -3524.0, -3024.0, -3524.0, -4024.0, 275985.0, 460.0, -4024.0, 17901.0, -3524.0, -4024.0, 15901.0, -4024.0, -4524.0, 15401.0, 17401.0, -5024.0, -4524.0, -4524.0, -4524.0, -4024.0, -4524.0, -5024.0, 15901.0, -3024.0, -4524.0, -4524.0, -4524.0, -4024.0, 13401.0, -3524.0, -3024.0, -4024.0, -4024.0, 12901.0, -4524.0, -4524.0, -3024.0, -4024.0, -2524.0, -4024.0, 19401.0, -3524.0, 13401.0, -3024.0, 14901.0, 56844.0, -1531.0, -3524.0, -4024.0, 14901.0, -3024.0, -3524.0, -3024.0, -3524.0, -4024.0, -5024.0, -4024.0, -4024.0, -4524.0, 2901.0, -3524.0, -3524.0, -4024.0, -2524.0, -4024.0, -5524.0, 16901.0, -3524.0, -3524.0, 15401.0, -4024.0, -4024.0, -4524.0, -4524.0, 14401.0, -4024.0, -4524.0, -3024.0, -3524.0, 17401.0, -7024.0, -3524.0, -5024.0, -4024.0], "episode_lengths": [25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 1116, 41, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 257, 32, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.082103291231896, "mean_inference_ms": 4.9919141533864915, "mean_action_processing_ms": 1.318146427602945, "mean_env_wait_ms": 0.6212009883718911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00832676887512207, "StateBufferConnector_ms": 0.007055521011352539, "ViewRequirementAgentConnector_ms": 0.47942304611206055}}, "episode_reward_max": 275985.0, "episode_reward_min": -7024.0, "episode_reward_mean": 3035.29, "episode_len_mean": 52.71, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, 12401.0, -5024.0, -4024.0, 16401.0, -4524.0, -3524.0, -4024.0, -4524.0, -4024.0, -4024.0, -4524.0, 14901.0, -4024.0, -4524.0, -3524.0, -3024.0, -3524.0, -4024.0, 275985.0, 460.0, -4024.0, 17901.0, -3524.0, -4024.0, 15901.0, -4024.0, -4524.0, 15401.0, 17401.0, -5024.0, -4524.0, -4524.0, -4524.0, -4024.0, -4524.0, -5024.0, 15901.0, -3024.0, -4524.0, -4524.0, -4524.0, -4024.0, 13401.0, -3524.0, -3024.0, -4024.0, -4024.0, 12901.0, -4524.0, -4524.0, -3024.0, -4024.0, -2524.0, -4024.0, 19401.0, -3524.0, 13401.0, -3024.0, 14901.0, 56844.0, -1531.0, -3524.0, -4024.0, 14901.0, -3024.0, -3524.0, -3024.0, -3524.0, -4024.0, -5024.0, -4024.0, -4024.0, -4524.0, 2901.0, -3524.0, -3524.0, -4024.0, -2524.0, -4024.0, -5524.0, 16901.0, -3524.0, -3524.0, 15401.0, -4024.0, -4024.0, -4524.0, -4524.0, 14401.0, -4024.0, -4524.0, -3024.0, -3524.0, 17401.0, -7024.0, -3524.0, -5024.0, -4024.0], "episode_lengths": [25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 1116, 41, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 257, 32, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.082103291231896, "mean_inference_ms": 4.9919141533864915, "mean_action_processing_ms": 1.318146427602945, "mean_env_wait_ms": 0.6212009883718911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00832676887512207, "StateBufferConnector_ms": 0.007055521011352539, "ViewRequirementAgentConnector_ms": 0.47942304611206055}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2500.7006999248474, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 392000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 1587.875, "sample_time_ms": 544.492, "synch_weights_time_ms": 35.404}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4030, "training_iteration": 98, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-01", "timestamp": 1715558641, "time_this_iter_s": 1.6075918674468994, "time_total_s": 157.90950465202332, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118449090>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 157.90950465202332, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 46.7, "ram_util_percent": 38.2, "gpu_util_percent0": 0.175, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.1, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.115, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.185, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 56844.0, "episode_reward_min": -7024.0, "episode_reward_mean": -3.89, "episode_len_mean": 40.89, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, -4524.0, -5024.0, 15901.0, -3024.0, -4524.0, -4524.0, -4524.0, -4024.0, 13401.0, -3524.0, -3024.0, -4024.0, -4024.0, 12901.0, -4524.0, -4524.0, -3024.0, -4024.0, -2524.0, -4024.0, 19401.0, -3524.0, 13401.0, -3024.0, 14901.0, 56844.0, -1531.0, -3524.0, -4024.0, 14901.0, -3024.0, -3524.0, -3024.0, -3524.0, -4024.0, -5024.0, -4024.0, -4024.0, -4524.0, 2901.0, -3524.0, -3524.0, -4024.0, -2524.0, -4024.0, -5524.0, 16901.0, -3524.0, -3524.0, 15401.0, -4024.0, -4024.0, -4524.0, -4524.0, 14401.0, -4024.0, -4524.0, -3024.0, -3524.0, 17401.0, -7024.0, -3524.0, -5024.0, -4024.0, -3024.0, -3524.0, -3524.0, -3524.0, 17401.0, -4524.0, -5024.0, -4524.0, -4024.0, -4524.0, -4524.0, 14401.0, -3524.0, -3524.0, 13901.0, -4024.0, 16401.0, -3524.0, -3524.0, -3024.0, -4524.0, 12401.0, -4024.0, -4024.0, -3524.0, -4024.0, -3024.0, -3524.0, -5024.0, -4024.0, 12401.0, -3524.0, -3524.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 257, 32, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081022040469426, "mean_inference_ms": 4.996753160034164, "mean_action_processing_ms": 1.317777158036329, "mean_env_wait_ms": 0.6213361230294858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008656978607177734, "StateBufferConnector_ms": 0.007503986358642578, "ViewRequirementAgentConnector_ms": 0.47261977195739746}}, "episode_reward_max": 56844.0, "episode_reward_min": -7024.0, "episode_reward_mean": -3.89, "episode_len_mean": 40.89, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, -4524.0, -5024.0, 15901.0, -3024.0, -4524.0, -4524.0, -4524.0, -4024.0, 13401.0, -3524.0, -3024.0, -4024.0, -4024.0, 12901.0, -4524.0, -4524.0, -3024.0, -4024.0, -2524.0, -4024.0, 19401.0, -3524.0, 13401.0, -3024.0, 14901.0, 56844.0, -1531.0, -3524.0, -4024.0, 14901.0, -3024.0, -3524.0, -3024.0, -3524.0, -4024.0, -5024.0, -4024.0, -4024.0, -4524.0, 2901.0, -3524.0, -3524.0, -4024.0, -2524.0, -4024.0, -5524.0, 16901.0, -3524.0, -3524.0, 15401.0, -4024.0, -4024.0, -4524.0, -4524.0, 14401.0, -4024.0, -4524.0, -3024.0, -3524.0, 17401.0, -7024.0, -3524.0, -5024.0, -4024.0, -3024.0, -3524.0, -3524.0, -3524.0, 17401.0, -4524.0, -5024.0, -4524.0, -4024.0, -4524.0, -4524.0, 14401.0, -3524.0, -3524.0, 13901.0, -4024.0, 16401.0, -3524.0, -3524.0, -3024.0, -4524.0, 12401.0, -4024.0, -4024.0, -3524.0, -4024.0, -3024.0, -3524.0, -5024.0, -4024.0, 12401.0, -3524.0, -3524.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 257, 32, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081022040469426, "mean_inference_ms": 4.996753160034164, "mean_action_processing_ms": 1.317777158036329, "mean_env_wait_ms": 0.6213361230294858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008656978607177734, "StateBufferConnector_ms": 0.007503986358642578, "ViewRequirementAgentConnector_ms": 0.47261977195739746}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2393.491020850652, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 396000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 1591.021, "sample_time_ms": 552.58, "synch_weights_time_ms": 35.141}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4064, "training_iteration": 99, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-03", "timestamp": 1715558643, "time_this_iter_s": 1.6793289184570312, "time_total_s": 159.58883357048035, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844a0b0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 159.58883357048035, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 42.5, "ram_util_percent": 38.2, "gpu_util_percent0": 0.24000000000000002, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.1366666666666667, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.18000000000000002, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.17666666666666667, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 96168.0, "episode_reward_min": -7024.0, "episode_reward_mean": 1367.01, "episode_len_mean": 45.99, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16901.0, -3524.0, -3524.0, 15401.0, -4024.0, -4024.0, -4524.0, -4524.0, 14401.0, -4024.0, -4524.0, -3024.0, -3524.0, 17401.0, -7024.0, -3524.0, -5024.0, -4024.0, -3024.0, -3524.0, -3524.0, -3524.0, 17401.0, -4524.0, -5024.0, -4524.0, -4024.0, -4524.0, -4524.0, 14401.0, -3524.0, -3524.0, 13901.0, -4024.0, 16401.0, -3524.0, -3524.0, -3024.0, -4524.0, 12401.0, -4024.0, -4024.0, -3524.0, -4024.0, -3024.0, -3524.0, -5024.0, -4024.0, 12401.0, -3524.0, -3524.0, -3024.0, -4524.0, 12901.0, -4024.0, 13901.0, -4024.0, -3524.0, -5024.0, -4524.0, 13401.0, -4024.0, -4024.0, -3524.0, -4024.0, 14401.0, -5024.0, -4524.0, -4024.0, -3524.0, 15401.0, 96168.0, -1032.0, -3524.0, -4024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -3524.0, -4024.0, 32468.0, -3524.0, -3524.0, 19401.0, -4024.0, 14401.0, -5524.0, -4024.0, -4524.0, -3524.0, 16401.0, -3024.0, -3024.0, 15401.0, -4524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 433, 33, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 133, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.078124758419854, "mean_inference_ms": 5.005491836673216, "mean_action_processing_ms": 1.3175769061467435, "mean_env_wait_ms": 0.6212003845104345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008351325988769531, "StateBufferConnector_ms": 0.0077702999114990234, "ViewRequirementAgentConnector_ms": 0.46944355964660645}}, "episode_reward_max": 96168.0, "episode_reward_min": -7024.0, "episode_reward_mean": 1367.01, "episode_len_mean": 45.99, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16901.0, -3524.0, -3524.0, 15401.0, -4024.0, -4024.0, -4524.0, -4524.0, 14401.0, -4024.0, -4524.0, -3024.0, -3524.0, 17401.0, -7024.0, -3524.0, -5024.0, -4024.0, -3024.0, -3524.0, -3524.0, -3524.0, 17401.0, -4524.0, -5024.0, -4524.0, -4024.0, -4524.0, -4524.0, 14401.0, -3524.0, -3524.0, 13901.0, -4024.0, 16401.0, -3524.0, -3524.0, -3024.0, -4524.0, 12401.0, -4024.0, -4024.0, -3524.0, -4024.0, -3024.0, -3524.0, -5024.0, -4024.0, 12401.0, -3524.0, -3524.0, -3024.0, -4524.0, 12901.0, -4024.0, 13901.0, -4024.0, -3524.0, -5024.0, -4524.0, 13401.0, -4024.0, -4024.0, -3524.0, -4024.0, 14401.0, -5024.0, -4524.0, -4024.0, -3524.0, 15401.0, 96168.0, -1032.0, -3524.0, -4024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -3524.0, -4024.0, 32468.0, -3524.0, -3524.0, 19401.0, -4024.0, 14401.0, -5524.0, -4024.0, -4524.0, -3524.0, 16401.0, -3024.0, -3024.0, 15401.0, -4524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 433, 33, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 133, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.078124758419854, "mean_inference_ms": 5.005491836673216, "mean_action_processing_ms": 1.3175769061467435, "mean_env_wait_ms": 0.6212003845104345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008351325988769531, "StateBufferConnector_ms": 0.0077702999114990234, "ViewRequirementAgentConnector_ms": 0.46944355964660645}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2525.773183459974, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 400000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 1588.438, "sample_time_ms": 553.506, "synch_weights_time_ms": 35.303}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4112, "training_iteration": 100, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-05", "timestamp": 1715558645, "time_this_iter_s": 1.5979533195495605, "time_total_s": 161.1867868900299, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844aef0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 161.1867868900299, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 46.95, "ram_util_percent": 38.2, "gpu_util_percent0": 0.195, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.2, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.185, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.195, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 96168.0, "episode_reward_min": -7024.0, "episode_reward_mean": 893.51, "episode_len_mean": 44.49, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, 12401.0, -4024.0, -4024.0, -3524.0, -4024.0, -3024.0, -3524.0, -5024.0, -4024.0, 12401.0, -3524.0, -3524.0, -3024.0, -4524.0, 12901.0, -4024.0, 13901.0, -4024.0, -3524.0, -5024.0, -4524.0, 13401.0, -4024.0, -4024.0, -3524.0, -4024.0, 14401.0, -5024.0, -4524.0, -4024.0, -3524.0, 15401.0, 96168.0, -1032.0, -3524.0, -4024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -3524.0, -4024.0, 32468.0, -3524.0, -3524.0, 19401.0, -4024.0, 14401.0, -5524.0, -4024.0, -4524.0, -3524.0, 16401.0, -3024.0, -3024.0, 15401.0, -4524.0, -3524.0, -4524.0, -3524.0, -5024.0, 16401.0, -2524.0, 13401.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -5024.0, -3524.0, -4024.0, -4524.0, -3524.0, -3524.0, -4524.0, 15401.0, -2524.0, -3024.0, -3524.0, 13901.0, -7024.0, -3024.0, 13901.0, -4524.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 10401.0, -3524.0, -3524.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 433, 33, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 133, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.077161833769045, "mean_inference_ms": 5.002077188969956, "mean_action_processing_ms": 1.3166338451181068, "mean_env_wait_ms": 0.6211549792553045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00860452651977539, "StateBufferConnector_ms": 0.007833242416381836, "ViewRequirementAgentConnector_ms": 0.47944021224975586}}, "episode_reward_max": 96168.0, "episode_reward_min": -7024.0, "episode_reward_mean": 893.51, "episode_len_mean": 44.49, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.0, -4524.0, 12401.0, -4024.0, -4024.0, -3524.0, -4024.0, -3024.0, -3524.0, -5024.0, -4024.0, 12401.0, -3524.0, -3524.0, -3024.0, -4524.0, 12901.0, -4024.0, 13901.0, -4024.0, -3524.0, -5024.0, -4524.0, 13401.0, -4024.0, -4024.0, -3524.0, -4024.0, 14401.0, -5024.0, -4524.0, -4024.0, -3524.0, 15401.0, 96168.0, -1032.0, -3524.0, -4024.0, 15401.0, -4024.0, -4024.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -3524.0, -4024.0, 32468.0, -3524.0, -3524.0, 19401.0, -4024.0, 14401.0, -5524.0, -4024.0, -4524.0, -3524.0, 16401.0, -3024.0, -3024.0, 15401.0, -4524.0, -3524.0, -4524.0, -3524.0, -5024.0, 16401.0, -2524.0, 13401.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -5024.0, -3524.0, -4024.0, -4524.0, -3524.0, -3524.0, -4524.0, 15401.0, -2524.0, -3024.0, -3524.0, 13901.0, -7024.0, -3024.0, 13901.0, -4524.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 10401.0, -3524.0, -3524.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 433, 33, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 133, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.077161833769045, "mean_inference_ms": 5.002077188969956, "mean_action_processing_ms": 1.3166338451181068, "mean_env_wait_ms": 0.6211549792553045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00860452651977539, "StateBufferConnector_ms": 0.007833242416381836, "ViewRequirementAgentConnector_ms": 0.47944021224975586}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2427.644198211985, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 404000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 1600.356, "sample_time_ms": 554.789, "synch_weights_time_ms": 34.945}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4149, "training_iteration": 101, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-07", "timestamp": 1715558647, "time_this_iter_s": 1.6578154563903809, "time_total_s": 162.8446023464203, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844aa10>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 162.8446023464203, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 47.349999999999994, "ram_util_percent": 38.2, "gpu_util_percent0": 0.155, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.2, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.2, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.15, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": "checkpoint_000020"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32468.0, "episode_reward_min": -7024.0, "episode_reward_mean": -317.58, "episode_len_mean": 39.58, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -3524.0, -4024.0, 32468.0, -3524.0, -3524.0, 19401.0, -4024.0, 14401.0, -5524.0, -4024.0, -4524.0, -3524.0, 16401.0, -3024.0, -3024.0, 15401.0, -4524.0, -3524.0, -4524.0, -3524.0, -5024.0, 16401.0, -2524.0, 13401.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -5024.0, -3524.0, -4024.0, -4524.0, -3524.0, -3524.0, -4524.0, 15401.0, -2524.0, -3024.0, -3524.0, 13901.0, -7024.0, -3024.0, 13901.0, -4524.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 10401.0, -3524.0, -3524.0, -3524.0, -3524.0, -2024.0, -4024.0, -3524.0, -4524.0, 10901.0, -5024.0, -5024.0, 15901.0, -5524.0, -4524.0, 15401.0, 14901.0, -4524.0, -5024.0, -4524.0, -4524.0, -4524.0, -4024.0, -3524.0, 15401.0, -3024.0, -3524.0, -3524.0, -4524.0, -3524.0, -4524.0, -4524.0, -5024.0, -4524.0, 15401.0, -3524.0, -2524.0, -3524.0, -4524.0, -4024.0, -4524.0, 12901.0], "episode_lengths": [25, 25, 25, 25, 100, 25, 25, 25, 25, 133, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081421752118685, "mean_inference_ms": 5.009635460316388, "mean_action_processing_ms": 1.317924927546106, "mean_env_wait_ms": 0.6214426880388622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007864236831665039, "StateBufferConnector_ms": 0.006336688995361328, "ViewRequirementAgentConnector_ms": 0.48415207862854004}}, "episode_reward_max": 32468.0, "episode_reward_min": -7024.0, "episode_reward_mean": -317.58, "episode_len_mean": 39.58, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4024.0, -4024.0, -4524.0, -4024.0, 9901.0, -4024.0, -3024.0, -3524.0, -4024.0, 32468.0, -3524.0, -3524.0, 19401.0, -4024.0, 14401.0, -5524.0, -4024.0, -4524.0, -3524.0, 16401.0, -3024.0, -3024.0, 15401.0, -4524.0, -3524.0, -4524.0, -3524.0, -5024.0, 16401.0, -2524.0, 13401.0, -3524.0, -4024.0, -4024.0, -4024.0, -3524.0, -5024.0, -3524.0, -4024.0, -4524.0, -3524.0, -3524.0, -4524.0, 15401.0, -2524.0, -3024.0, -3524.0, 13901.0, -7024.0, -3024.0, 13901.0, -4524.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 10401.0, -3524.0, -3524.0, -3524.0, -3524.0, -2024.0, -4024.0, -3524.0, -4524.0, 10901.0, -5024.0, -5024.0, 15901.0, -5524.0, -4524.0, 15401.0, 14901.0, -4524.0, -5024.0, -4524.0, -4524.0, -4524.0, -4024.0, -3524.0, 15401.0, -3024.0, -3524.0, -3524.0, -4524.0, -3524.0, -4524.0, -4524.0, -5024.0, -4524.0, 15401.0, -3524.0, -2524.0, -3524.0, -4524.0, -4024.0, -4524.0, 12901.0], "episode_lengths": [25, 25, 25, 25, 100, 25, 25, 25, 25, 133, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081421752118685, "mean_inference_ms": 5.009635460316388, "mean_action_processing_ms": 1.317924927546106, "mean_env_wait_ms": 0.6214426880388622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007864236831665039, "StateBufferConnector_ms": 0.006336688995361328, "ViewRequirementAgentConnector_ms": 0.48415207862854004}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2458.9581901878614, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 408000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 1608.426, "sample_time_ms": 564.192, "synch_weights_time_ms": 35.618}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4188, "training_iteration": 102, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-08", "timestamp": 1715558648, "time_this_iter_s": 1.6401588916778564, "time_total_s": 164.48476123809814, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844b100>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 164.48476123809814, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 47.05, "ram_util_percent": 38.2, "gpu_util_percent0": 0.25, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.16999999999999998, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.1, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.225, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19401.0, "episode_reward_min": -7024.0, "episode_reward_mean": -469.0, "episode_len_mean": 40.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -3524.0, -4524.0, 15401.0, -2524.0, -3024.0, -3524.0, 13901.0, -7024.0, -3024.0, 13901.0, -4524.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 10401.0, -3524.0, -3524.0, -3524.0, -3524.0, -2024.0, -4024.0, -3524.0, -4524.0, 10901.0, -5024.0, -5024.0, 15901.0, -5524.0, -4524.0, 15401.0, 14901.0, -4524.0, -5024.0, -4524.0, -4524.0, -4524.0, -4024.0, -3524.0, 15401.0, -3024.0, -3524.0, -3524.0, -4524.0, -3524.0, -4524.0, -4524.0, -5024.0, -4524.0, 15401.0, -3524.0, -2524.0, -3524.0, -4524.0, -4024.0, -4524.0, 12901.0, -3524.0, 11901.0, -5024.0, 12901.0, -4024.0, -4524.0, -4524.0, 17901.0, -3024.0, -2524.0, -5024.0, -5524.0, -5524.0, -4524.0, -4524.0, 14901.0, -3524.0, -4524.0, -4524.0, -4524.0, -4524.0, -3524.0, 15401.0, -4024.0, -6524.0, 12401.0, -3524.0, -5524.0, 10401.0, -4024.0, -4024.0, 19401.0, -4024.0, -4024.0, -3524.0, -2524.0, 13401.0, -5024.0, -4524.0, -3024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.077223527866022, "mean_inference_ms": 5.0102019099362956, "mean_action_processing_ms": 1.3174957919393617, "mean_env_wait_ms": 0.6209781181583266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00784444808959961, "StateBufferConnector_ms": 0.006890535354614258, "ViewRequirementAgentConnector_ms": 0.48102521896362305}}, "episode_reward_max": 19401.0, "episode_reward_min": -7024.0, "episode_reward_mean": -469.0, "episode_len_mean": 40.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -3524.0, -4524.0, 15401.0, -2524.0, -3024.0, -3524.0, 13901.0, -7024.0, -3024.0, 13901.0, -4524.0, -4024.0, -3524.0, -4524.0, -4524.0, -3524.0, -4524.0, 10401.0, -3524.0, -3524.0, -3524.0, -3524.0, -2024.0, -4024.0, -3524.0, -4524.0, 10901.0, -5024.0, -5024.0, 15901.0, -5524.0, -4524.0, 15401.0, 14901.0, -4524.0, -5024.0, -4524.0, -4524.0, -4524.0, -4024.0, -3524.0, 15401.0, -3024.0, -3524.0, -3524.0, -4524.0, -3524.0, -4524.0, -4524.0, -5024.0, -4524.0, 15401.0, -3524.0, -2524.0, -3524.0, -4524.0, -4024.0, -4524.0, 12901.0, -3524.0, 11901.0, -5024.0, 12901.0, -4024.0, -4524.0, -4524.0, 17901.0, -3024.0, -2524.0, -5024.0, -5524.0, -5524.0, -4524.0, -4524.0, 14901.0, -3524.0, -4524.0, -4524.0, -4524.0, -4524.0, -3524.0, 15401.0, -4024.0, -6524.0, 12401.0, -3524.0, -5524.0, 10401.0, -4024.0, -4024.0, 19401.0, -4024.0, -4024.0, -3524.0, -2524.0, 13401.0, -5024.0, -4524.0, -3024.0], "episode_lengths": [25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.077223527866022, "mean_inference_ms": 5.0102019099362956, "mean_action_processing_ms": 1.3174957919393617, "mean_env_wait_ms": 0.6209781181583266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00784444808959961, "StateBufferConnector_ms": 0.006890535354614258, "ViewRequirementAgentConnector_ms": 0.48102521896362305}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2401.5441141526812, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 412000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 1613.48, "sample_time_ms": 573.579, "synch_weights_time_ms": 34.67}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4228, "training_iteration": 103, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-10", "timestamp": 1715558650, "time_this_iter_s": 1.6806166172027588, "time_total_s": 166.1653778553009, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118449600>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 166.1653778553009, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 41.099999999999994, "ram_util_percent": 38.2, "gpu_util_percent0": 0.14333333333333334, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.13333333333333333, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.1366666666666667, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.21, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 476066.0, "episode_reward_min": -6524.0, "episode_reward_mean": 21759.84, "episode_len_mean": 130.16, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, 15401.0, -3024.0, -3524.0, -3524.0, -4524.0, -3524.0, -4524.0, -4524.0, -5024.0, -4524.0, 15401.0, -3524.0, -2524.0, -3524.0, -4524.0, -4024.0, -4524.0, 12901.0, -3524.0, 11901.0, -5024.0, 12901.0, -4024.0, -4524.0, -4524.0, 17901.0, -3024.0, -2524.0, -5024.0, -5524.0, -5524.0, -4524.0, -4524.0, 14901.0, -3524.0, -4524.0, -4524.0, -4524.0, -4524.0, -3524.0, 15401.0, -4024.0, -6524.0, 12401.0, -3524.0, -5524.0, 10401.0, -4024.0, -4024.0, 19401.0, -4024.0, -4024.0, -3524.0, -2524.0, 13401.0, -5024.0, -4524.0, -3024.0, -3524.0, -4024.0, -4024.0, -5524.0, 15901.0, -3524.0, -3524.0, -4024.0, -5024.0, -3524.0, -4024.0, 12401.0, -4524.0, 190787.0, 192187.0, -538.0, 13901.0, -3524.0, -4024.0, -5524.0, 11901.0, -4524.0, -4024.0, -3524.0, -3024.0, 18401.0, -4024.0, -3524.0, -4524.0, -4524.0, -4524.0, -4024.0, 455205.0, -537.0, -5024.0, -3524.0, 446166.0, 476066.0, 471166.0, 6941.0, -4524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 814, 814, 39, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 1896, 38, 25, 25, 1935, 1935, 1935, 60, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.074588766174176, "mean_inference_ms": 5.013319581722335, "mean_action_processing_ms": 1.3166352308637952, "mean_env_wait_ms": 0.6210121394789102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007748126983642578, "StateBufferConnector_ms": 0.008089542388916016, "ViewRequirementAgentConnector_ms": 0.4808797836303711}}, "episode_reward_max": 476066.0, "episode_reward_min": -6524.0, "episode_reward_mean": 21759.84, "episode_len_mean": 130.16, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, 15401.0, -3024.0, -3524.0, -3524.0, -4524.0, -3524.0, -4524.0, -4524.0, -5024.0, -4524.0, 15401.0, -3524.0, -2524.0, -3524.0, -4524.0, -4024.0, -4524.0, 12901.0, -3524.0, 11901.0, -5024.0, 12901.0, -4024.0, -4524.0, -4524.0, 17901.0, -3024.0, -2524.0, -5024.0, -5524.0, -5524.0, -4524.0, -4524.0, 14901.0, -3524.0, -4524.0, -4524.0, -4524.0, -4524.0, -3524.0, 15401.0, -4024.0, -6524.0, 12401.0, -3524.0, -5524.0, 10401.0, -4024.0, -4024.0, 19401.0, -4024.0, -4024.0, -3524.0, -2524.0, 13401.0, -5024.0, -4524.0, -3024.0, -3524.0, -4024.0, -4024.0, -5524.0, 15901.0, -3524.0, -3524.0, -4024.0, -5024.0, -3524.0, -4024.0, 12401.0, -4524.0, 190787.0, 192187.0, -538.0, 13901.0, -3524.0, -4024.0, -5524.0, 11901.0, -4524.0, -4024.0, -3524.0, -3024.0, 18401.0, -4024.0, -3524.0, -4524.0, -4524.0, -4524.0, -4024.0, 455205.0, -537.0, -5024.0, -3524.0, 446166.0, 476066.0, 471166.0, 6941.0, -4524.0], "episode_lengths": [25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 814, 814, 39, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 1896, 38, 25, 25, 1935, 1935, 1935, 60, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.074588766174176, "mean_inference_ms": 5.013319581722335, "mean_action_processing_ms": 1.3166352308637952, "mean_env_wait_ms": 0.6210121394789102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007748126983642578, "StateBufferConnector_ms": 0.008089542388916016, "ViewRequirementAgentConnector_ms": 0.4808797836303711}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2511.8864283222515, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 416000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 1617.099, "sample_time_ms": 574.103, "synch_weights_time_ms": 34.31}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4269, "training_iteration": 104, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-12", "timestamp": 1715558652, "time_this_iter_s": 1.603139877319336, "time_total_s": 167.76851773262024, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118448790>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 167.76851773262024, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 46.75, "ram_util_percent": 38.2, "gpu_util_percent0": 0.14, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.145, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.155, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.13, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.29166666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 476066.0, "episode_reward_min": -5524.0, "episode_reward_mean": 22626.84, "episode_len_mean": 133.16, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12401.0, -3524.0, -5524.0, 10401.0, -4024.0, -4024.0, 19401.0, -4024.0, -4024.0, -3524.0, -2524.0, 13401.0, -5024.0, -4524.0, -3024.0, -3524.0, -4024.0, -4024.0, -5524.0, 15901.0, -3524.0, -3524.0, -4024.0, -5024.0, -3524.0, -4024.0, 12401.0, -4524.0, 190787.0, 192187.0, -538.0, 13901.0, -3524.0, -4024.0, -5524.0, 11901.0, -4524.0, -4024.0, -3524.0, -3024.0, 18401.0, -4024.0, -3524.0, -4524.0, -4524.0, -4524.0, -4024.0, 455205.0, -537.0, -5024.0, -3524.0, 446166.0, 476066.0, 471166.0, 6941.0, -4524.0, -4024.0, 13401.0, -4024.0, 20401.0, -4024.0, -4024.0, -4024.0, -3524.0, 15901.0, -3524.0, -3024.0, -3524.0, -2524.0, 12401.0, -4024.0, -5024.0, -3024.0, 13401.0, -4024.0, -5024.0, -3524.0, 15401.0, -4524.0, -3524.0, -3524.0, -5024.0, 13401.0, -4524.0, -3524.0, -3024.0, -4024.0, 13901.0, -3024.0, -4024.0, 15401.0, 16401.0, -3024.0, -3524.0, -4024.0, -4524.0, 14401.0, -4524.0, 10901.0, -3524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 814, 814, 39, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 1896, 38, 25, 25, 1935, 1935, 1935, 60, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.073749342882913, "mean_inference_ms": 5.015997091612134, "mean_action_processing_ms": 1.3170275997440555, "mean_env_wait_ms": 0.6211599926394151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076487064361572266, "StateBufferConnector_ms": 0.008099079132080078, "ViewRequirementAgentConnector_ms": 0.47132158279418945}}, "episode_reward_max": 476066.0, "episode_reward_min": -5524.0, "episode_reward_mean": 22626.84, "episode_len_mean": 133.16, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12401.0, -3524.0, -5524.0, 10401.0, -4024.0, -4024.0, 19401.0, -4024.0, -4024.0, -3524.0, -2524.0, 13401.0, -5024.0, -4524.0, -3024.0, -3524.0, -4024.0, -4024.0, -5524.0, 15901.0, -3524.0, -3524.0, -4024.0, -5024.0, -3524.0, -4024.0, 12401.0, -4524.0, 190787.0, 192187.0, -538.0, 13901.0, -3524.0, -4024.0, -5524.0, 11901.0, -4524.0, -4024.0, -3524.0, -3024.0, 18401.0, -4024.0, -3524.0, -4524.0, -4524.0, -4524.0, -4024.0, 455205.0, -537.0, -5024.0, -3524.0, 446166.0, 476066.0, 471166.0, 6941.0, -4524.0, -4024.0, 13401.0, -4024.0, 20401.0, -4024.0, -4024.0, -4024.0, -3524.0, 15901.0, -3524.0, -3024.0, -3524.0, -2524.0, 12401.0, -4024.0, -5024.0, -3024.0, 13401.0, -4024.0, -5024.0, -3524.0, 15401.0, -4524.0, -3524.0, -3524.0, -5024.0, 13401.0, -4524.0, -3524.0, -3024.0, -4024.0, 13901.0, -3024.0, -4024.0, 15401.0, 16401.0, -3024.0, -3524.0, -4024.0, -4524.0, 14401.0, -4524.0, 10901.0, -3524.0], "episode_lengths": [100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 814, 814, 39, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 1896, 38, 25, 25, 1935, 1935, 1935, 60, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 100, 25, 100, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.073749342882913, "mean_inference_ms": 5.015997091612134, "mean_action_processing_ms": 1.3170275997440555, "mean_env_wait_ms": 0.6211599926394151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076487064361572266, "StateBufferConnector_ms": 0.008099079132080078, "ViewRequirementAgentConnector_ms": 0.47132158279418945}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2409.8180615814995, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 420000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 1622.269, "sample_time_ms": 567.409, "synch_weights_time_ms": 35.989}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4313, "training_iteration": 105, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-13", "timestamp": 1715558653, "time_this_iter_s": 1.6702520847320557, "time_total_s": 169.4387698173523, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118449960>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 169.4387698173523, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 47.099999999999994, "ram_util_percent": 38.2, "gpu_util_percent0": 0.16999999999999998, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.2, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.22, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.16999999999999998, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 619480.0, "episode_reward_min": -5524.0, "episode_reward_mean": 36714.14, "episode_len_mean": 191.86, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18401.0, -4024.0, -3524.0, -4524.0, -4524.0, -4524.0, -4024.0, 455205.0, -537.0, -5024.0, -3524.0, 446166.0, 476066.0, 471166.0, 6941.0, -4524.0, -4024.0, 13401.0, -4024.0, 20401.0, -4024.0, -4024.0, -4024.0, -3524.0, 15901.0, -3524.0, -3024.0, -3524.0, -2524.0, 12401.0, -4024.0, -5024.0, -3024.0, 13401.0, -4024.0, -5024.0, -3524.0, 15401.0, -4524.0, -3524.0, -3524.0, -5024.0, 13401.0, -4524.0, -3524.0, -3024.0, -4024.0, 13901.0, -3024.0, -4024.0, 15401.0, 16401.0, -3024.0, -3524.0, -4024.0, -4524.0, 14401.0, -4524.0, 10901.0, -3524.0, -4524.0, -4024.0, -4024.0, -5524.0, 14401.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -1524.0, -3524.0, -3524.0, -5024.0, -5024.0, -3524.0, -4524.0, -5024.0, -3524.0, 11901.0, -3524.0, -3024.0, -4524.0, 11401.0, 573580.0, 619480.0, 606980.0, 2951.0, 12401.0, -5024.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, 39902.0, -4024.0, -3024.0, -4524.0], "episode_lengths": [100, 25, 25, 25, 25, 25, 25, 1896, 38, 25, 25, 1935, 1935, 1935, 60, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 2521, 2521, 2521, 50, 100, 25, 25, 25, 25, 25, 25, 25, 199, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0715166547652775, "mean_inference_ms": 5.012838396402331, "mean_action_processing_ms": 1.3166385002523509, "mean_env_wait_ms": 0.620790680209016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007912158966064453, "StateBufferConnector_ms": 0.008746147155761719, "ViewRequirementAgentConnector_ms": 0.4838254451751709}}, "episode_reward_max": 619480.0, "episode_reward_min": -5524.0, "episode_reward_mean": 36714.14, "episode_len_mean": 191.86, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18401.0, -4024.0, -3524.0, -4524.0, -4524.0, -4524.0, -4024.0, 455205.0, -537.0, -5024.0, -3524.0, 446166.0, 476066.0, 471166.0, 6941.0, -4524.0, -4024.0, 13401.0, -4024.0, 20401.0, -4024.0, -4024.0, -4024.0, -3524.0, 15901.0, -3524.0, -3024.0, -3524.0, -2524.0, 12401.0, -4024.0, -5024.0, -3024.0, 13401.0, -4024.0, -5024.0, -3524.0, 15401.0, -4524.0, -3524.0, -3524.0, -5024.0, 13401.0, -4524.0, -3524.0, -3024.0, -4024.0, 13901.0, -3024.0, -4024.0, 15401.0, 16401.0, -3024.0, -3524.0, -4024.0, -4524.0, 14401.0, -4524.0, 10901.0, -3524.0, -4524.0, -4024.0, -4024.0, -5524.0, 14401.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -1524.0, -3524.0, -3524.0, -5024.0, -5024.0, -3524.0, -4524.0, -5024.0, -3524.0, 11901.0, -3524.0, -3024.0, -4524.0, 11401.0, 573580.0, 619480.0, 606980.0, 2951.0, 12401.0, -5024.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, 39902.0, -4024.0, -3024.0, -4524.0], "episode_lengths": [100, 25, 25, 25, 25, 25, 25, 1896, 38, 25, 25, 1935, 1935, 1935, 60, 25, 25, 100, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 2521, 2521, 2521, 50, 100, 25, 25, 25, 25, 25, 25, 25, 199, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0715166547652775, "mean_inference_ms": 5.012838396402331, "mean_action_processing_ms": 1.3166385002523509, "mean_env_wait_ms": 0.620790680209016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007912158966064453, "StateBufferConnector_ms": 0.008746147155761719, "ViewRequirementAgentConnector_ms": 0.4838254451751709}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2348.157733928896, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 424000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 1629.193, "sample_time_ms": 571.181, "synch_weights_time_ms": 35.293}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4353, "training_iteration": 106, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-15", "timestamp": 1715558655, "time_this_iter_s": 1.7145805358886719, "time_total_s": 171.15335035324097, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844a770>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 171.15335035324097, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 42.36666666666667, "ram_util_percent": 38.2, "gpu_util_percent0": 0.21666666666666667, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.16666666666666666, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.09000000000000001, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.18666666666666668, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": "checkpoint_000021"}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.44791666666667, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 619480.0, "episode_reward_min": -5524.0, "episode_reward_mean": 17878.42, "episode_len_mean": 115.58, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3524.0, -5024.0, 13401.0, -4524.0, -3524.0, -3024.0, -4024.0, 13901.0, -3024.0, -4024.0, 15401.0, 16401.0, -3024.0, -3524.0, -4024.0, -4524.0, 14401.0, -4524.0, 10901.0, -3524.0, -4524.0, -4024.0, -4024.0, -5524.0, 14401.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -1524.0, -3524.0, -3524.0, -5024.0, -5024.0, -3524.0, -4524.0, -5024.0, -3524.0, 11901.0, -3524.0, -3024.0, -4524.0, 11401.0, 573580.0, 619480.0, 606980.0, 2951.0, 12401.0, -5024.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, 39902.0, -4024.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, -3024.0, -3524.0, 13401.0, -4524.0, -4524.0, 14901.0, -4024.0, -5024.0, 12901.0, 11901.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -5024.0, -3024.0, 12401.0, -3024.0, -5524.0, -4024.0, -4024.0, -5024.0, -4524.0, -3524.0, -4524.0, -3524.0, 18401.0, -3024.0, -4524.0, -3524.0, -3524.0, -524.0, 55.0, 13901.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 2521, 2521, 2521, 50, 100, 25, 25, 25, 25, 25, 25, 25, 199, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 46, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.07845866051382, "mean_inference_ms": 5.017389038642931, "mean_action_processing_ms": 1.3180302283528624, "mean_env_wait_ms": 0.6210894567209877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007834911346435547, "StateBufferConnector_ms": 0.007354259490966797, "ViewRequirementAgentConnector_ms": 0.4806180000305176}}, "episode_reward_max": 619480.0, "episode_reward_min": -5524.0, "episode_reward_mean": 17878.42, "episode_len_mean": 115.58, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3524.0, -5024.0, 13401.0, -4524.0, -3524.0, -3024.0, -4024.0, 13901.0, -3024.0, -4024.0, 15401.0, 16401.0, -3024.0, -3524.0, -4024.0, -4524.0, 14401.0, -4524.0, 10901.0, -3524.0, -4524.0, -4024.0, -4024.0, -5524.0, 14401.0, -4524.0, 14401.0, -4024.0, -3524.0, -4524.0, -1524.0, -3524.0, -3524.0, -5024.0, -5024.0, -3524.0, -4524.0, -5024.0, -3524.0, 11901.0, -3524.0, -3024.0, -4524.0, 11401.0, 573580.0, 619480.0, 606980.0, 2951.0, 12401.0, -5024.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, 39902.0, -4024.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, -3024.0, -3524.0, 13401.0, -4524.0, -4524.0, 14901.0, -4024.0, -5024.0, 12901.0, 11901.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -5024.0, -3024.0, 12401.0, -3024.0, -5524.0, -4024.0, -4024.0, -5024.0, -4524.0, -3524.0, -4524.0, -3524.0, 18401.0, -3024.0, -4524.0, -3524.0, -3524.0, -524.0, 55.0, 13901.0], "episode_lengths": [25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 100, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 100, 2521, 2521, 2521, 50, 100, 25, 25, 25, 25, 25, 25, 25, 199, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 46, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.07845866051382, "mean_inference_ms": 5.017389038642931, "mean_action_processing_ms": 1.3180302283528624, "mean_env_wait_ms": 0.6210894567209877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007834911346435547, "StateBufferConnector_ms": 0.007354259490966797, "ViewRequirementAgentConnector_ms": 0.4806180000305176}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2446.978464620636, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 428000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 1638.438, "sample_time_ms": 570.039, "synch_weights_time_ms": 36.195}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4393, "training_iteration": 107, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-17", "timestamp": 1715558657, "time_this_iter_s": 1.644669771194458, "time_total_s": 172.79802012443542, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa11844b010>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 172.79802012443542, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 46.8, "ram_util_percent": 38.2, "gpu_util_percent0": 0.235, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.1, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.1, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.165, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.39583333333334, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 619480.0, "episode_reward_min": -5524.0, "episode_reward_mean": 18152.67, "episode_len_mean": 116.33, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11901.0, -3524.0, -3024.0, -4524.0, 11401.0, 573580.0, 619480.0, 606980.0, 2951.0, 12401.0, -5024.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, 39902.0, -4024.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, -3024.0, -3524.0, 13401.0, -4524.0, -4524.0, 14901.0, -4024.0, -5024.0, 12901.0, 11901.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -5024.0, -3024.0, 12401.0, -3024.0, -5524.0, -4024.0, -4024.0, -5024.0, -4524.0, -3524.0, -4524.0, -3524.0, 18401.0, -3024.0, -4524.0, -3524.0, -3524.0, -524.0, 55.0, 13901.0, -4524.0, 13901.0, -3024.0, 17401.0, -3524.0, -4024.0, -3024.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, -4524.0, -2024.0, -4524.0, 13401.0, -5524.0, -2524.0, -3524.0, -4024.0, -3524.0, -3524.0, 10401.0, -4024.0, -4524.0, 15901.0, -3524.0, -3524.0, 14901.0, -4024.0, -2024.0, 15901.0, -3524.0, -4024.0, -5524.0, 15901.0, -4024.0, -4524.0, -4524.0], "episode_lengths": [100, 25, 25, 25, 100, 2521, 2521, 2521, 50, 100, 25, 25, 25, 25, 25, 25, 25, 199, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 46, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.077102659224044, "mean_inference_ms": 5.014457154635605, "mean_action_processing_ms": 1.317946434436133, "mean_env_wait_ms": 0.6207953211393867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007905244827270508, "StateBufferConnector_ms": 0.00811314582824707, "ViewRequirementAgentConnector_ms": 0.47743654251098633}}, "episode_reward_max": 619480.0, "episode_reward_min": -5524.0, "episode_reward_mean": 18152.67, "episode_len_mean": 116.33, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11901.0, -3524.0, -3024.0, -4524.0, 11401.0, 573580.0, 619480.0, 606980.0, 2951.0, 12401.0, -5024.0, -5024.0, -4524.0, -4524.0, -3524.0, -4524.0, -4024.0, 39902.0, -4024.0, -3024.0, -4524.0, -3524.0, -4524.0, -3524.0, -4524.0, -3024.0, -3524.0, 13401.0, -4524.0, -4524.0, 14901.0, -4024.0, -5024.0, 12901.0, 11901.0, -3524.0, -3024.0, -4524.0, -4024.0, -3524.0, -4024.0, -5024.0, -3024.0, 12401.0, -3024.0, -5524.0, -4024.0, -4024.0, -5024.0, -4524.0, -3524.0, -4524.0, -3524.0, 18401.0, -3024.0, -4524.0, -3524.0, -3524.0, -524.0, 55.0, 13901.0, -4524.0, 13901.0, -3024.0, 17401.0, -3524.0, -4024.0, -3024.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, -4524.0, -2024.0, -4524.0, 13401.0, -5524.0, -2524.0, -3524.0, -4024.0, -3524.0, -3524.0, 10401.0, -4024.0, -4524.0, 15901.0, -3524.0, -3524.0, 14901.0, -4024.0, -2024.0, 15901.0, -3524.0, -4024.0, -5524.0, 15901.0, -4024.0, -4524.0, -4524.0], "episode_lengths": [100, 25, 25, 25, 100, 2521, 2521, 2521, 50, 100, 25, 25, 25, 25, 25, 25, 25, 199, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 100, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 46, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.077102659224044, "mean_inference_ms": 5.014457154635605, "mean_action_processing_ms": 1.317946434436133, "mean_env_wait_ms": 0.6207953211393867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007905244827270508, "StateBufferConnector_ms": 0.00811314582824707, "ViewRequirementAgentConnector_ms": 0.47743654251098633}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2568.9739257939455, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 432000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 1634.188, "sample_time_ms": 569.042, "synch_weights_time_ms": 35.45}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4432, "training_iteration": 108, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-19", "timestamp": 1715558659, "time_this_iter_s": 1.5657093524932861, "time_total_s": 174.3637294769287, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa118458490>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 174.3637294769287, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 46.4, "ram_util_percent": 38.2, "gpu_util_percent0": 0.18, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.2, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.195, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.14500000000000002, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 127.34375000000001, "num_env_steps_trained": 1000.0, "total_loss": NaN}, "default_policy": {"total_loss": NaN, "policy_loss": NaN, "vf_loss": NaN, "vf_loss_unclipped": NaN, "vf_explained_var": NaN, "entropy": NaN, "mean_kl_loss": NaN, "default_optimizer_lr": 5e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18401.0, "episode_reward_min": -6524.0, "episode_reward_mean": -521.71, "episode_len_mean": 38.71, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, -3524.0, -4024.0, -5024.0, -3024.0, 12401.0, -3024.0, -5524.0, -4024.0, -4024.0, -5024.0, -4524.0, -3524.0, -4524.0, -3524.0, 18401.0, -3024.0, -4524.0, -3524.0, -3524.0, -524.0, 55.0, 13901.0, -4524.0, 13901.0, -3024.0, 17401.0, -3524.0, -4024.0, -3024.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, -4524.0, -2024.0, -4524.0, 13401.0, -5524.0, -2524.0, -3524.0, -4024.0, -3524.0, -3524.0, 10401.0, -4024.0, -4524.0, 15901.0, -3524.0, -3524.0, 14901.0, -4024.0, -2024.0, 15901.0, -3524.0, -4024.0, -5524.0, 15901.0, -4024.0, -4524.0, -4524.0, -4524.0, -6524.0, -3024.0, -4024.0, 13901.0, -3024.0, -2524.0, -4024.0, -3524.0, -4024.0, 13901.0, -3524.0, -4524.0, 12401.0, -4024.0, -4024.0, -4024.0, 17401.0, -4024.0, -4524.0, -3024.0, -5024.0, 13901.0, -5524.0, -4524.0, -4024.0, -3524.0, -4524.0, -3524.0, -2524.0, -4024.0, -4024.0, 14401.0, -3024.0, -5024.0, -3524.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 46, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.077276899968959, "mean_inference_ms": 5.014384231083686, "mean_action_processing_ms": 1.317880701198554, "mean_env_wait_ms": 0.6212224390236714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007862091064453125, "StateBufferConnector_ms": 0.006881237030029297, "ViewRequirementAgentConnector_ms": 0.48134589195251465}}, "episode_reward_max": 18401.0, "episode_reward_min": -6524.0, "episode_reward_mean": -521.71, "episode_len_mean": 38.71, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4524.0, -4024.0, -3524.0, -4024.0, -5024.0, -3024.0, 12401.0, -3024.0, -5524.0, -4024.0, -4024.0, -5024.0, -4524.0, -3524.0, -4524.0, -3524.0, 18401.0, -3024.0, -4524.0, -3524.0, -3524.0, -524.0, 55.0, 13901.0, -4524.0, 13901.0, -3024.0, 17401.0, -3524.0, -4024.0, -3024.0, 13901.0, -3524.0, -4024.0, -3524.0, -4024.0, -4524.0, -2024.0, -4524.0, 13401.0, -5524.0, -2524.0, -3524.0, -4024.0, -3524.0, -3524.0, 10401.0, -4024.0, -4524.0, 15901.0, -3524.0, -3524.0, 14901.0, -4024.0, -2024.0, 15901.0, -3524.0, -4024.0, -5524.0, 15901.0, -4024.0, -4524.0, -4524.0, -4524.0, -6524.0, -3024.0, -4024.0, 13901.0, -3024.0, -2524.0, -4024.0, -3524.0, -4024.0, 13901.0, -3524.0, -4524.0, 12401.0, -4024.0, -4024.0, -4024.0, 17401.0, -4024.0, -4524.0, -3024.0, -5024.0, 13901.0, -5524.0, -4524.0, -4024.0, -3524.0, -4524.0, -3524.0, -2524.0, -4024.0, -4024.0, 14401.0, -3024.0, -5024.0, -3524.0, -3024.0], "episode_lengths": [25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 46, 100, 25, 100, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 100, 25, 25, 100, 25, 25, 25, 100, 25, 25, 25, 25, 100, 25, 25, 25, 25, 25, 25, 25, 25, 25, 100, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.077276899968959, "mean_inference_ms": 5.014384231083686, "mean_action_processing_ms": 1.317880701198554, "mean_env_wait_ms": 0.6212224390236714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007862091064453125, "StateBufferConnector_ms": 0.006881237030029297, "ViewRequirementAgentConnector_ms": 0.48134589195251465}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 2464.6461441278657, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 436000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 1629.361, "sample_time_ms": 564.053, "synch_weights_time_ms": 36.41}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4469, "training_iteration": 109, "trial_id": "df94b_00000", "date": "2024-05-12_17-04-20", "timestamp": 1715558660, "time_this_iter_s": 1.6361746788024902, "time_total_s": 175.9999041557312, "pid": 1708716, "hostname": "ESI-lambda-quad-01", "node_ip": "206.211.132.160", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 4, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 4, "num_gpus_per_learner_worker": 1, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'env_customizer.CustomizedEnvironment'>", "env_config": {"env": "<CodersStrikeBackSingle instance>", "customizer": "<__main__.CustomizedRacing object at 0x7fa1184583d0>"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 5, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 10, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa11b647ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 6, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 175.9999041557312, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 49.400000000000006, "ram_util_percent": 38.2, "gpu_util_percent0": 0.235, "vram_util_percent0": 0.10182883522727272, "gpu_util_percent1": 0.18, "vram_util_percent1": 0.0439453125, "gpu_util_percent2": 0.12, "vram_util_percent2": 0.0439453125, "gpu_util_percent3": 0.16999999999999998, "vram_util_percent3": 0.1162109375}, "checkpoint_dir_name": null}
